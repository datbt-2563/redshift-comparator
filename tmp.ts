const q1 = `SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS "発行数", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS "使用済数", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS "キャンセル", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId) FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%2311%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0`;

const q2 = `WITH issued_count AS (SELECT couponMasterId, COUNT(*) AS issued_count FROM coupon_logs WHERE type = 'issued' GROUP BY couponMasterId), used_count AS (SELECT couponMasterId, COUNT(*) AS used_count FROM coupon_logs WHERE type = 'used' GROUP BY couponMasterId), canceled_count AS (SELECT couponMasterId, COUNT(*) AS canceled_count FROM coupon_logs WHERE type = 'canceled' GROUP BY couponMasterId), displayed_count AS (SELECT couponMasterId, COUNT(*) AS displayed_count FROM coupon_logs WHERE type = 'displayed' GROUP BY couponMasterId) SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, COALESCE(ic.issued_count, 0) AS "発行数", COALESCE(uc.used_count, 0) AS "使用済数", COALESCE(cc.canceled_count, 0) AS "キャンセル", COALESCE(dc.displayed_count, 0) AS "表示数" FROM coupon_logs l JOIN (SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId LEFT JOIN issued_count ic ON ic.couponMasterId = l.couponMasterId LEFT JOIN used_count uc ON uc.couponMasterId = l.couponMasterId LEFT JOIN canceled_count cc ON cc.couponMasterId = l.couponMasterId LEFT JOIN displayed_count dc ON dc.couponMasterId = l.couponMasterId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0;`;

const r1 = [
  [
    { stringValue: "44670ba6-e904-4187-a1d6-0c4a5d7a6a40" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-100yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　100円券_1_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "cbb980b6-fb05-4010-8376-941502ef2c06" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-100yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　100円券" },
    { longValue: 84000 },
    { longValue: 218 },
    { longValue: 0 },
    { longValue: 550 },
  ],
  [
    { stringValue: "1f31ed5a-bd40-4f9f-a3c4-471b99655845" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-200yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　200円券_1_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "2a562577-1545-4bec-91da-ce847508420a" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-200yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　200円券" },
    { longValue: 42000 },
    { longValue: 229 },
    { longValue: 0 },
    { longValue: 524 },
  ],
  [
    { stringValue: "99df5c00-ad3d-4a88-ba7e-7ba7621cc67a" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　50円券_1_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "bbf445a3-619a-48c3-87ef-bc94bf89df7c" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　50円券_2_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "a561ae74-f971-457e-99ca-5d05b4487cfd" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　50円券_3_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "31cb6026-044a-4df3-ac05-2d32dc005cb6" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　50円券_4_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "35f0362e-67bb-4297-bbbb-310f04c69fdc" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　50円券_5_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "5319ae5c-7e0d-4439-bc88-a6746f286faf" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　50円券_6_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "62c6b34e-34d2-4984-978b-04e57a620808" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　50円券_7_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "ac194a7a-0ad1-437c-829e-ed030523f9fc" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【壱番屋アンケートクーポン】　50円券_8_2311" },
    { longValue: 21000 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 0 },
  ],
  [
    { stringValue: "0c31274e-aff1-45c5-a484-813689f9fbb9" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　50円券_1" },
    { longValue: 21000 },
    { longValue: 169 },
    { longValue: 0 },
    { longValue: 435 },
  ],
  [
    { stringValue: "3155024d-3274-48df-aecd-dcfec3269553" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　50円券_2" },
    { longValue: 42000 },
    { longValue: 177 },
    { longValue: 0 },
    { longValue: 385 },
  ],
  [
    { stringValue: "8c29f80a-0031-40ba-9506-6dad8a8527c7" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　50円券_3" },
    { longValue: 42000 },
    { longValue: 171 },
    { longValue: 0 },
    { longValue: 444 },
  ],
  [
    { stringValue: "662eb874-6d39-4fac-b2f6-6bc0f24b83d9" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　50円券_4" },
    { longValue: 21000 },
    { longValue: 179 },
    { longValue: 0 },
    { longValue: 379 },
  ],
  [
    { stringValue: "604f4d8b-9eaf-4f0e-9e8b-b70dfdf0bcfa" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　50円券_5" },
    { longValue: 42000 },
    { longValue: 166 },
    { longValue: 0 },
    { longValue: 448 },
  ],
  [
    { stringValue: "524d5638-3470-4985-a934-4f18a96cb6f9" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　50円券_6" },
    { longValue: 21000 },
    { longValue: 158 },
    { longValue: 0 },
    { longValue: 412 },
  ],
  [
    { stringValue: "86f32483-d6d0-4b24-b398-86d2a9b973bf" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　50円券_7" },
    { longValue: 42000 },
    { longValue: 172 },
    { longValue: 0 },
    { longValue: 421 },
  ],
  [
    { stringValue: "6df3da1c-39e1-46c2-85a8-4ca214147b00" },
    { stringValue: "8219ca6d-38a1-447f-a59a-6b9cdee52985" },
    { stringValue: "壱番屋" },
    { stringValue: "ichibanya-50yen-2311" },
    { stringValue: "【本番_2311】壱番屋アンケートクーポン　50円券_8" },
    { longValue: 63000 },
    { longValue: 174 },
    { longValue: 0 },
    { longValue: 389 },
  ],
];

const r2 = [
  [
    { stringValue: "4bb8c2f8-5ef7-461d-97ea-312bd1761de5" },
    { stringValue: "2d604e05-5c13-423f-ae98-7f29dc5cc1cf" },
    { stringValue: "株式会社フルキャストホールディングス" },
    { stringValue: "0001" },
    {
      stringValue:
        "らあめん花月嵐フルキャストグループイン記念クーポン（有効期限：2023年8月1日～15日）（スタッフ向け）",
    },
    { longValue: 3030 },
    { longValue: 148 },
    { longValue: 0 },
    { longValue: 2235 },
  ],
  [
    { stringValue: "40a30af1-4f7f-404c-8035-435f9bde822d" },
    { stringValue: "2d604e05-5c13-423f-ae98-7f29dc5cc1cf" },
    { stringValue: "株式会社フルキャストホールディングス" },
    { stringValue: "0002" },
    {
      stringValue:
        "らあめん花月嵐フルキャストグループイン記念クーポン（有効期限：2023年8月1日～9月30日）（会長用）",
    },
    { longValue: 30 },
    { longValue: 0 },
    { longValue: 0 },
    { longValue: 7 },
  ],
  [
    { stringValue: "dd64917a-0420-416b-8908-5743ca434627" },
    { stringValue: "2d604e05-5c13-423f-ae98-7f29dc5cc1cf" },
    { stringValue: "株式会社フルキャストホールディングス" },
    { stringValue: "0003" },
    {
      stringValue:
        "らあめん花月嵐フルキャストグループイン記念クーポン（有効期限：2023年8月16日～31日）（スタッフ向け）",
    },
    { longValue: 6001 },
    { longValue: 480 },
    { longValue: 0 },
    { longValue: 5557 },
  ],
  [
    { stringValue: "38a405c5-bdff-4aaa-8189-aaca9b05d1e4" },
    { stringValue: "2d604e05-5c13-423f-ae98-7f29dc5cc1cf" },
    { stringValue: "株式会社フルキャストホールディングス" },
    { stringValue: "0004" },
    {
      stringValue:
        "第二弾！らあめん花月嵐フルキャストグループイン記念クーポン（有効期限：2023年9月11日～30日）（スタッフ向け）",
    },
    { longValue: 16037 },
    { longValue: 2000 },
    { longValue: 0 },
    { longValue: 18366 },
  ],
  [
    { stringValue: "21ad38e3-7cfe-475c-9dcc-f60e0fccd183" },
    { stringValue: "2d604e05-5c13-423f-ae98-7f29dc5cc1cf" },
    { stringValue: "株式会社フルキャストホールディングス" },
    { stringValue: "0005" },
    {
      stringValue:
        "らあめん花月嵐フルキャストグループイン記念クーポン（有効期限：2023年9月11日～30日）（社員向け）",
    },
    { longValue: 1830 },
    { longValue: 156 },
    { longValue: 0 },
    { longValue: 2429 },
  ],
  [
    { stringValue: "3c8acca2-c979-437b-bf60-a08af860888e" },
    { stringValue: "2d604e05-5c13-423f-ae98-7f29dc5cc1cf" },
    { stringValue: "株式会社フルキャストホールディングス" },
    { stringValue: "0006" },
    {
      stringValue:
        "らあめん花月嵐ビール（小グラス）orソフトドリンク1杯無料キャンペーン（有効期限：2023年10月6日～31日）",
    },
    { longValue: 12499 },
    { longValue: 98 },
    { longValue: 0 },
    { longValue: 12817 },
  ],
  [
    { stringValue: "070f003f-2451-4f33-9347-d5ea39834288" },
    { stringValue: "2d604e05-5c13-423f-ae98-7f29dc5cc1cf" },
    { stringValue: "株式会社フルキャストホールディングス" },
    { stringValue: "0009" },
    { stringValue: "【らあめん花月嵐】当選者クーポン" },
    { longValue: 137 },
    { longValue: 35 },
    { longValue: 0 },
    { longValue: 566 },
  ],
  [
    { stringValue: "e32a46ea-7d38-45f7-9c55-7ee485a7ac77" },
    { stringValue: "2d604e05-5c13-423f-ae98-7f29dc5cc1cf" },
    { stringValue: "株式会社フルキャストホールディングス" },
    { stringValue: "99999999" },
    { stringValue: "テスト用" },
    { longValue: 22 },
    { longValue: 5 },
    { longValue: 0 },
    { longValue: 98 },
  ],
];
