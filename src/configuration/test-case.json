[
  {
    "no": "3779",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '567e0287-35bc-47b4-aa0d-c7c3a9ed6fe0' AND l.couponCode LIKE '%1010cp2-8-1202-1203-SBGIFT%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '567e0287-35bc-47b4-aa0d-c7c3a9ed6fe0' AND l.couponCode LIKE '%1010cp2-8-1202-1203-SBGIFT%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1118"
  },
  {
    "no": "3784",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND o.name LIKE '%店舗B%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND o.name LIKE '%店舗B%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1119"
  },
  {
    "no": "3785",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%Bkyotsu240903%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%Bkyotsu240903%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1120"
  },
  {
    "no": "3786",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%Bkyotsu240903%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%Bkyotsu240903%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1121"
  },
  {
    "no": "3789",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/4/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1122"
  },
  {
    "no": "3792",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1123"
  },
  {
    "no": "3795",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1124"
  },
  {
    "no": "3798",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1125"
  },
  {
    "no": "3799",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1126"
  },
  {
    "no": "3800",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/13/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1127"
  },
  {
    "no": "3803",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1128"
  },
  {
    "no": "3804",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1129"
  },
  {
    "no": "3805",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1130"
  },
  {
    "no": "3806",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1131"
  },
  {
    "no": "3808",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/19/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1132"
  },
  {
    "no": "3811",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/24/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1133"
  },
  {
    "no": "3812",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND l.couponCode LIKE '%JB0224BD09JI05JE%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND l.couponCode LIKE '%JB0224BD09JI05JE%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1134"
  },
  {
    "no": "3813",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND l.couponCode LIKE '%JB0224BD09JI05JE%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND l.couponCode LIKE '%JB0224BD09JI05JE%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1135"
  },
  {
    "no": "3816",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "9/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1136"
  },
  {
    "no": "3821",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1137"
  },
  {
    "no": "3822",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1138"
  },
  {
    "no": "3823",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1139"
  },
  {
    "no": "3824",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1140"
  },
  {
    "no": "3825",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1141"
  },
  {
    "no": "3826",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1142"
  },
  {
    "no": "3827",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1143"
  },
  {
    "no": "3828",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1144"
  },
  {
    "no": "3829",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd0f3d304-3ddc-4c0a-90b0-5c3656c150d1' AND l.couponCode LIKE '%sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd0f3d304-3ddc-4c0a-90b0-5c3656c150d1' AND l.couponCode LIKE '%sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1145"
  },
  {
    "no": "3830",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd0f3d304-3ddc-4c0a-90b0-5c3656c150d1' AND l.couponCode LIKE '%2021-08-27test-CouponCode-xxxx%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd0f3d304-3ddc-4c0a-90b0-5c3656c150d1' AND l.couponCode LIKE '%2021-08-27test-CouponCode-xxxx%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1146"
  },
  {
    "no": "3831",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%abcde%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%abcde%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1147"
  },
  {
    "no": "3832",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%abcde%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%abcde%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1148"
  },
  {
    "no": "3833",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1149"
  },
  {
    "no": "3834",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1150"
  },
  {
    "no": "3835",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1151"
  },
  {
    "no": "3836",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1152"
  },
  {
    "no": "3837",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1153"
  },
  {
    "no": "3838",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1154"
  },
  {
    "no": "3839",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1155"
  },
  {
    "no": "3840",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/4/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND l.couponCode LIKE '%nakajimasuisan-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND l.couponCode LIKE '%nakajimasuisan-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1156"
  },
  {
    "no": "3841",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/4/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1157"
  },
  {
    "no": "3842",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/4/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1158"
  },
  {
    "no": "3843",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/7/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%030295007%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%030295007%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1159"
  },
  {
    "no": "3844",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1160"
  },
  {
    "no": "3845",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1161"
  },
  {
    "no": "3846",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1162"
  },
  {
    "no": "3847",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.name LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.name LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1163"
  },
  {
    "no": "3848",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1164"
  },
  {
    "no": "3849",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1165"
  },
  {
    "no": "3850",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1166"
  },
  {
    "no": "3851",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1167"
  },
  {
    "no": "3852",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1168"
  },
  {
    "no": "3853",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1169"
  },
  {
    "no": "3854",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1170"
  },
  {
    "no": "3855",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.name LIKE '%tokyo-sent%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.name LIKE '%tokyo-sent%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1171"
  },
  {
    "no": "3856",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1172"
  },
  {
    "no": "3857",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1173"
  },
  {
    "no": "3858",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponName LIKE '%体験用クーポン%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponName LIKE '%体験用クーポン%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1174"
  },
  {
    "no": "3859",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1175"
  },
  {
    "no": "3860",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1176"
  },
  {
    "no": "3861",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%12345%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%12345%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1177"
  },
  {
    "no": "3862",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%12345%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND l.couponCode LIKE '%12345%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1178"
  },
  {
    "no": "3863",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND l.couponCode LIKE '%test24091302coffee%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1179"
  },
  {
    "no": "3864",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1180"
  },
  {
    "no": "3865",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1181"
  },
  {
    "no": "3866",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1182"
  },
  {
    "no": "3867",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1183"
  },
  {
    "no": "3868",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1184"
  },
  {
    "no": "3869",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1185"
  },
  {
    "no": "3870",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1186"
  },
  {
    "no": "3871",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1187"
  },
  {
    "no": "3872",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/16/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1188"
  },
  {
    "no": "3873",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/16/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1189"
  },
  {
    "no": "3874",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1190"
  },
  {
    "no": "3875",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1191"
  },
  {
    "no": "3876",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1192"
  },
  {
    "no": "3877",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1193"
  },
  {
    "no": "3878",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1194"
  },
  {
    "no": "3879",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1195"
  },
  {
    "no": "3880",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1196"
  },
  {
    "no": "3881",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1197"
  },
  {
    "no": "3882",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' AND l.couponName LIKE '%2410%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' AND l.couponName LIKE '%2410%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1198"
  },
  {
    "no": "3883",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/21/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1199"
  },
  {
    "no": "3884",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/21/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1200"
  },
  {
    "no": "3885",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1201"
  },
  {
    "no": "3886",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1202"
  },
  {
    "no": "3887",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1203"
  },
  {
    "no": "3888",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1204"
  },
  {
    "no": "3889",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1205"
  },
  {
    "no": "3890",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1206"
  },
  {
    "no": "3892",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1207"
  },
  {
    "no": "3894",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1208"
  },
  {
    "no": "3895",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/24/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1209"
  },
  {
    "no": "3896",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/24/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1210"
  },
  {
    "no": "3898",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1211"
  },
  {
    "no": "3899",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1212"
  },
  {
    "no": "3900",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1213"
  },
  {
    "no": "3901",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/29/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1214"
  },
  {
    "no": "3902",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1215"
  },
  {
    "no": "3903",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1216"
  },
  {
    "no": "3904",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1217"
  },
  {
    "no": "3905",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1218"
  },
  {
    "no": "3906",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.name LIKE '%SBギフト%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.name LIKE '%SBギフト%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1219"
  },
  {
    "no": "3907",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.name LIKE '%SBギフト%' AND l.couponCode LIKE '%1010cp-test%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.name LIKE '%SBギフト%' AND l.couponCode LIKE '%1010cp-test%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1220"
  },
  {
    "no": "3908",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%1010cp-test%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%1010cp-test%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1221"
  },
  {
    "no": "3909",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponName LIKE '%【テスト】東京1010クーポン%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponName LIKE '%【テスト】東京1010クーポン%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1222"
  },
  {
    "no": "3911",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1223"
  },
  {
    "no": "3914",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1224"
  },
  {
    "no": "3918",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1225"
  },
  {
    "no": "3919",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1226"
  },
  {
    "no": "3923",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1227"
  },
  {
    "no": "3924",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1228"
  },
  {
    "no": "3925",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1229"
  },
  {
    "no": "3926",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1230"
  },
  {
    "no": "3927",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1231"
  },
  {
    "no": "3928",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1232"
  },
  {
    "no": "3929",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1233"
  },
  {
    "no": "3930",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1234"
  },
  {
    "no": "3932",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1235"
  },
  {
    "no": "3935",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1236"
  },
  {
    "no": "3936",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1237"
  },
  {
    "no": "3937",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento-coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1238"
  },
  {
    "no": "3938",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1239"
  },
  {
    "no": "3939",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1240"
  },
  {
    "no": "3940",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1241"
  },
  {
    "no": "3941",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1242"
  },
  {
    "no": "3942",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/7/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1243"
  },
  {
    "no": "3943",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1244"
  },
  {
    "no": "3944",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1245"
  },
  {
    "no": "3945",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1246"
  },
  {
    "no": "3946",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1247"
  },
  {
    "no": "3948",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1248"
  },
  {
    "no": "3949",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1249"
  },
  {
    "no": "3950",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1250"
  },
  {
    "no": "3951",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/13/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1251"
  },
  {
    "no": "3952",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/14/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND o.name LIKE '%中島水産株式会社%' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND o.name LIKE '%中島水産株式会社%' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1252"
  },
  {
    "no": "3953",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/14/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND o.name LIKE '%中島水産株式会社%' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND o.name LIKE '%中島水産株式会社%' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1253"
  },
  {
    "no": "3954",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/14/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1254"
  },
  {
    "no": "3955",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1255"
  },
  {
    "no": "3956",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1256"
  },
  {
    "no": "3957",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1257"
  },
  {
    "no": "3958",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/16/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND o.name LIKE '%中島水産株式会社%' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND o.name LIKE '%中島水産株式会社%' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1258"
  },
  {
    "no": "3959",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/19/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1259"
  },
  {
    "no": "3960",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/19/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1260"
  },
  {
    "no": "3961",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/19/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1261"
  },
  {
    "no": "3962",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/19/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '056f0e0d-2960-49d8-9f3a-05c6e7971ce4' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '056f0e0d-2960-49d8-9f3a-05c6e7971ce4' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1262"
  },
  {
    "no": "3963",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/20/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1263"
  },
  {
    "no": "3964",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/20/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1264"
  },
  {
    "no": "3965",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/20/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1265"
  },
  {
    "no": "3966",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/21/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1266"
  },
  {
    "no": "3967",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/21/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1267"
  },
  {
    "no": "3968",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1268"
  },
  {
    "no": "3969",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1269"
  },
  {
    "no": "3970",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1270"
  },
  {
    "no": "3971",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q7_1271"
  },
  {
    "no": "3972",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1272"
  },
  {
    "no": "3973",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1273"
  },
  {
    "no": "3974",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1274"
  },
  {
    "no": "3975",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND o.name LIKE '%ACLE2coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND o.name LIKE '%ACLE2coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1275"
  },
  {
    "no": "3976",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponName LIKE '%ACLE2coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponName LIKE '%ACLE2coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1276"
  },
  {
    "no": "3977",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE2coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE2coupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1277"
  },
  {
    "no": "3978",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLEcoupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLEcoupon%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1278"
  },
  {
    "no": "3979",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1279"
  },
  {
    "no": "3980",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo0-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo0-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1280"
  },
  {
    "no": "3981",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1281"
  },
  {
    "no": "3982",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1282"
  },
  {
    "no": "3983",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1283"
  },
  {
    "no": "3984",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/27/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1284"
  },
  {
    "no": "3985",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/27/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1285"
  },
  {
    "no": "3986",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1286"
  },
  {
    "no": "3987",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1287"
  },
  {
    "no": "3988",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1288"
  },
  {
    "no": "3989",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "11/29/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1289"
  },
  {
    "no": "3990",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1290"
  },
  {
    "no": "3991",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1291"
  },
  {
    "no": "3992",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1292"
  },
  {
    "no": "3993",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1293"
  },
  {
    "no": "3994",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1294"
  },
  {
    "no": "3995",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2412%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2412%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1295"
  },
  {
    "no": "3996",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%本番\\\\_2412%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%本番\\\\_2412%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1296"
  },
  {
    "no": "3997",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1297"
  },
  {
    "no": "3998",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1298"
  },
  {
    "no": "3999",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1299"
  },
  {
    "no": "4000",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/4/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1300"
  },
  {
    "no": "4001",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1301"
  },
  {
    "no": "4002",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1302"
  },
  {
    "no": "4003",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1303"
  },
  {
    "no": "4004",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1304"
  },
  {
    "no": "4005",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1305"
  },
  {
    "no": "4006",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1306"
  },
  {
    "no": "4007",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1307"
  },
  {
    "no": "4008",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1308"
  },
  {
    "no": "4009",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1309"
  },
  {
    "no": "4010",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1310"
  },
  {
    "no": "4011",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%Ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%Ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1311"
  },
  {
    "no": "4012",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%IchIbanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%IchIbanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1312"
  },
  {
    "no": "4013",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%IchIbanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%IchIbanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1313"
  },
  {
    "no": "4014",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1314"
  },
  {
    "no": "4015",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1315"
  },
  {
    "no": "4016",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND o.name LIKE '%中島水産株式会社%' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND o.name LIKE '%中島水産株式会社%' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1316"
  },
  {
    "no": "4017",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1317"
  },
  {
    "no": "4018",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1318"
  },
  {
    "no": "4019",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1319"
  },
  {
    "no": "4020",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1320"
  },
  {
    "no": "4021",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1321"
  },
  {
    "no": "4022",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/13/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1322"
  },
  {
    "no": "4023",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/13/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1323"
  },
  {
    "no": "4024",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/13/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1324"
  },
  {
    "no": "4025",
    "queryPattern": "Q7",
    "name": "Usage Aggregate Json byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byCouponMasterSql",
    "isMatching": "1",
    "timestamp": "12/16/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT l.couponMasterId, o.resourceId, o.name, l.couponCode, l.couponName, ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\", (SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'displayed' AND l2.couponMasterId = l.couponMasterId)  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY l.couponCode, l.couponName, l.createAtMillis, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q7_1325"
  },
  {
    "no": "4336",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/4/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_1"
  },
  {
    "no": "4337",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/4/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_2"
  },
  {
    "no": "4345",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/12/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '86b02ca3-a865-40ac-af49-958eb6f2176c' AND o.type = 'SHOP' AND o.name LIKE '%近鉄郡山店%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '86b02ca3-a865-40ac-af49-958eb6f2176c' AND o.type = 'SHOP' AND o.name LIKE '%近鉄郡山店%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_3"
  },
  {
    "no": "4347",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/19/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_4"
  },
  {
    "no": "4349",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/19/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_5"
  },
  {
    "no": "4351",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/19/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_6"
  },
  {
    "no": "4352",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/19/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_7"
  },
  {
    "no": "4353",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/19/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' AND o.name LIKE '%中延店%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' AND o.name LIKE '%中延店%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_8"
  },
  {
    "no": "4358",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/21/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_9"
  },
  {
    "no": "4359",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/24/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_10"
  },
  {
    "no": "4360",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/24/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_11"
  },
  {
    "no": "4361",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "7/24/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_12"
  },
  {
    "no": "4372",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_13"
  },
  {
    "no": "4373",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_14"
  },
  {
    "no": "4395",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_15"
  },
  {
    "no": "4396",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_16"
  },
  {
    "no": "4556",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/22/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SHOP' AND o.name LIKE '%名古屋ふらんす%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SHOP' AND o.name LIKE '%名古屋ふらんす%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_17"
  },
  {
    "no": "4557",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/22/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SMALL_SHOP_GROUP' AND o.name LIKE '%名古屋%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SMALL_SHOP_GROUP' AND o.name LIKE '%名古屋%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_18"
  },
  {
    "no": "4558",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/22/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SHOP' AND o.name LIKE '%名古屋%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SHOP' AND o.name LIKE '%名古屋%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_19"
  },
  {
    "no": "4559",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/22/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SHOP' AND o.name LIKE '%銀座%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SHOP' AND o.name LIKE '%銀座%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_20"
  },
  {
    "no": "4562",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/22/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SMALL_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SMALL_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_21"
  },
  {
    "no": "4563",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/22/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SHOP' AND o.name LIKE '%銀座%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'SHOP' AND o.name LIKE '%銀座%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_22"
  },
  {
    "no": "4564",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/22/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_23"
  },
  {
    "no": "4734",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/25/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' AND o.name LIKE '%京丹後市観光公社%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' AND o.name LIKE '%京丹後市観光公社%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_24"
  },
  {
    "no": "4843",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_25"
  },
  {
    "no": "4847",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_26"
  },
  {
    "no": "4855",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "11/29/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_27"
  },
  {
    "no": "4857",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "11/29/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_28"
  },
  {
    "no": "4895",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "12/4/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_29"
  },
  {
    "no": "4896",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "12/4/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_30"
  },
  {
    "no": "4906",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "12/7/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_31"
  },
  {
    "no": "4908",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "12/7/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.type = 'SHOP' AND o.name LIKE '%えごた湯%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.type = 'SHOP' AND o.name LIKE '%えごた湯%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_32"
  },
  {
    "no": "4909",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "12/7/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_33"
  },
  {
    "no": "4974",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "12/28/2023",
    "shortSQL": "_SAME_ WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_34"
  },
  {
    "no": "5111",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "2/7/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_35"
  },
  {
    "no": "5117",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "2/9/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_36"
  },
  {
    "no": "5119",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "2/10/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_37"
  },
  {
    "no": "5120",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "2/10/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_38"
  },
  {
    "no": "5139",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "2/23/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'c5ac151d-f0ca-428d-93a0-dba919145c60' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'c5ac151d-f0ca-428d-93a0-dba919145c60' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_39"
  },
  {
    "no": "5144",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "3/1/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' AND o.name LIKE '%北千住%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' AND o.name LIKE '%北千住%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_40"
  },
  {
    "no": "5145",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "3/1/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_41"
  },
  {
    "no": "5427",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "8/6/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_42"
  },
  {
    "no": "5451",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_43"
  },
  {
    "no": "5452",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_44"
  },
  {
    "no": "5453",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_45"
  },
  {
    "no": "5455",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_46"
  },
  {
    "no": "5456",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_47"
  },
  {
    "no": "5458",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_48"
  },
  {
    "no": "5459",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_49"
  },
  {
    "no": "5460",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '84f4ee9e-3f00-4530-adaf-9bd2dc15108b' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_50"
  },
  {
    "no": "5461",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'c4a414cb-3357-4c10-93d0-058edb86ce47' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_51"
  },
  {
    "no": "5465",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/4/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_52"
  },
  {
    "no": "5466",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/4/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_53"
  },
  {
    "no": "5468",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/6/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_54"
  },
  {
    "no": "5469",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/6/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_55"
  },
  {
    "no": "5471",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/6/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_56"
  },
  {
    "no": "5472",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/9/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_57"
  },
  {
    "no": "5474",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/9/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_58"
  },
  {
    "no": "5475",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/9/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_59"
  },
  {
    "no": "5479",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/14/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_60"
  },
  {
    "no": "5480",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/14/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_61"
  },
  {
    "no": "5485",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/17/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_62"
  },
  {
    "no": "5487",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/20/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' AND o.name LIKE '%上野マルイ%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' AND o.name LIKE '%上野マルイ%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_63"
  },
  {
    "no": "5488",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/20/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' AND o.name LIKE '%上野マルイ%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' AND o.name LIKE '%上野マルイ%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_64"
  },
  {
    "no": "5492",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/26/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_65"
  },
  {
    "no": "5493",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/26/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_66"
  },
  {
    "no": "5495",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/26/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_67"
  },
  {
    "no": "5496",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/26/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_68"
  },
  {
    "no": "5497",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/26/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_69"
  },
  {
    "no": "5498",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "9/26/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'd2f8c6ac-ebde-41c7-a0d8-ca34dfa397db' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_70"
  },
  {
    "no": "5569",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_71"
  },
  {
    "no": "5571",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_72"
  },
  {
    "no": "5575",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/24/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_73"
  },
  {
    "no": "5588",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_74"
  },
  {
    "no": "5590",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' AND o.type = 'SMALL_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' AND o.type = 'SMALL_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_75"
  },
  {
    "no": "5591",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_76"
  },
  {
    "no": "5593",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'dcdaf32b-1480-4f98-9816-f35b349d6310' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'dcdaf32b-1480-4f98-9816-f35b349d6310' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_77"
  },
  {
    "no": "5594",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' AND o.type = 'SMALL_SHOP_GROUP' AND o.name LIKE '%SmartCheck%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' AND o.type = 'SMALL_SHOP_GROUP' AND o.name LIKE '%SmartCheck%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_78"
  },
  {
    "no": "5595",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' AND o.type = 'SMALL_SHOP_GROUP' AND o.name LIKE '%SmartCheck%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'b57f69a7-bcb5-41bd-8025-b5700b5b40d5' AND o.type = 'SMALL_SHOP_GROUP' AND o.name LIKE '%SmartCheck%' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_79"
  },
  {
    "no": "5598",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_80"
  },
  {
    "no": "5599",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND o.type = 'SMALL_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND o.type = 'SMALL_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_81"
  },
  {
    "no": "5600",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND o.type = 'BIG_SHOP_GROUP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_82"
  },
  {
    "no": "5609",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_83"
  },
  {
    "no": "5611",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_84"
  },
  {
    "no": "5612",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 100",
    "queryAlias": "Q8_85"
  },
  {
    "no": "5625",
    "queryPattern": "Q8",
    "name": "Usage Aggregate Json byOrganizationSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateJson-function",
    "functionName": "byOrganizationSql",
    "isMatching": "1",
    "timestamp": "11/11/2024",
    "shortSQL": "_SAME_ WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "fullSQL": "SELECT o.resourceId AS \"組織ID\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"自拠点発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l JOIN organization_closure oc ON oc.parentId = o.resourceId AND l.organizationId = oc.childId WHERE l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'used' ) AS \"自店舗消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND o.type = 'SHOP' ORDER BY o.name, o.resourceId LIMIT 100 OFFSET 0",
    "queryAlias": "Q8_86"
  },
  {
    "no": "5849",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "6/26/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4da9b6c6-0239-4900-a4c1-a9031adda551/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_1"
  },
  {
    "no": "5850",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "6/26/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' AND l.couponCode LIKE '%022956007%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' AND l.couponCode LIKE '%022956007%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/09abebbd-c921-4dec-8639-07ecee82f78a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_2"
  },
  {
    "no": "5851",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "6/26/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0d0a3e7b-4764-439c-82d4-1789e8c307fc/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_3"
  },
  {
    "no": "5852",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "6/26/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '77d5a94c-249e-4a2e-b7eb-b13bb418733b' AND l.couponName LIKE '%商品A コード入力%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '77d5a94c-249e-4a2e-b7eb-b13bb418733b' AND l.couponName LIKE '%商品A コード入力%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/426d2fc6-26c1-4196-9ab0-48f56af7ca11/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_4"
  },
  {
    "no": "5853",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/3/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e7a9534-a97a-41aa-a12b-1d2e8593112c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_5"
  },
  {
    "no": "5855",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/19/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/06dc1ad3-a8b2-401d-90b1-9a6845b56379/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_6"
  },
  {
    "no": "5857",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/19/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b74e4a50-6590-4ee9-820c-2c6a647f15ec/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_7"
  },
  {
    "no": "5858",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/21/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6acf6dc1-500c-4ecf-8f84-57b517c5fa22/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_8"
  },
  {
    "no": "5860",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/24/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE5%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE5%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5b425ef0-9af2-4969-a5fe-30da23a25583/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_9"
  },
  {
    "no": "5861",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/24/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE4%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE4%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9dc74cde-8e86-4445-a848-c6776bbecf09/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_10"
  },
  {
    "no": "5862",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/24/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE3%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE3%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6b458106-57ab-412f-ac0f-cc1317062ebc/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_11"
  },
  {
    "no": "5863",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/26/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponName LIKE '%ゴーゴーカレー%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponName LIKE '%ゴーゴーカレー%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a2563e1f-4e33-4689-b08a-635c08ed09ed/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_12"
  },
  {
    "no": "5864",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/26/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e28a7cb9-bbae-4e3b-927e-78a58dc30d80/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_13"
  },
  {
    "no": "5865",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/26/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponName LIKE '%ゴーゴーカレー%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponName LIKE '%ゴーゴーカレー%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/16a536a3-0f08-43f8-b04f-22a7f85de023/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_14"
  },
  {
    "no": "5866",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2a185665-d95e-411a-9338-e1ae6eff22a6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_15"
  },
  {
    "no": "5867",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3ff9cc08-d182-40c7-a1cd-08f764d1eab6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_16"
  },
  {
    "no": "5869",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7a8210d3-250b-4464-b75c-aa9368f000df/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_17"
  },
  {
    "no": "5870",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0f46afff-1e9e-45d1-864b-746efc6563b8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_18"
  },
  {
    "no": "5871",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/2/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f5508989-11b6-4f5b-afb2-aaf70dad82b6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_19"
  },
  {
    "no": "5872",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/2/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14967b59-0df9-45d8-b8ff-2a0ba73c8f60/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_20"
  },
  {
    "no": "5873",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/3/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b6420a68-c580-408e-a083-0db389e642c0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_21"
  },
  {
    "no": "5874",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/4/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a77ca1d5-3a86-4c88-a219-93c1f29fdc9b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_22"
  },
  {
    "no": "5875",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/8/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC1012%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC1012%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0615177b-d18b-4181-a194-86139f996d94/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_23"
  },
  {
    "no": "5876",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/8/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC1012%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC1012%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ff5d04f-323d-460f-af81-59e62fc7a16e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_24"
  },
  {
    "no": "5877",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/20e0ac00-4ea5-48fd-a892-6cfbc52b1200/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_25"
  },
  {
    "no": "5878",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0de71884-8c2e-4665-806c-5da47c789880/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_26"
  },
  {
    "no": "5879",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE5%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE5%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/92e162b1-287d-487e-8d5a-7dec71196cdd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_27"
  },
  {
    "no": "5880",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE4%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE4%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8e0b847d-8742-4604-9d4e-fc3ad8a5dad2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_28"
  },
  {
    "no": "5881",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE3%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE3%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9d8f45a5-55e9-4884-9ee6-f8d2fddc404d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_29"
  },
  {
    "no": "5882",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki180%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki180%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e399eb33-7107-4597-bf12-c9e97adb3cb1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_30"
  },
  {
    "no": "5883",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki120 %' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki120 %' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/be46ce0a-06a0-4b97-8853-b3eb2fb98b59/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_31"
  },
  {
    "no": "5884",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki120 %' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki120 %' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ddac33e8-654a-4c3e-8f67-f622fccf7975/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_32"
  },
  {
    "no": "5885",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/25/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/87a53d28-5d15-4249-a10a-c8d94677140f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_33"
  },
  {
    "no": "5886",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/27/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4be71ca7-9c43-48d9-b9f2-358658c7cd06/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_34"
  },
  {
    "no": "5887",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/27/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7f68bf7-a121-439e-9d95-45d574bd5d1b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_35"
  },
  {
    "no": "5888",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/2/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e39a51fc-ddb1-440a-ad53-a5663789788f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_36"
  },
  {
    "no": "5889",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/4/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/881fe144-dae4-445f-899a-ee8d3bc98b42/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_37"
  },
  {
    "no": "5890",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/5/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%【本番\\\\_2309】%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%【本番\\\\_2309】%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f9c193c1-bc5f-4ce0-9507-0cca7b6a89c4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_38"
  },
  {
    "no": "5891",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/5/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/dbb72a67-6928-4ee0-8d5a-72c6ac5be775/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_39"
  },
  {
    "no": "5892",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/6/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a377f14-7797-4592-94ef-d6fc8a71dcca/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_40"
  },
  {
    "no": "5893",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/6/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/80eacd65-41b5-4bf5-bec4-be6da94a5ca7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_41"
  },
  {
    "no": "5894",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/7/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/275c38bf-38f1-4ba7-8fe8-372d32b0bd79/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_42"
  },
  {
    "no": "5895",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/9/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ab664e80-e9ed-4766-ac5e-560a6b6316e9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_43"
  },
  {
    "no": "5896",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/71e8b2d2-dbe7-44fb-822d-e0e43f524068/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_44"
  },
  {
    "no": "5897",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b1ae8b91-de00-4bb1-9fbd-136517153e9f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_45"
  },
  {
    "no": "5898",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.name LIKE '%kobeseikyo%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.name LIKE '%kobeseikyo%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/adc532d3-040d-46be-a501-fbba951e70a3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_46"
  },
  {
    "no": "5899",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/13/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78483a4b-f4b6-4f60-bc4f-e8c86af69a62/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_47"
  },
  {
    "no": "5900",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/13/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1718eae0-73c7-411b-be86-192eaec4f543/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_48"
  },
  {
    "no": "5901",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/15/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf33d983-d669-4a6a-8927-2de27ad775a9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_49"
  },
  {
    "no": "5902",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/17/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6c3369d0-ed83-48d1-a8ea-1f3a6f8b38c8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_50"
  },
  {
    "no": "5903",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/18/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponCode LIKE '%fruitcoupon-kta-2023-10%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponCode LIKE '%fruitcoupon-kta-2023-10%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fc1de867-5a81-447a-97a8-4f301213434c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_51"
  },
  {
    "no": "5904",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/20/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/557fc0b6-46eb-4d0c-a194-f4ef0fb1586d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_52"
  },
  {
    "no": "5905",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/27/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8c58ca1a-8438-4e9c-aad4-db7042ab65d2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_53"
  },
  {
    "no": "5906",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/30/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/546a130f-ef48-4795-b9e2-20090b084fac/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_54"
  },
  {
    "no": "5907",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/30/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/81b4dc15-39c6-43c9-8584-1417bc4d4ee7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_55"
  },
  {
    "no": "5908",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d54118f3-02aa-4640-883f-f2e183ffa2e9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_56"
  },
  {
    "no": "5909",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c248b886-90a0-4177-94f8-f2076d12acf8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_57"
  },
  {
    "no": "5910",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/2/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%壱番屋アンケートクーポン 100円券\\\\_1\\\\_2311%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%壱番屋アンケートクーポン 100円券\\\\_1\\\\_2311%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/86973fd7-0637-4b4e-958b-b11fdb454cb3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_58"
  },
  {
    "no": "5911",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/2/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%壱番屋アンケートクーポン 50円券\\\\_2\\\\_2311%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%壱番屋アンケートクーポン 50円券\\\\_2\\\\_2311%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/353e1789-2daa-4ce6-8cb9-6aa77837b35c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_59"
  },
  {
    "no": "5912",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/2/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b3763083-8eb2-443c-ab7b-78a66fff9f8e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_60"
  },
  {
    "no": "5913",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/2/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/54bddb2d-0b61-421c-a408-c48468041f83/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_61"
  },
  {
    "no": "5914",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/9/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7377481-2b85-4d59-a2d5-cbb016c13af7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_62"
  },
  {
    "no": "5915",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/9/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/36f7c1a3-5fb1-4762-940e-752073ebf9b8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_63"
  },
  {
    "no": "5916",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/10/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/20674157-9833-4119-9477-2314e519a587/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_64"
  },
  {
    "no": "5918",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/17/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/661e0e6d-b8f9-4f44-be33-4b136c159fa5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_65"
  },
  {
    "no": "5919",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/21/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/71a4fd80-711a-4df1-8887-a271dbdd2927/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_66"
  },
  {
    "no": "5920",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/22/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7a8e0f10-8f12-4690-a3c7-537b0d90353a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_67"
  },
  {
    "no": "5921",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/23/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2d337a53-f15d-4a6e-843c-e3e7fb01c82b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_68"
  },
  {
    "no": "5922",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/24/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6727b31d-b258-4585-9594-efa2e948edc6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_69"
  },
  {
    "no": "5923",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/24/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2710fb5e-b2de-4b03-96dc-38e6441a6cdc/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_70"
  },
  {
    "no": "5924",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/25/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7bd02776-faad-412f-b897-4408ad8d2922/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_71"
  },
  {
    "no": "5925",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cc741b7f-1d90-4e82-ab80-55a8b05d6005/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_72"
  },
  {
    "no": "5927",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/dda87929-9091-475c-8e9c-e27ba399a7de/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_73"
  },
  {
    "no": "5931",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a2e88e33-307a-4fed-9d62-b8882722e73e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_74"
  },
  {
    "no": "5933",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/28/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/13765d59-64ed-4806-9dba-c855db8935c7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_75"
  },
  {
    "no": "5934",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/28/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ed94cca0-fdc2-420c-a718-b0e1822b979f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_76"
  },
  {
    "no": "5935",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/29/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8d00bd5b-04b2-4e31-91b8-76e8c3940eee/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_77"
  },
  {
    "no": "5937",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/29/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/94ad0993-f499-4657-bfa5-fdeecf01592c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_78"
  },
  {
    "no": "5939",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/29/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/76ab98d2-4f7a-4d69-b582-16e4feae5411/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_79"
  },
  {
    "no": "5940",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/30/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7252c5b8-2e78-48ee-8652-cef8ad622aaf/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_80"
  },
  {
    "no": "5941",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e2cd4713-7422-423d-a76d-e6629ca9db0b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_81"
  },
  {
    "no": "5942",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fca5fb1e-a63e-449f-8a03-b978a76cb465/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_82"
  },
  {
    "no": "5943",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f686b65a-cceb-4c5f-b05d-07e2d8e7bdbd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_83"
  },
  {
    "no": "5944",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/1/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d98def0e-5a66-418c-9414-f452abb83bdf/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_84"
  },
  {
    "no": "5945",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/2/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/17ff72d2-12fa-413e-a600-8caf95631252/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_85"
  },
  {
    "no": "5946",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/3/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/92a4457f-de25-45c5-88cc-f720f432c142/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_86"
  },
  {
    "no": "5947",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/3/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4d5e6ee8-a6de-4c92-a59d-990caac144a3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_87"
  },
  {
    "no": "5948",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/3/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7554b17c-7910-45bb-83bf-b7fe3881839e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_88"
  },
  {
    "no": "5949",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/3/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%東京1010%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%東京1010%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d87f3fd7-ecd0-4bd3-b619-41f7d2286814/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_89"
  },
  {
    "no": "5950",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/3/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/88c7e07b-826c-4f18-8b92-851ba18b77a7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_90"
  },
  {
    "no": "5951",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/4/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d9a5a04f-ed09-4525-962f-f2d9f4592114/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_91"
  },
  {
    "no": "5952",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/5/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/de547c5f-700b-4378-aa6e-cc67b7e5bd45/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_92"
  },
  {
    "no": "5953",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/6/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/01d0c2c2-4491-45ed-a237-a280b5cb178c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_93"
  },
  {
    "no": "5954",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/7/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b3a47ffe-eff2-4834-9c21-a62b4b630fcc/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_94"
  },
  {
    "no": "5955",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/8/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a007239-43fa-470f-8d1f-96dee1de446e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_95"
  },
  {
    "no": "5956",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/8/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9f64a4b1-0b4d-43b9-a30b-f8ec4564c1e5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_96"
  },
  {
    "no": "5957",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/8/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/331f6817-257c-4ecb-8a89-74f83fee5ec1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_97"
  },
  {
    "no": "5958",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/9/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/41cda8b9-49e0-496d-857f-957e2f7c3204/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_98"
  },
  {
    "no": "5959",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/10/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ed0b75d-5837-4fb5-a7fa-243de9659ada/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_99"
  },
  {
    "no": "5960",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/10/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c33c98da-1afe-488f-bba9-812a8d5da75c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_100"
  },
  {
    "no": "5961",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/08495cb0-eaed-4782-b7e2-c99d94353692/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_101"
  },
  {
    "no": "5962",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ea0de1af-2394-46d0-b53d-1e3f4862aea5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_102"
  },
  {
    "no": "5963",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%【本番\\\\_23010%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%【本番\\\\_23010%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9926c7ec-833c-4c8a-9c2e-e33a608ed53c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_103"
  },
  {
    "no": "5964",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/11/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c1b82baa-2170-4cca-b22c-68162305cac6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_104"
  },
  {
    "no": "5965",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6c997fc1-be03-4d50-a9c4-e8b59bda7080/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_105"
  },
  {
    "no": "5966",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4f25d925-b7d6-4f76-a7e2-8b823eebb7d2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_106"
  },
  {
    "no": "5967",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3fec7427-a9b2-4e3e-9d7b-12516ccac8ed/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_107"
  },
  {
    "no": "5968",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e4b034b1-956f-4996-919a-a2e8c0377a7b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_108"
  },
  {
    "no": "5969",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c043ef8-e9bf-493c-abfd-384cb9c29d2b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_109"
  },
  {
    "no": "5970",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/10551ee8-ad63-49ef-a34b-19efab4880a0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_110"
  },
  {
    "no": "5971",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%ji%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%ji%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a4cba85f-0c41-48aa-a384-0ae1617d6d10/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_111"
  },
  {
    "no": "5972",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7c0f1a7-3430-43ca-aa26-f75fa5bc4b3f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_112"
  },
  {
    "no": "5973",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ff736176-63f6-4aa6-b6b0-7bed9809999b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_113"
  },
  {
    "no": "5974",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/13/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4821c8f1-5bd6-4d54-be2e-84886ad7ef42/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_114"
  },
  {
    "no": "5975",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/14/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e3874ed0-514e-466a-bfcf-307438af4511/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_115"
  },
  {
    "no": "5976",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/15/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35153619-db43-44fe-a0d0-767c9d55fc00/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_116"
  },
  {
    "no": "5977",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/15/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ca599a3-1c03-4b96-bddc-f6f102f89f35/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_117"
  },
  {
    "no": "5978",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/15/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/29815bf5-c0aa-445e-b99d-c3d480cd555f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_118"
  },
  {
    "no": "5979",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/16/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7df14682-e38b-4805-9eb3-8c2e696a7337/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_119"
  },
  {
    "no": "5980",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/16/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f0162291-0869-41b7-b09f-56f905b5dcbe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_120"
  },
  {
    "no": "5981",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/17/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f8434020-cbde-481b-9d56-343bead0976a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_121"
  },
  {
    "no": "5982",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/18/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e7f00235-944c-4ad0-be12-cc2c1de5b911/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_122"
  },
  {
    "no": "5983",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/19/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/49213d31-27a6-4039-a559-d4bf248eeb22/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_123"
  },
  {
    "no": "5984",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/20/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5b5b379d-da45-4c71-9f18-a0d3081eb4ba/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_124"
  },
  {
    "no": "5985",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/21/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a8e5f77a-2708-40f3-b6a4-9401d3e008ae/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_125"
  },
  {
    "no": "5986",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/22/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7951d180-f9aa-4959-b073-3321cb6934c1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_126"
  },
  {
    "no": "5987",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/22/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d03a2a3d-38cd-4670-b7bf-6389ed12750d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_127"
  },
  {
    "no": "5988",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/22/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8c1e926d-7bcf-4a11-97a1-2014d3194a49/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_128"
  },
  {
    "no": "5989",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/22/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/eae2b012-0667-455b-ab83-56f7f0476aa0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_129"
  },
  {
    "no": "5990",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/23/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f6487737-34e1-45d8-9082-1c8a611138cd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_130"
  },
  {
    "no": "5991",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/23/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/973221c9-253f-40aa-9d82-a90da71e94b5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_131"
  },
  {
    "no": "5992",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/23/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/339cd040-2169-40e3-8eb2-7d76986798fd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_132"
  },
  {
    "no": "5993",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/23/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2bc0cec7-51b2-4d16-8d68-c4b309b9f7b1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_133"
  },
  {
    "no": "5994",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/23/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d120c278-2244-4511-b695-cb0d8b6f5cc7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_134"
  },
  {
    "no": "5995",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/23/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ab0f0de8-671a-4927-b394-4161adb59171/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_135"
  },
  {
    "no": "5996",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/23/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/aec91681-a2c2-4ef0-b318-d1e3b75139d6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_136"
  },
  {
    "no": "5997",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/24/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2c4ec220-990b-4d8c-9c6c-93f11cc4c759/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_137"
  },
  {
    "no": "5998",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/25/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3bd4f433-c4c6-49fd-89b2-4df3eb201550/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_138"
  },
  {
    "no": "5999",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/26/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9a2b3fe4-9fee-4f29-b299-51427d4d0bf0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_139"
  },
  {
    "no": "6000",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/28/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2312%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2312%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0e63c6a0-3969-415a-8dd0-3bfa63b199e4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_140"
  },
  {
    "no": "6001",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/28/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35d70299-ceac-4402-ac51-02a660806391/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_141"
  },
  {
    "no": "6002",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/28/2023",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e6ce0476-f2a8-4872-9d01-42daa07493a5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_142"
  },
  {
    "no": "6003",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9a8d9f49-963e-4147-8762-861421c032af/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_143"
  },
  {
    "no": "6004",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c58bb15b-fa25-4506-80a0-ce9fef28d31c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_144"
  },
  {
    "no": "6005",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2312%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2312%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/af197c6b-4c49-44ab-b293-c99bde0bbd3e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_145"
  },
  {
    "no": "6006",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/762b0d70-659f-496b-8c24-c104b64201f5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_146"
  },
  {
    "no": "6007",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/59933021-6001-4104-bd5f-cd080d2425f3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_147"
  },
  {
    "no": "6008",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ba4ddebc-d3f0-4128-b762-4d0a952bd434/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_148"
  },
  {
    "no": "6009",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b9360d97-f2eb-4ae6-b951-4ebcec8da360/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_149"
  },
  {
    "no": "6010",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b04d27fb-2588-4a6b-86f7-dbc76744369d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_150"
  },
  {
    "no": "6011",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1476ec3a-a91d-48a7-ab79-37c604418cc8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_151"
  },
  {
    "no": "6012",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/19/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/574b3b1d-3372-4aba-9a73-f6e954929515/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_152"
  },
  {
    "no": "6013",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/64b0aa3c-b04e-4fcd-a0e4-b3c92b64c01f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_153"
  },
  {
    "no": "6014",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2402%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2402%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f36d730c-e4fb-4ea9-9695-7887d460f78a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_154"
  },
  {
    "no": "6015",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/29/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4a879612-0975-4d7f-8280-ae20f424d504/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_155"
  },
  {
    "no": "6016",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/29/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c213a257-2d76-45b1-b106-f9df8aeb87b7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_156"
  },
  {
    "no": "6017",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "1/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' AND l.couponCode LIKE '%20230801-31-kaunseringu%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' AND l.couponCode LIKE '%20230801-31-kaunseringu%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/17b0eaa1-9726-4e47-8545-8dccc4fddd9a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_157"
  },
  {
    "no": "6018",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40718bc8-3dca-4ceb-a250-b58acdd09e25/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_158"
  },
  {
    "no": "6019",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4f6e5e5a-65c4-4b9d-913f-993b3d2839f5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_159"
  },
  {
    "no": "6020",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c846a9ec-f8e6-4bf5-8fa4-c9ecb1c70a70/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_160"
  },
  {
    "no": "6021",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2402%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2402%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/bda1828e-30b3-4645-95af-8fc28851668a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_161"
  },
  {
    "no": "6022",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponCode LIKE '%029308%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponCode LIKE '%029308%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/63747f6e-622f-40ee-b4d6-20cf7b3c0377/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_162"
  },
  {
    "no": "6024",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fcf13836-b923-4bbf-a08e-3b3ad44a8cae/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_163"
  },
  {
    "no": "6025",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1dde06fa-124c-4d48-8634-e05345cc7a3c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_164"
  },
  {
    "no": "6026",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/16/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f1587821-76e1-4c39-a01c-9dc9b29611b0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_165"
  },
  {
    "no": "6027",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/16/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d92e892d-ce1c-441e-baf4-bf4e7f69854d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_166"
  },
  {
    "no": "6028",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/16/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0b606eb3-8966-4c16-8ba6-c93cfd95fbe7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_167"
  },
  {
    "no": "6029",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "2/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c5ac151d-f0ca-428d-93a0-dba919145c60' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c5ac151d-f0ca-428d-93a0-dba919145c60' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0feff883-6359-4805-b518-5efcb1eb1730/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_168"
  },
  {
    "no": "6030",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "3/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8896f149-5133-4679-bc53-6fa74f19d355/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_169"
  },
  {
    "no": "6031",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "3/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5f884861-7fc3-4eed-9c6f-d5c63e00b5fe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_170"
  },
  {
    "no": "6032",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "3/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78585734-a878-4b6a-8043-9fdddd3b991a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_171"
  },
  {
    "no": "6033",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "3/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5f4c937b-1fb0-489c-9da5-6d452317d388/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_172"
  },
  {
    "no": "6034",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "3/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b8fa2dd5-d61d-499f-98a6-3bb18a56babb/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_173"
  },
  {
    "no": "6035",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "3/27/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ac83c6d-7d1e-4f24-91b5-42ec7b004e23/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_174"
  },
  {
    "no": "6036",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4eb6d4c9-26ee-42ce-bd60-e05164912713/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_175"
  },
  {
    "no": "6037",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/4/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a1a97589-3554-49fc-8d4c-d2221f565b7e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_176"
  },
  {
    "no": "6038",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/606bb10f-8e71-43e7-9a82-a99becd0a7ed/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_177"
  },
  {
    "no": "6039",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4b3dc73f-5a9b-435e-a9b5-90f0391b2fc3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_178"
  },
  {
    "no": "6040",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND l.couponCode LIKE '%aeonzannen%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND l.couponCode LIKE '%aeonzannen%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf7bde01-ee88-4590-9c29-4d8d62291fd7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_179"
  },
  {
    "no": "6041",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4bd61eb3-07c1-4489-904c-9f4e65180a15/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_180"
  },
  {
    "no": "6043",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/72c723e3-7307-4a1c-8a05-34375ef79af1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_181"
  },
  {
    "no": "6044",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d991a765-5d8e-4024-80da-badf0ea5e1af/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_182"
  },
  {
    "no": "6045",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "4/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1db1a84a-c51f-4aa4-95a9-d98523748634/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_183"
  },
  {
    "no": "6046",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c4da17f-731e-4d00-b1f9-0b22973dbcb1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_184"
  },
  {
    "no": "6047",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/48f86122-3930-45e9-b26b-f268b555a862/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_185"
  },
  {
    "no": "6048",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2f5c337b-0cb4-49af-b057-db6faab5f68e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_186"
  },
  {
    "no": "6049",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40df404e-f214-43e9-883d-6320a38e8a60/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_187"
  },
  {
    "no": "6050",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a1eb8ce3-ed76-48ac-9000-502d41733094/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_188"
  },
  {
    "no": "6051",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8b399454-5caa-4064-86e9-b633816c9c5e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_189"
  },
  {
    "no": "6052",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a3348357-d4c9-4eb8-8590-df387bc399a7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_190"
  },
  {
    "no": "6053",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/7/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/65f8c38b-2fe4-4149-9fb3-050c0f040b41/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_191"
  },
  {
    "no": "6054",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b5a84bf1-d378-41a6-897f-05858cbb6c9d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_192"
  },
  {
    "no": "6055",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0b400d8b-5bce-4973-bc21-2ab1c0121060/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_193"
  },
  {
    "no": "6056",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/24/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/96e57bee-8b64-4a23-b36d-8250d557edbe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_194"
  },
  {
    "no": "6057",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/93b7117d-5ada-4fb7-b540-9b58087f122c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_195"
  },
  {
    "no": "6058",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/29/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7953501d-3d98-4d2a-8b95-fcf98f257cc2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_196"
  },
  {
    "no": "6059",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "5/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9f16f727-243b-4568-aec4-f217fe44373b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_197"
  },
  {
    "no": "6060",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "6/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9b767096-64dc-47e8-bcc0-c566e861464d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_198"
  },
  {
    "no": "6061",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/25713b72-adf3-4ecd-abb7-b40ba3461511/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_199"
  },
  {
    "no": "6062",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5479f7d1-8592-4f8f-9eeb-ebe8842c60b8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_200"
  },
  {
    "no": "6063",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c440ac93-cc1a-400e-857c-afc70f61c267/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_201"
  },
  {
    "no": "6064",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fc673a07-0768-4005-b7a0-e6ee7db6f700/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_202"
  },
  {
    "no": "6067",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7db082dd-7046-4027-b5ec-3c6fb2b4c718/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_203"
  },
  {
    "no": "6068",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5c5f1a02-bce0-4068-93c5-701f18c3145b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_204"
  },
  {
    "no": "6069",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9d95c4c4-bc77-4ddd-b650-a8c973cadd62/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_205"
  },
  {
    "no": "6070",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%KC103%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%KC103%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/18797882-1e18-48f6-9d1a-f00fc9d62d84/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_206"
  },
  {
    "no": "6071",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC103%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC103%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9be41e1a-6097-490e-86a9-e394f1c5d58b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_207"
  },
  {
    "no": "6072",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "7/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%030038007%' AND l.couponName LIKE '%KC1032%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%030038007%' AND l.couponName LIKE '%KC1032%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/853b390e-fcb0-4255-b5dc-410d4e34cc61/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_208"
  },
  {
    "no": "6073",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e7c9aca9-1c36-4197-81a6-a5362d00a508/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_209"
  },
  {
    "no": "6074",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%art-ishigakijima-samplecoupon1%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%art-ishigakijima-samplecoupon1%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/37a82985-1ccc-48b6-98ae-b9916f8375ed/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_210"
  },
  {
    "no": "6075",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/27/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e448495-ee76-4156-b821-be379ed671a7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_211"
  },
  {
    "no": "6076",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/27/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/21e1fc86-6d37-40d2-bc8b-dca157c3c3d4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_212"
  },
  {
    "no": "6077",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/27/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c9ce5122-3f8a-4e12-96c1-eba3a3b943e6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_213"
  },
  {
    "no": "6078",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/27/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5d27a658-fbd2-4e67-bcfd-c3f14dfc439c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_214"
  },
  {
    "no": "6079",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/81c15330-82e2-4e0c-88b6-fff3ced580e9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_215"
  },
  {
    "no": "6080",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "8/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c06f8a8e-a5ce-4e3d-950f-287cf95f1e40/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_216"
  },
  {
    "no": "6082",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/83605c7b-96fe-4f1f-bad8-91c8aae187df/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_217"
  },
  {
    "no": "6088",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "9/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND l.couponCode LIKE '%121212%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND l.couponCode LIKE '%121212%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/42d84b15-d9eb-45a0-a5b1-dbbacf04f1ba/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_218"
  },
  {
    "no": "6090",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a8750b6c-e125-4f08-bf17-4f2750db3bc3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_219"
  },
  {
    "no": "6091",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7b11d791-6297-4a52-941f-cd7afebf1084/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_220"
  },
  {
    "no": "6092",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/599a6189-f78e-472f-9803-8f2643893e74/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_221"
  },
  {
    "no": "6093",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c76336e7-1d75-4c39-b8dc-e3918d855a93/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_222"
  },
  {
    "no": "6094",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/7/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/39d377ca-207c-457b-951a-8e09e81adf62/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_223"
  },
  {
    "no": "6095",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/7/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b21d523f-44f1-47f6-ae17-662e0a7a6a39/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_224"
  },
  {
    "no": "6096",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/7/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cd12a569-0d68-42c1-b443-2ddeeb13eca4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_225"
  },
  {
    "no": "6097",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf61201a-c2a2-4ac8-83df-9b019e931772/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_226"
  },
  {
    "no": "6098",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a3607fec-8746-4e2f-bb81-b900fdd62f8c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_227"
  },
  {
    "no": "6099",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/07dbda08-6125-4a43-bac7-2bf3f969af4c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_228"
  },
  {
    "no": "6100",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/23583a16-0061-4f4d-ba3d-7f4948179344/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_229"
  },
  {
    "no": "6101",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/da7586c0-5167-4ef9-88de-aadd1f8602b4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_230"
  },
  {
    "no": "6102",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f027938d-331f-42a7-bd9b-de3afd5e9a55/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_231"
  },
  {
    "no": "6103",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0e1783a7-fddd-4767-b2e0-d37930c421c8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_232"
  },
  {
    "no": "6104",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/19c33f25-f622-4c6f-81a0-58ca51b517ae/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_233"
  },
  {
    "no": "6105",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a4fad33-acf5-47b7-a25f-95bed57c7c9d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_234"
  },
  {
    "no": "6106",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/72ca19a6-d7a6-467b-b338-d4ff0d72072d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_235"
  },
  {
    "no": "6107",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ca7693ac-84c5-4c5b-b340-a11c037860da/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_236"
  },
  {
    "no": "6108",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14929483-f425-460c-83e5-e4f4e40e497a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_237"
  },
  {
    "no": "6109",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/16/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e61abfe-8ee3-4bbf-8742-156e1149b40c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_238"
  },
  {
    "no": "6110",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/17/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0d36aa4a-dace-4f50-946b-f2330e49aa89/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_239"
  },
  {
    "no": "6111",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d7508fac-73e6-4257-9e39-2f3d3ac4647d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_240"
  },
  {
    "no": "6112",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/18/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f662e1b6-b81e-4fda-a757-db726a8be2a5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_241"
  },
  {
    "no": "6113",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/21/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c80c7e64-81d9-40da-b86d-5cc1f6afb218/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_242"
  },
  {
    "no": "6114",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7fb34974-7159-419e-b49b-b2d96373f153/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_243"
  },
  {
    "no": "6115",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/768c46cc-21b1-4aaa-a740-ff312927ab97/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_244"
  },
  {
    "no": "6116",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ddae8e7d-8e1c-4f73-9933-42a218c0c8fe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_245"
  },
  {
    "no": "6117",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/23/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4c7e314e-57c0-47af-be0b-f8f6847e20bd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_246"
  },
  {
    "no": "6118",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/24/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35b421ea-271e-48e7-b6de-23c13610d724/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_247"
  },
  {
    "no": "6119",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/827d0494-9b75-4da4-9558-b2753112855a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_248"
  },
  {
    "no": "6120",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c542576-4ffa-4187-a81a-b956d1c5a33b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_249"
  },
  {
    "no": "6121",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%Ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%Ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/36fdd7fa-d36e-4fe3-9179-0e67f2f2c44d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_250"
  },
  {
    "no": "6122",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2b5d5a2e-7767-4329-878d-1cf9ac6e0c6c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_251"
  },
  {
    "no": "6123",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e5c3adfa-de26-4972-a853-4019e26c445b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_252"
  },
  {
    "no": "6124",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/29/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/516762b6-8279-45ef-bb12-293ad2cdcbe6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_253"
  },
  {
    "no": "6125",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "10/30/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/459e2201-b1f1-44fe-80dd-e2844e20c4b6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_254"
  },
  {
    "no": "6128",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/1/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5a90d691-93b3-4dc0-8151-b6a72c345744/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_255"
  },
  {
    "no": "6129",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/913cfb8c-b44e-4aa3-a5ee-4c3e2df3106d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_256"
  },
  {
    "no": "6130",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7d063186-7bce-4c65-84a2-34c9a24af1e3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_257"
  },
  {
    "no": "6131",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/693e5d05-c603-45bc-9db1-73c8234e7e99/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_258"
  },
  {
    "no": "6132",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3ec0f997-806e-4bea-999c-2c499fe259c3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_259"
  },
  {
    "no": "6133",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/755d868a-fb10-4154-86fa-b1a898c7c08d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_260"
  },
  {
    "no": "6134",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/7/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/74488c83-a5f0-4ebb-b1b4-a5249d8d5cbd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_261"
  },
  {
    "no": "6135",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/7/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a84339f6-831f-4ca6-84b7-9b915badeb1c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_262"
  },
  {
    "no": "6136",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/8/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/609de23a-13c4-41dc-8958-a34ee7ee3314/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_263"
  },
  {
    "no": "6137",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/be1b42c9-a09f-4b40-86cf-b3cbd4946c55/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_264"
  },
  {
    "no": "6138",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4b32f8c9-c7df-46ac-9f6e-39a50afc2f8e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_265"
  },
  {
    "no": "6139",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a5332727-eb12-4e3e-aa38-d329feadac9c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_266"
  },
  {
    "no": "6140",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/13/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3a8515bf-ed7a-439a-add4-cdce2610117b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_267"
  },
  {
    "no": "6141",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/14/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/30b4d570-1914-44ee-bf23-be63d2b5495c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_268"
  },
  {
    "no": "6142",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/14/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/46a32076-93e6-44af-a821-6cc93eae56f4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_269"
  },
  {
    "no": "6143",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a75f70a4-7a10-4055-b6a8-a24b2b2b01df/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_270"
  },
  {
    "no": "6144",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/15/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b16de748-68fb-4dcd-8259-97168afbd764/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_271"
  },
  {
    "no": "6145",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/19/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14da2371-bc9e-48f3-9239-62e003acf9ac/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_272"
  },
  {
    "no": "6146",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/19/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/04ac3083-ffb6-4eae-9714-73fe6688d8ba/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_273"
  },
  {
    "no": "6147",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/20/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/27aba9d6-3c32-4ff8-94dd-c15ded95933c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_274"
  },
  {
    "no": "6148",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/20/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78a33221-4a41-4f01-85a5-6b12c66dfc53/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_275"
  },
  {
    "no": "6149",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/21/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40a2e4e0-f014-4634-8a97-cd2662611033/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_276"
  },
  {
    "no": "6150",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6cc0d22d-738f-423e-8708-f67f58acc3c0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_277"
  },
  {
    "no": "6151",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/22/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/262ce766-3b76-4e70-80a3-479751642bc6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_278"
  },
  {
    "no": "6152",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b26d7163-1dd2-49ac-b4c4-455d4d82a6e4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_279"
  },
  {
    "no": "6153",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/25/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE2coupon%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE2coupon%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1dc463a0-243e-44ec-ae0b-429f1db3f58f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_280"
  },
  {
    "no": "6154",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/26/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5488c41e-6c68-4c4d-a818-2f79030552be/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_281"
  },
  {
    "no": "6155",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/558ac29e-852c-4aeb-aed2-bed9b92e33a4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_282"
  },
  {
    "no": "6156",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5ac0cfa4-d74f-4321-9be4-c8ff49703d4a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_283"
  },
  {
    "no": "6157",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/28/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7b99878d-31fe-456f-8e42-02407e59010d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_284"
  },
  {
    "no": "6158",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/29/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/22906843-f1c0-4e9d-b5f9-7d75ab73ea27/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_285"
  },
  {
    "no": "6159",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "11/29/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/903521c7-8244-4e89-9a4b-af7b1c8c2fe5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_286"
  },
  {
    "no": "6160",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/2/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3c440c0f-1531-423a-9867-6eda8ba9ece7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_287"
  },
  {
    "no": "6161",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/3/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4bbaa9a6-e23c-4d18-8d45-a0c2274d28a1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_288"
  },
  {
    "no": "6162",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/4/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f6233bfa-d4dc-40d0-b83a-0630e894d709/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_289"
  },
  {
    "no": "6163",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/5/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9fdeb359-d2a0-4550-a42d-336ebf7aed3d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_290"
  },
  {
    "no": "6164",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/6/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/83b7605a-7993-48d2-b150-df65d765207b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_291"
  },
  {
    "no": "6165",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/9/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c8076ee5-035e-4f3b-9667-9578b91ec6e4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_292"
  },
  {
    "no": "6166",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/76f4e41b-7727-492e-a827-4cf88fa3d81c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_293"
  },
  {
    "no": "6167",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/849fb7d7-4cbf-4c01-bd89-b0c4c2169c33/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_294"
  },
  {
    "no": "6168",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/10/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' AND l.couponName LIKE '%11%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' AND l.couponName LIKE '%11%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a620bee7-a9f2-4b46-9021-706c112d13c1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_295"
  },
  {
    "no": "6169",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/11/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/120549c1-145b-473b-ad2e-d1f46b0bc3b7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_296"
  },
  {
    "no": "6170",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/12/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ffa818fd-04cf-4cda-909d-67b287b21c1a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_297"
  },
  {
    "no": "6171",
    "queryPattern": "Q9",
    "name": "Usage Aggregate Csv byCouponMasterSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byCouponMasterCsvSql",
    "isMatching": "1",
    "timestamp": "12/13/2024",
    "shortSQL": "_SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\", couponCode AS \"クーポンコード\", couponName AS \"クーポン名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId ) AS \"使用済数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId ) AS \"キャンセル\"  FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/68d07f61-695f-4fc7-9d50-9a79503f8a60/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q9_298"
  },
  {
    "no": "6322",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "7/7/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7a5aab76-3331-44c1-806a-ce544da6875d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_1"
  },
  {
    "no": "6324",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "7/19/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/626d4f4a-9c6e-4a5e-9ecc-af548ec2b6c3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_2"
  },
  {
    "no": "6327",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "7/24/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4daa5fae-e23e-4a2e-ac2f-67e04b1948ba/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_3"
  },
  {
    "no": "6336",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "8/1/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1aafa6f4-75b4-4d99-8e0d-0e9b5a42be1b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_4"
  },
  {
    "no": "6385",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "11/14/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/bb709c96-3939-4cdc-aeb4-50e16efa1f67/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_5"
  },
  {
    "no": "6394",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9123ee7f-42af-42b3-906e-1ea0ceec0988/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_6"
  },
  {
    "no": "6396",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/98b8c169-2061-4fa6-8bad-45216501de63/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_7"
  },
  {
    "no": "6397",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SMALL_SHOP_GROUP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SMALL_SHOP_GROUP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7947a4cf-6d7e-49e3-9703-77d4fe1590fe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_8"
  },
  {
    "no": "6398",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/643d1f99-920e-48e5-a9f2-85a29fba48c9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_9"
  },
  {
    "no": "6400",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "11/27/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c53ac46e-0c4c-4f64-a678-341cad4d5a73/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_10"
  },
  {
    "no": "6404",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "11/29/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/59852d19-46c0-4899-8d6a-6c54d8574b95/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_11"
  },
  {
    "no": "6406",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "11/29/2023",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d653d437-467b-41eb-b41e-d2c7aa99e53d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_12"
  },
  {
    "no": "6491",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "2/7/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/72fa5163-d5a2-4886-b5b2-41c0a4f2996f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_13"
  },
  {
    "no": "6510",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "4/12/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/23cc76a5-1c04-4ed2-8c8f-145e64b5aaa8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_14"
  },
  {
    "no": "6533",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "7/12/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/11fb5920-dd80-4c01-b000-95b34e588989/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_15"
  },
  {
    "no": "6534",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "7/12/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SMALL_SHOP_GROUP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SMALL_SHOP_GROUP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1e771793-b2db-45f7-8b62-8e0412246130/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_16"
  },
  {
    "no": "6549",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "9/1/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/307ece39-0432-408f-a261-4dd974b4e177/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_17"
  },
  {
    "no": "6551",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "9/2/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4be453df-9747-4eac-922b-3d4cc3a2d7d7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_18"
  },
  {
    "no": "6552",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "9/2/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1010b8bc-28eb-47dd-8b96-a4c67649f0f2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_19"
  },
  {
    "no": "6553",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "9/3/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2c07c81a-f2f2-4249-aba2-bc09aa52b293/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_20"
  },
  {
    "no": "6554",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "9/4/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b1afec81-c767-4ff4-b5a4-9c1a33862e2b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_21"
  },
  {
    "no": "6555",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "9/9/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/954159c9-7f73-4b73-b8a3-16441447a3e8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_22"
  },
  {
    "no": "6557",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "9/20/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'SHOP' AND oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.name LIKE '%上野マルイ%' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'SHOP' AND oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' AND o.name LIKE '%上野マルイ%' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c08a0652-4a34-4126-a5c6-46d27de5f660/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_23"
  },
  {
    "no": "6594",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'BIG_SHOP_GROUP' AND oc.parentId = 'dcdaf32b-1480-4f98-9816-f35b349d6310' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'BIG_SHOP_GROUP' AND oc.parentId = 'dcdaf32b-1480-4f98-9816-f35b349d6310' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/989f87a7-d635-4ccf-a76d-8c2886f8c7c2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_24"
  },
  {
    "no": "6595",
    "queryPattern": "Q10",
    "name": "Usage Aggregate Csv byOrganizationCsvSql",
    "lambda": "prd-coupon-invokeCouponUsageAggregateCsvUrl-function",
    "functionName": "byOrganizationCsvSql",
    "isMatching": "1",
    "timestamp": "10/31/2024",
    "shortSQL": "_SAME_ WHERE o.type = 'BIG_SHOP_GROUP' AND oc.parentId = 'dcdaf32b-1480-4f98-9816-f35b349d6310' ORDER BY o.name $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "fullSQL": "unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\", ( SELECT COUNT(*) FROM coupon_logs_filtered l WHERE l.organizationId = o.resourceId AND l.type = 'issued' ) AS \"発行数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'used' ) AS \"消込数\", ( SELECT COUNT(*) FROM coupon_logs_filtered l, organization_closure oc WHERE oc.parentId = o.resourceId AND oc.childId = l.usedShopId AND l.type = 'canceled' ) AS \"キャンセル\"  FROM organization o JOIN organization_closure oc ON oc.childId = o.resourceId WHERE o.type = 'BIG_SHOP_GROUP' AND oc.parentId = 'dcdaf32b-1480-4f98-9816-f35b349d6310' ORDER BY o.name $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2af07bf7-3779-4b34-bb99-e5df585a915d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF",
    "queryAlias": "Q10_25"
  }
]