no,timestamp,shortSQL,fullSQL
1,1687762072533," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4da9b6c6-0239-4900-a4c1-a9031adda551/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
2,1687764181054," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' AND l.couponCode LIKE '%022956007%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' AND l.couponCode LIKE '%022956007%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/09abebbd-c921-4dec-8639-07ecee82f78a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
3,1687764618975," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0d0a3e7b-4764-439c-82d4-1789e8c307fc/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
4,1687768717589," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '77d5a94c-249e-4a2e-b7eb-b13bb418733b' AND l.couponName LIKE '%商品A　コード入力%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '77d5a94c-249e-4a2e-b7eb-b13bb418733b' AND l.couponName LIKE '%商品A　コード入力%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/426d2fc6-26c1-4196-9ab0-48f56af7ca11/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
5,1688349965362," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e7a9534-a97a-41aa-a12b-1d2e8593112c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
6,1689755249204," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/06dc1ad3-a8b2-401d-90b1-9a6845b56379/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
7,1689759467135," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b74e4a50-6590-4ee9-820c-2c6a647f15ec/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
8,1689923894385," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6acf6dc1-500c-4ecf-8f84-57b517c5fa22/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
9,1690172235204," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE5%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE5%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5b425ef0-9af2-4969-a5fe-30da23a25583/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
10,1690172351565," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE4%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE4%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9dc74cde-8e86-4445-a848-c6776bbecf09/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
11,1690172711975," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE3%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE3%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6b458106-57ab-412f-ac0f-cc1317062ebc/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
12,1690334570348," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponName LIKE '%ゴーゴーカレー%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponName LIKE '%ゴーゴーカレー%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a2563e1f-4e33-4689-b08a-635c08ed09ed/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
13,1690334608807," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e28a7cb9-bbae-4e3b-927e-78a58dc30d80/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
14,1690334623227," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponName LIKE '%ゴーゴーカレー%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponName LIKE '%ゴーゴーカレー%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/16a536a3-0f08-43f8-b04f-22a7f85de023/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
15,1690859585984," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2a185665-d95e-411a-9338-e1ae6eff22a6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
16,1690864309982," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3ff9cc08-d182-40c7-a1cd-08f764d1eab6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
17,1690876369996," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7a8210d3-250b-4464-b75c-aa9368f000df/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
18,1690876540795," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0f46afff-1e9e-45d1-864b-746efc6563b8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
19,1690937108419," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' AND l.couponCode LIKE '%0001%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f5508989-11b6-4f5b-afb2-aaf70dad82b6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
20,1690958347439," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14967b59-0df9-45d8-b8ff-2a0ba73c8f60/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
21,1691041910827," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b6420a68-c580-408e-a083-0db389e642c0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
22,1691110341863," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a77ca1d5-3a86-4c88-a219-93c1f29fdc9b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
23,1691476533305," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC1012%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC1012%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0615177b-d18b-4181-a194-86139f996d94/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
24,1691478359000," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC1012%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC1012%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ff5d04f-323d-460f-af81-59e62fc7a16e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
25,1693533081832," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/20e0ac00-4ea5-48fd-a892-6cfbc52b1200/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
26,1693537486392," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0de71884-8c2e-4665-806c-5da47c789880/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
27,1694396807205," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE5%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE5%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/92e162b1-287d-487e-8d5a-7dec71196cdd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
28,1694396938988," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE4%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE4%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8e0b847d-8742-4604-9d4e-fc3ad8a5dad2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
29,1694397038828," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE3%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoSINGLE3%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9d8f45a5-55e9-4884-9ee6-f8d2fddc404d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
30,1694397213205," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki180%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki180%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e399eb33-7107-4597-bf12-c9e97adb3cb1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
31,1694397333579," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki120 %' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki120 %' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/be46ce0a-06a0-4b97-8853-b3eb2fb98b59/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
32,1694397448322," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki120 %' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74' AND l.couponCode LIKE '%gogoaiseki120 %' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ddac33e8-654a-4c3e-8f67-f622fccf7975/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
33,1695605869795," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/87a53d28-5d15-4249-a10a-c8d94677140f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
34,1695772723966," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4be71ca7-9c43-48d9-b9f2-358658c7cd06/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
35,1695790977037," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7f68bf7-a121-439e-9d95-45d574bd5d1b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
36,1696221097222," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e39a51fc-ddb1-440a-ad53-a5663789788f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
37,1696379814277," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/881fe144-dae4-445f-899a-ee8d3bc98b42/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
38,1696459336760," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%【本番\\_2309】%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%【本番\\_2309】%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f9c193c1-bc5f-4ce0-9507-0cca7b6a89c4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
39,1696465346686," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/dbb72a67-6928-4ee0-8d5a-72c6ac5be775/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
40,1696571972689," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a377f14-7797-4592-94ef-d6fc8a71dcca/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
41,1696572450268," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/80eacd65-41b5-4bf5-bec4-be6da94a5ca7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
42,1696646732977," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/275c38bf-38f1-4ba7-8fe8-372d32b0bd79/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
43,1696808058883," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ab664e80-e9ed-4766-ac5e-560a6b6316e9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
44,1696992904982," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/71e8b2d2-dbe7-44fb-822d-e0e43f524068/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
45,1696993065283," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b1ae8b91-de00-4bb1-9fbd-136517153e9f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
46,1697008681193," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.name LIKE '%kobeseikyo%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND o.name LIKE '%kobeseikyo%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/adc532d3-040d-46be-a501-fbba951e70a3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
47,1697152194355," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78483a4b-f4b6-4f60-bc4f-e8c86af69a62/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
48,1697159568398," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1718eae0-73c7-411b-be86-192eaec4f543/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
49,1697350748540," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9' AND l.couponName LIKE '%200%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf33d983-d669-4a6a-8927-2de27ad775a9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
50,1697532770708," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6c3369d0-ed83-48d1-a8ea-1f3a6f8b38c8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
51,1697593443681," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponCode LIKE '%fruitcoupon-kta-2023-10%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponCode LIKE '%fruitcoupon-kta-2023-10%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fc1de867-5a81-447a-97a8-4f301213434c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
52,1697757172967," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/557fc0b6-46eb-4d0c-a194-f4ef0fb1586d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
53,1698365294332," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8c58ca1a-8438-4e9c-aad4-db7042ab65d2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
54,1698642724918," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/546a130f-ef48-4795-b9e2-20090b084fac/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
55,1698651429485," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/81b4dc15-39c6-43c9-8584-1417bc4d4ee7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
56,1698809077556," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d54118f3-02aa-4640-883f-f2e183ffa2e9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
57,1698819921535," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c248b886-90a0-4177-94f8-f2076d12acf8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
58,1698910019706," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%壱番屋アンケートクーポン　100円券\\_1\\_2311%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%壱番屋アンケートクーポン　100円券\\_1\\_2311%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/86973fd7-0637-4b4e-958b-b11fdb454cb3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
59,1698910411771," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%壱番屋アンケートクーポン　50円券\\_2\\_2311%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%壱番屋アンケートクーポン　50円券\\_2\\_2311%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/353e1789-2daa-4ce6-8cb9-6aa77837b35c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
60,1698911532999," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b3763083-8eb2-443c-ab7b-78a66fff9f8e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
61,1698911775461," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/54bddb2d-0b61-421c-a408-c48468041f83/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
62,1699533301738," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7377481-2b85-4d59-a2d5-cbb016c13af7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
63,1699533420767," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/36f7c1a3-5fb1-4762-940e-752073ebf9b8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
64,1699576367467," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/20674157-9833-4119-9477-2314e519a587/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
65,1700197474380," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/661e0e6d-b8f9-4f44-be33-4b136c159fa5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
66,1700552647908," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/71a4fd80-711a-4df1-8887-a271dbdd2927/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
67,1700637311722," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7a8e0f10-8f12-4690-a3c7-537b0d90353a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
68,1700740894936," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2d337a53-f15d-4a6e-843c-e3e7fb01c82b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
69,1700780921703," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6727b31d-b258-4585-9594-efa2e948edc6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
70,1700784525895," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2710fb5e-b2de-4b03-96dc-38e6441a6cdc/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
71,1700920817490," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7bd02776-faad-412f-b897-4408ad8d2922/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
72,1701039900787," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cc741b7f-1d90-4e82-ab80-55a8b05d6005/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
73,1701046970653," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/dda87929-9091-475c-8e9c-e27ba399a7de/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
74,1701051400704," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a2e88e33-307a-4fed-9d62-b8882722e73e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
75,1701126379512," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/13765d59-64ed-4806-9dba-c855db8935c7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
76,1701154149402," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ed94cca0-fdc2-420c-a718-b0e1822b979f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
77,1701213504424," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8d00bd5b-04b2-4e31-91b8-76e8c3940eee/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
78,1701217533064," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' AND l.couponName LIKE '%京たんごフルーツキャンペーン%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/94ad0993-f499-4657-bfa5-fdeecf01592c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
79,1701219869885," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/76ab98d2-4f7a-4d69-b582-16e4feae5411/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
80,1701299218613," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7252c5b8-2e78-48ee-8652-cef8ad622aaf/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
81,1701386503049," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e2cd4713-7422-423d-a76d-e6629ca9db0b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
82,1701391911639," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fca5fb1e-a63e-449f-8a03-b978a76cb465/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
83,1701405860748," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f686b65a-cceb-4c5f-b05d-07e2d8e7bdbd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
84,1701415586660," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d98def0e-5a66-418c-9414-f452abb83bdf/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
85,1701474159308," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/17ff72d2-12fa-413e-a600-8caf95631252/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
86,1701558901787," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/92a4457f-de25-45c5-88cc-f720f432c142/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
87,1701559932282," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4d5e6ee8-a6de-4c92-a59d-990caac144a3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
88,1701560038422," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7554b17c-7910-45bb-83bf-b7fe3881839e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
89,1701560892954," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%東京1010%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%東京1010%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d87f3fd7-ecd0-4bd3-b619-41f7d2286814/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
90,1701588899397," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/88c7e07b-826c-4f18-8b92-851ba18b77a7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
91,1701645165978," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d9a5a04f-ed09-4525-962f-f2d9f4592114/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
92,1701732095220," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/de547c5f-700b-4378-aa6e-cc67b7e5bd45/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
93,1701817675169," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/01d0c2c2-4491-45ed-a237-a280b5cb178c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
94,1701903533907," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b3a47ffe-eff2-4834-9c21-a62b4b630fcc/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
95,1701990800760," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a007239-43fa-470f-8d1f-96dee1de446e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
96,1702010875327," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9f64a4b1-0b4d-43b9-a30b-f8ec4564c1e5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
97,1702021787345," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/331f6817-257c-4ecb-8a89-74f83fee5ec1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
98,1702069674660," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/41cda8b9-49e0-496d-857f-957e2f7c3204/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
99,1702154513510," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ed0b75d-5837-4fb5-a7fa-243de9659ada/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
100,1702219805172," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponName LIKE '%帰ってきた%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c33c98da-1afe-488f-bba9-812a8d5da75c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
101,1702249401807," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/08495cb0-eaed-4782-b7e2-c99d94353692/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
102,1702257126615," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ea0de1af-2394-46d0-b53d-1e3f4862aea5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
103,1702269457479," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%【本番\\_23010%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponName LIKE '%【本番\\_23010%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9926c7ec-833c-4c8a-9c2e-e33a608ed53c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
104,1702280797282," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c1b82baa-2170-4cca-b22c-68162305cac6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
105,1702335480473," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6c997fc1-be03-4d50-a9c4-e8b59bda7080/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
106,1702338687212," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4f25d925-b7d6-4f76-a7e2-8b823eebb7d2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
107,1702369335081," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3fec7427-a9b2-4e3e-9d7b-12516ccac8ed/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
108,1702369467963," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e4b034b1-956f-4996-919a-a2e8c0377a7b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
109,1702371186074," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c043ef8-e9bf-493c-abfd-384cb9c29d2b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
110,1702371422482," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/10551ee8-ad63-49ef-a34b-19efab4880a0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
111,1702371571675," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%ji%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%ji%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a4cba85f-0c41-48aa-a384-0ae1617d6d10/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
112,1702371688213," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichi%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7c0f1a7-3430-43ca-aa26-f75fa5bc4b3f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
113,1702375249758," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ff736176-63f6-4aa6-b6b0-7bed9809999b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
114,1702422731274," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4821c8f1-5bd6-4d54-be2e-84886ad7ef42/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
115,1702508869871," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e3874ed0-514e-466a-bfcf-307438af4511/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
116,1702594632987," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35153619-db43-44fe-a0d0-767c9d55fc00/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
117,1702594885945," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ca599a3-1c03-4b96-bddc-f6f102f89f35/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
118,1702600205735," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/29815bf5-c0aa-445e-b99d-c3d480cd555f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
119,1702679839087," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7df14682-e38b-4805-9eb3-8c2e696a7337/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
120,1702679921128," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f0162291-0869-41b7-b09f-56f905b5dcbe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
121,1702767196355," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f8434020-cbde-481b-9d56-343bead0976a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
122,1702854009748," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e7f00235-944c-4ad0-be12-cc2c1de5b911/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
123,1702940437604," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/49213d31-27a6-4039-a559-d4bf248eeb22/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
124,1703027323884," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5b5b379d-da45-4c71-9f18-a0d3081eb4ba/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
125,1703113324015," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a8e5f77a-2708-40f3-b6a4-9401d3e008ae/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
126,1703199911656," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7951d180-f9aa-4959-b073-3321cb6934c1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
127,1703205492178," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d03a2a3d-38cd-4670-b7bf-6389ed12750d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
128,1703236952541," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8c1e926d-7bcf-4a11-97a1-2014d3194a49/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
129,1703237440325," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/eae2b012-0667-455b-ab83-56f7f0476aa0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
130,1703284897832," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f6487737-34e1-45d8-9082-1c8a611138cd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
131,1703314526083," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/973221c9-253f-40aa-9d82-a90da71e94b5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
132,1703321520006," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/339cd040-2169-40e3-8eb2-7d76986798fd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
133,1703328762130," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2bc0cec7-51b2-4d16-8d68-c4b309b9f7b1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
134,1703335883323," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d120c278-2244-4511-b695-cb0d8b6f5cc7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
135,1703342970451," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ab0f0de8-671a-4927-b394-4161adb59171/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
136,1703347194215," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/aec91681-a2c2-4ef0-b318-d1e3b75139d6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
137,1703350905271," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2c4ec220-990b-4d8c-9c6c-93f11cc4c759/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
138,1703459158597," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3bd4f433-c4c6-49fd-89b2-4df3eb201550/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
139,1703565633450," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9a2b3fe4-9fee-4f29-b299-51427d4d0bf0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
140,1703735879474," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2312%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2312%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0e63c6a0-3969-415a-8dd0-3bfa63b199e4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
141,1703737403232," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35d70299-ceac-4402-ac51-02a660806391/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
142,1703737652688," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e6ce0476-f2a8-4872-9d01-42daa07493a5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
143,1704423426614," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9a8d9f49-963e-4147-8762-861421c032af/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
144,1704432606282," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c58bb15b-fa25-4506-80a0-ce9fef28d31c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
145,1704432868782," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2312%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2312%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/af197c6b-4c49-44ab-b293-c99bde0bbd3e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
146,1704433804458," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/762b0d70-659f-496b-8c24-c104b64201f5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
147,1704768430463," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/59933021-6001-4104-bd5f-cd080d2425f3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
148,1705032623437," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ba4ddebc-d3f0-4128-b762-4d0a952bd434/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
149,1705038775489," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b9360d97-f2eb-4ae6-b951-4ebcec8da360/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
150,1705464147049," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b04d27fb-2588-4a6b-86f7-dbc76744369d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
151,1705468098209," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1476ec3a-a91d-48a7-ab79-37c604418cc8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
152,1705639470552," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/574b3b1d-3372-4aba-9a73-f6e954929515/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
153,1706228129768," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2401%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/64b0aa3c-b04e-4fcd-a0e4-b3c92b64c01f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
154,1706228227427," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2402%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2402%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f36d730c-e4fb-4ea9-9695-7887d460f78a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
155,1706500577051," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4a879612-0975-4d7f-8280-ae20f424d504/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
156,1706500879912," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c213a257-2d76-45b1-b106-f9df8aeb87b7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
157,1706580920140," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' AND l.couponCode LIKE '%20230801-31-kaunseringu%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' AND l.couponCode LIKE '%20230801-31-kaunseringu%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/17b0eaa1-9726-4e47-8545-8dccc4fddd9a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
158,1706760209836," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40718bc8-3dca-4ceb-a250-b58acdd09e25/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
159,1706762725552," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4f6e5e5a-65c4-4b9d-913f-993b3d2839f5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
160,1706849329319," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c846a9ec-f8e6-4bf5-8fa4-c9ecb1c70a70/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
161,1706849442577," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2402%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%2402%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/bda1828e-30b3-4645-95af-8fc28851668a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
162,1707108295654," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponCode LIKE '%029308%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponCode LIKE '%029308%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/63747f6e-622f-40ee-b4d6-20cf7b3c0377/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
163,1707438360401," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fcf13836-b923-4bbf-a08e-3b3ad44a8cae/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
164,1707536985709," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1dde06fa-124c-4d48-8634-e05345cc7a3c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
165,1708057764672," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f1587821-76e1-4c39-a01c-9dc9b29611b0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
166,1708057846892," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d92e892d-ce1c-441e-baf4-bf4e7f69854d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
167,1708058000460," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0b606eb3-8966-4c16-8ba6-c93cfd95fbe7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
168,1708674703149," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c5ac151d-f0ca-428d-93a0-dba919145c60' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'c5ac151d-f0ca-428d-93a0-dba919145c60' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0feff883-6359-4805-b518-5efcb1eb1730/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
169,1709252576846," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8896f149-5133-4679-bc53-6fa74f19d355/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
170,1709270970294," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5f884861-7fc3-4eed-9c6f-d5c63e00b5fe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
171,1709272776553," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78585734-a878-4b6a-8043-9fdddd3b991a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
172,1709863866585," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5f4c937b-1fb0-489c-9da5-6d452317d388/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
173,1711353244314," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b8fa2dd5-d61d-499f-98a6-3bb18a56babb/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
174,1711498981623," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ac83c6d-7d1e-4f24-91b5-42ec7b004e23/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
175,1711935176345," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4eb6d4c9-26ee-42ce-bd60-e05164912713/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
176,1712190901842," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a1a97589-3554-49fc-8d4c-d2221f565b7e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
177,1712281831674," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/606bb10f-8e71-43e7-9a82-a99becd0a7ed/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
178,1712739647122," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4b3dc73f-5a9b-435e-a9b5-90f0391b2fc3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
179,1712816159823," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND l.couponCode LIKE '%aeonzannen%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5' AND l.couponCode LIKE '%aeonzannen%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf7bde01-ee88-4590-9c29-4d8d62291fd7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
180,1712883618839," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4bd61eb3-07c1-4489-904c-9f4e65180a15/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
181,1712886336064," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/72c723e3-7307-4a1c-8a05-34375ef79af1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
182,1712890586865," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d991a765-5d8e-4024-80da-badf0ea5e1af/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
183,1712895516395," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1db1a84a-c51f-4aa4-95a9-d98523748634/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
184,1714528427973," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c4da17f-731e-4d00-b1f9-0b22973dbcb1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
185,1714528684987," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/48f86122-3930-45e9-b26b-f268b555a862/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
186,1714529899692," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2f5c337b-0cb4-49af-b057-db6faab5f68e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
187,1714531872624," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40df404e-f214-43e9-883d-6320a38e8a60/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
188,1714532850765," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a1eb8ce3-ed76-48ac-9000-502d41733094/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
189,1714534342758," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8b399454-5caa-4064-86e9-b633816c9c5e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
190,1714542086676," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a3348357-d4c9-4eb8-8590-df387bc399a7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
191,1715057339218," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/65f8c38b-2fe4-4149-9fb3-050c0f040b41/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
192,1715304927358," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b5a84bf1-d378-41a6-897f-05858cbb6c9d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
193,1715926133052," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0b400d8b-5bce-4973-bc21-2ab1c0121060/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
194,1716511477248," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/96e57bee-8b64-4a23-b36d-8250d557edbe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
195,1716830439899," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/93b7117d-5ada-4fb7-b540-9b58087f122c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
196,1716921173648," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7953501d-3d98-4d2a-8b95-fcf98f257cc2/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
197,1717037496937," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya-100yen-2405%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9f16f727-243b-4568-aec4-f217fe44373b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
198,1719721786728," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%jichitai-sample%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9b767096-64dc-47e8-bcc0-c566e861464d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
199,1719800287524," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/25713b72-adf3-4ecd-abb7-b40ba3461511/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
200,1720514610750," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5479f7d1-8592-4f8f-9eeb-ebe8842c60b8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
201,1720676505814," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c440ac93-cc1a-400e-857c-afc70f61c267/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
202,1720766720034," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fc673a07-0768-4005-b7a0-e6ee7db6f700/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
203,1721958297368," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7db082dd-7046-4027-b5ec-3c6fb2b4c718/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
204,1721963279732," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5c5f1a02-bce0-4068-93c5-701f18c3145b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
205,1721963833226," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87' AND l.couponName LIKE '%KC1094%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9d95c4c4-bc77-4ddd-b650-a8c973cadd62/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
206,1722321556899," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%KC103%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%KC103%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/18797882-1e18-48f6-9d1a-f00fc9d62d84/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
207,1722321615360," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC103%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponName LIKE '%KC103%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9be41e1a-6097-490e-86a9-e394f1c5d58b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
208,1722324111911," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%030038007%' AND l.couponName LIKE '%KC1032%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78' AND l.couponCode LIKE '%030038007%' AND l.couponName LIKE '%KC1032%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/853b390e-fcb0-4255-b5dc-410d4e34cc61/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
209,1722579664084," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e7c9aca9-1c36-4197-81a6-a5362d00a508/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
210,1723710511492," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%art-ishigakijima-samplecoupon1%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a' AND l.couponCode LIKE '%art-ishigakijima-samplecoupon1%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/37a82985-1ccc-48b6-98ae-b9916f8375ed/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
211,1724723377095," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e448495-ee76-4156-b821-be379ed671a7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
212,1724723606839," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/21e1fc86-6d37-40d2-bc8b-dca157c3c3d4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
213,1724723914473," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c9ce5122-3f8a-4e12-96c1-eba3a3b943e6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
214,1724724158201," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5d27a658-fbd2-4e67-bcfd-c3f14dfc439c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
215,1724974599909," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/81c15330-82e2-4e0c-88b6-fff3ced580e9/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
216,1724974673686," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c06f8a8e-a5ce-4e3d-950f-287cf95f1e40/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
217,1725234059646," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/83605c7b-96fe-4f1f-bad8-91c8aae187df/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
218,1725847783191," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND l.couponCode LIKE '%121212%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' AND l.couponCode LIKE '%121212%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/42d84b15-d9eb-45a0-a5b1-dbbacf04f1ba/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
219,1727748145338," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a8750b6c-e125-4f08-bf17-4f2750db3bc3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
220,1727752248634," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7b11d791-6297-4a52-941f-cd7afebf1084/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
221,1727771165952," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/599a6189-f78e-472f-9803-8f2643893e74/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
222,1727776345115," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c76336e7-1d75-4c39-b8dc-e3918d855a93/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
223,1728293051314," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/39d377ca-207c-457b-951a-8e09e81adf62/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
224,1728293234993," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b21d523f-44f1-47f6-ae17-662e0a7a6a39/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
225,1728293368049," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cd12a569-0d68-42c1-b443-2ddeeb13eca4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
226,1728349796333," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf61201a-c2a2-4ac8-83df-9b019e931772/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
227,1728351296943," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a3607fec-8746-4e2f-bb81-b900fdd62f8c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
228,1728521513873," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/07dbda08-6125-4a43-bac7-2bf3f969af4c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
229,1728524212755," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/23583a16-0061-4f4d-ba3d-7f4948179344/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
230,1728524662837," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/da7586c0-5167-4ef9-88de-aadd1f8602b4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
231,1728527876695," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f027938d-331f-42a7-bd9b-de3afd5e9a55/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
232,1728540806427," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0e1783a7-fddd-4767-b2e0-d37930c421c8/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
233,1728606135911," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/19c33f25-f622-4c6f-81a0-58ca51b517ae/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
234,1728607095791," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a4fad33-acf5-47b7-a25f-95bed57c7c9d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
235,1728950730687," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/72ca19a6-d7a6-467b-b338-d4ff0d72072d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
236,1728982120142," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ca7693ac-84c5-4c5b-b340-a11c037860da/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
237,1728982252042," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14929483-f425-460c-83e5-e4f4e40e497a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
238,1729037816083," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e61abfe-8ee3-4bbf-8742-156e1149b40c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
239,1729123361202," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0d36aa4a-dace-4f50-946b-f2330e49aa89/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
240,1729214927037," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d7508fac-73e6-4257-9e39-2f3d3ac4647d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
241,1729226743871," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f662e1b6-b81e-4fda-a757-db726a8be2a5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
242,1729469457604," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c80c7e64-81d9-40da-b86d-5cc1f6afb218/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
243,1729555206688," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7fb34974-7159-419e-b49b-b2d96373f153/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
244,1729641390123," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/768c46cc-21b1-4aaa-a740-ff312927ab97/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
245,1729660791821," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ddae8e7d-8e1c-4f73-9933-42a218c0c8fe/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
246,1729676928754," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4c7e314e-57c0-47af-be0b-f8f6847e20bd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
247,1729728252671," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35b421ea-271e-48e7-b6de-23c13610d724/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
248,1729815079290," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/827d0494-9b75-4da4-9558-b2753112855a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
249,1729815486082," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c542576-4ffa-4187-a81a-b956d1c5a33b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
250,1729820977372," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%Ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%Ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/36fdd7fa-d36e-4fe3-9179-0e67f2f2c44d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
251,1729821028756," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2b5d5a2e-7767-4329-878d-1cf9ac6e0c6c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
252,1730073413492," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e5c3adfa-de26-4972-a853-4019e26c445b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
253,1730160150189," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/516762b6-8279-45ef-bb12-293ad2cdcbe6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
254,1730245917586," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/459e2201-b1f1-44fe-80dd-e2844e20c4b6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
255,1730420673308," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5a90d691-93b3-4dc0-8151-b6a72c345744/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
256,1730765649668," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/913cfb8c-b44e-4aa3-a5ee-4c3e2df3106d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
257,1730851255958," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7d063186-7bce-4c65-84a2-34c9a24af1e3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
258,1730851364380," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/693e5d05-c603-45bc-9db1-73c8234e7e99/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
259,1730878765960," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3ec0f997-806e-4bea-999c-2c499fe259c3/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
260,1730882649511," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE1105%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/755d868a-fb10-4154-86fa-b1a898c7c08d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
261,1730939702887," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/74488c83-a5f0-4ebb-b1b4-a5249d8d5cbd/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
262,1730944258261," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a84339f6-831f-4ca6-84b7-9b915badeb1c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
263,1731024740263," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/609de23a-13c4-41dc-8958-a34ee7ee3314/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
264,1731283339074," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/be1b42c9-a09f-4b40-86cf-b3cbd4946c55/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
265,1731370229541," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4b32f8c9-c7df-46ac-9f6e-39a50afc2f8e/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
266,1731370527793," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a5332727-eb12-4e3e-aa38-d329feadac9c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
267,1731457372583," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3a8515bf-ed7a-439a-add4-cdce2610117b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
268,1731534654612," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' AND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/30b4d570-1914-44ee-bf23-be63d2b5495c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
269,1731543440110," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/46a32076-93e6-44af-a821-6cc93eae56f4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
270,1731630195681," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a75f70a4-7a10-4055-b6a8-a24b2b2b01df/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
271,1731636430281," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b16de748-68fb-4dcd-8259-97168afbd764/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
272,1731975175565," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14da2371-bc9e-48f3-9239-62e003acf9ac/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
273,1731990005239," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/04ac3083-ffb6-4eae-9714-73fe6688d8ba/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
274,1732062506681," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/27aba9d6-3c32-4ff8-94dd-c15ded95933c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
275,1732072075089," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78a33221-4a41-4f01-85a5-6b12c66dfc53/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
276,1732149428066," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40a2e4e0-f014-4634-8a97-cd2662611033/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
277,1732234315362," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6cc0d22d-738f-423e-8708-f67f58acc3c0/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
278,1732250171482," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/262ce766-3b76-4e70-80a3-479751642bc6/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
279,1732493710493," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b26d7163-1dd2-49ac-b4c4-455d4d82a6e4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
280,1732526110314," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE2coupon%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0' AND l.couponCode LIKE '%ACLE2coupon%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1dc463a0-243e-44ec-ae0b-429f1db3f58f/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
281,1732579562416," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5488c41e-6c68-4c4d-a818-2f79030552be/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
282,1732666604311," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/558ac29e-852c-4aeb-aed2-bed9b92e33a4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
283,1732751014088," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5ac0cfa4-d74f-4321-9be4-c8ff49703d4a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
284,1732751890907," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7b99878d-31fe-456f-8e42-02407e59010d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
285,1732838522901," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/22906843-f1c0-4e9d-b5f9-7d75ab73ea27/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
286,1732852787761," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/903521c7-8244-4e89-9a4b-af7b1c8c2fe5/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
287,1733098268927," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3c440c0f-1531-423a-9867-6eda8ba9ece7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
288,1733184765807," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4bbaa9a6-e23c-4d18-8d45-a0c2274d28a1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
289,1733270165051," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f6233bfa-d4dc-40d0-b83a-0630e894d709/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
290,1733357654338," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9fdeb359-d2a0-4550-a42d-336ebf7aed3d/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
291,1733443355480," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/83b7605a-7993-48d2-b150-df65d765207b/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
292,1733702509158," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c8076ee5-035e-4f3b-9667-9578b91ec6e4/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
293,1733789004977," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/76f4e41b-7727-492e-a827-4cf88fa3d81c/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
294,1733789285571," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/849fb7d7-4cbf-4c01-bd89-b0c4c2169c33/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
295,1733797251660," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' AND l.couponName LIKE '%11%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985' AND l.couponCode LIKE '%ichibanya%' AND l.couponName LIKE '%11%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a620bee7-a9f2-4b46-9021-706c112d13c1/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
296,1733875463301," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/120549c1-145b-473b-ad2e-d1f46b0bc3b7/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
297,1733961531468," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ffa818fd-04cf-4cda-909d-67b287b21c1a/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
298,1734048554469," _SAME_ FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to '_S3_PATH_' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "," unload ($$ SELECT ROW_NUMBER() OVER(ORDER BY couponCode, couponName) AS ""No"", o.name AS ""組織名"", couponCode AS ""クーポンコード"", couponName AS ""クーポン名"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'issued' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type = 'issued' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""発行数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'used' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""使用済数"", ( SELECT COUNT(*) FROM coupon_logs l2 WHERE l2.type = 'canceled' AND l2.couponMasterId = l.couponMasterId AND NOT EXISTS( SELECT 1 FROM coupon_logs AS l3 WHERE l2.couponId = l3.couponId AND l3.type <> 'displayed' AND l2.createAtMillis < l3.createAtMillis ) ) AS ""キャンセル"" FROM coupon_logs l JOIN ( SELECT couponMasterId, MAX(createAtMillis) AS createAtMillis FROM coupon_logs GROUP BY couponMasterId ) latest ON l.couponMasterId = latest.couponMasterId AND l.createAtMillis = latest.createAtMillis JOIN organization_closure oc ON oc.childId = l.organizationId JOIN organization o ON o.resourceId = l.organizationId WHERE oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a' AND l.couponCode LIKE '%tokyo-sento%' ORDER BY couponCode, couponName $$) to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/68d07f61-695f-4fc7-9d50-9a79503f8a60/' iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role' DELIMITER ',' ADDQUOTES HEADER PARALLEL OFF "
