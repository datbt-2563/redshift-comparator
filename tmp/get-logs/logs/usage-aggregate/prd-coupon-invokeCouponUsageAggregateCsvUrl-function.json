[
  {
    "order": 0,
    "timestamp": 1672601651654,
    "message": "2023-01-01T19:34:11.654Z\t8060d70a-093e-49c1-8f23-7945554d4e2a\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 1,
    "timestamp": 1672701970238,
    "message": "2023-01-02T23:26:10.238Z\tf251dcce-7bde-4bfc-8b63-9798b3759ae5\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 2,
    "timestamp": 1672786046038,
    "message": "2023-01-03T22:47:26.037Z\t9d6c788c-4205-4aff-a2c3-9d415bbfb8d4\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 3,
    "timestamp": 1672842992485,
    "message": "2023-01-04T14:36:32.485Z\tdf9d74f3-874d-4f57-bc43-2e9539582cfc\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 4,
    "timestamp": 1672844710858,
    "message": "2023-01-04T15:05:10.858Z\t46cd6cc4-3bdf-4e1b-802e-fcf3d5d86e49\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 5,
    "timestamp": 1672845021981,
    "message": "2023-01-04T15:10:21.981Z\t9e6424bc-7112-4776-9e3c-6dc78264335a\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 6,
    "timestamp": 1672845247223,
    "message": "2023-01-04T15:14:07.223Z\t58906eb3-a06f-4103-94e0-c1e7ed21f51f\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 7,
    "timestamp": 1672873086165,
    "message": "2023-01-04T22:58:06.165Z\t1895dea7-bb10-46ae-9056-c8e72e1d9449\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 8,
    "timestamp": 1672886199950,
    "message": "2023-01-05T02:36:39.950Z\t18aa01f1-2f0b-4ec3-b1df-14d4d61a7a57\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 9,
    "timestamp": 1672929259699,
    "message": "2023-01-05T14:34:19.699Z\t882a7360-7f46-45f5-9ac1-82870371ae47\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 10,
    "timestamp": 1672959748655,
    "message": "2023-01-05T23:02:28.655Z\tdee56df9-cbc6-4125-9bbc-d738013748d7\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 11,
    "timestamp": 1673046043768,
    "message": "2023-01-06T23:00:43.756Z\t756f08cc-939c-4154-af32-5cb189055e82\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 12,
    "timestamp": 1673133119855,
    "message": "2023-01-07T23:11:59.855Z\t10f8fa2d-54f9-4ac1-b02c-61aeb620ba04\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 13,
    "timestamp": 1673219068883,
    "message": "2023-01-08T23:04:28.883Z\te92be74b-5fc9-4661-b2ab-78193861710e\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 14,
    "timestamp": 1673304897688,
    "message": "2023-01-09T22:54:57.688Z\tcdccf4bb-ed6a-441d-a118-8a30291d1256\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 15,
    "timestamp": 1673391793164,
    "message": "2023-01-10T23:03:13.158Z\t6f1ed0b7-0129-409c-9920-b2d89b97b89a\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 16,
    "timestamp": 1673449938307,
    "message": "2023-01-11T15:12:18.307Z\t91b948af-01b2-45cc-a892-d2593acd156f\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 17,
    "timestamp": 1673477909767,
    "message": "2023-01-11T22:58:29.766Z\t2508e2d7-3ed6-4ccf-943a-81681d8e0878\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 18,
    "timestamp": 1673536387126,
    "message": "2023-01-12T15:13:07.126Z\tae013483-0223-4097-a7b6-59548cdadf30\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 19,
    "timestamp": 1673564572291,
    "message": "2023-01-12T23:02:52.290Z\tc53cdb9d-9af7-42ab-811f-c299135ddd12\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 20,
    "timestamp": 1673564623546,
    "message": "2023-01-12T23:03:43.546Z\t9b4a46b4-8435-4c29-a6d8-df27a4755b15\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 21,
    "timestamp": 1673564687926,
    "message": "2023-01-12T23:04:47.926Z\tb4caf791-62d6-4089-a9fb-4ce949698227\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 22,
    "timestamp": 1673564715738,
    "message": "2023-01-12T23:05:15.735Z\t57e85390-5862-4365-bf8e-210d6d60b2c8\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 23,
    "timestamp": 1673650813921,
    "message": "2023-01-13T23:00:13.921Z\t71101cdb-1ca3-4a36-b842-84694f4bfdc4\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 24,
    "timestamp": 1673739091565,
    "message": "2023-01-14T23:31:31.565Z\tf1d6c989-3194-4911-a230-e052b48ac913\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 25,
    "timestamp": 1673756958945,
    "message": "2023-01-15T04:29:18.945Z\t497543d1-5289-4ce6-8c97-75a6e4b0fe05\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 26,
    "timestamp": 1673759343056,
    "message": "2023-01-15T05:09:03.056Z\t5abd4c69-1a9e-4276-a4ff-9f84b825b07d\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 27,
    "timestamp": 1673793615177,
    "message": "2023-01-15T14:40:15.166Z\tf019b5a0-ac3d-4428-aeca-2bb2ede61b6a\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 28,
    "timestamp": 1673797709996,
    "message": "2023-01-15T15:48:29.996Z\tecb7c266-b1d4-447c-8bd8-a6a07e429f60\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 29,
    "timestamp": 1673823403636,
    "message": "2023-01-15T22:56:43.636Z\ta4be12a9-0d90-4153-a20f-984d6a828c2b\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京１０１０%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 30,
    "timestamp": 1673823794207,
    "message": "2023-01-15T23:03:14.207Z\tb6142ca6-a9f2-4052-b9c2-f2164cd4aecf\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 31,
    "timestamp": 1673832985089,
    "message": "2023-01-16T01:36:25.075Z\tce2553c1-4b4e-41e4-a711-ee60eef36764\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 32,
    "timestamp": 1673909244058,
    "message": "2023-01-16T22:47:24.058Z\tbfb92a61-ae8e-4320-9ca8-9bbc794dc4ed\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 33,
    "timestamp": 1673910328175,
    "message": "2023-01-16T23:05:28.175Z\t95e75b72-7dda-4b0a-a61b-cae70203a1da\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%￦ﾝﾱ￤ﾺﾬ1010%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 34,
    "timestamp": 1673910351591,
    "message": "2023-01-16T23:05:51.590Z\taef2fffe-3c58-4965-9849-1cc25d2cab91\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 35,
    "timestamp": 1673910446972,
    "message": "2023-01-16T23:07:26.972Z\t6b6fe4e4-3c1d-4a98-a9d8-1cc452c54da0\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 36,
    "timestamp": 1673917244416,
    "message": "2023-01-17T01:00:44.403Z\t7ec717c1-257c-4641-9b6d-a4031b64c53e\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\nAND l.couponName LIKE '%KC1019%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 37,
    "timestamp": 1673946384016,
    "message": "2023-01-17T09:06:24.016Z\td46dcc9e-0ff0-4345-9858-806939e7d893\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 38,
    "timestamp": 1673995859153,
    "message": "2023-01-17T22:50:59.153Z\t0258d544-7461-4831-9d1b-2c2d70ecf505\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 39,
    "timestamp": 1674082697993,
    "message": "2023-01-18T22:58:17.993Z\t4776cf28-c3f5-4839-b9d6-d5f6ede157e4\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 40,
    "timestamp": 1674141630318,
    "message": "2023-01-19T15:20:30.318Z\tf03e3668-034d-4a1c-ae28-d0ab2941ea7c\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 41,
    "timestamp": 1674169566954,
    "message": "2023-01-19T23:06:06.954Z\t506e534f-6370-4f36-ae33-2c31d9a71f72\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 42,
    "timestamp": 1674228471531,
    "message": "2023-01-20T15:27:51.531Z\t769a827c-d1fa-4e24-a688-9d15ba972c06\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 43,
    "timestamp": 1674255082549,
    "message": "2023-01-20T22:51:22.549Z\t33a2ad4d-4310-4948-b645-6b406f8cefb5\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 44,
    "timestamp": 1674288705909,
    "message": "2023-01-21T08:11:45.909Z\t9d1b6dec-9df5-41d0-845f-deed5369d214\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 45,
    "timestamp": 1674291497376,
    "message": "2023-01-21T08:58:17.376Z\t8910e9c7-30f4-4653-9e7f-c7d387ae5b10\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 46,
    "timestamp": 1674293058434,
    "message": "2023-01-21T09:24:18.434Z\te57386e5-a2ad-40d2-857b-13a9d28c1f34\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 47,
    "timestamp": 1674294098766,
    "message": "2023-01-21T09:41:38.766Z\t5f11525d-0368-4eda-b123-99d04a331a1d\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 48,
    "timestamp": 1674294493589,
    "message": "2023-01-21T09:48:13.589Z\t9fe7b5e0-a8bf-4505-8a81-5b8671545b4a\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 49,
    "timestamp": 1674297358779,
    "message": "2023-01-21T10:35:58.778Z\tad7913d8-012c-44ae-95df-dac9f8d3f747\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 50,
    "timestamp": 1674298705879,
    "message": "2023-01-21T10:58:25.879Z\tbcfaf3be-b6ce-476d-92e8-0504c361b0e3\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 51,
    "timestamp": 1674302193447,
    "message": "2023-01-21T11:56:33.447Z\t2c6088f6-bed6-420a-8c10-17277f2f7998\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 52,
    "timestamp": 1674311176801,
    "message": "2023-01-21T14:26:16.801Z\td1c629f3-4685-4866-8848-44c96b86aa69\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 53,
    "timestamp": 1674312976592,
    "message": "2023-01-21T14:56:16.592Z\t4baf71fd-50b2-4b27-9e6d-f59dcad286ee\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 54,
    "timestamp": 1674313717611,
    "message": "2023-01-21T15:08:37.610Z\t93b05e8d-6640-480e-bc99-0e64e150cfbe\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 55,
    "timestamp": 1674342842143,
    "message": "2023-01-21T23:14:02.143Z\t238255e4-3132-47d1-8f4c-e04e961a2de1\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 56,
    "timestamp": 1674345840672,
    "message": "2023-01-22T00:04:00.672Z\t3aa7821e-272b-4609-9c57-9f578ced68f0\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 57,
    "timestamp": 1674354764903,
    "message": "2023-01-22T02:32:44.903Z\tac0fdea2-0929-4657-bc30-b6fd0bce5a3f\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 58,
    "timestamp": 1674356136791,
    "message": "2023-01-22T02:55:36.791Z\t83963625-a68d-4a7c-b450-01cdb9217368\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 59,
    "timestamp": 1674359678901,
    "message": "2023-01-22T03:54:38.901Z\t1077a73e-0059-45ef-9440-7daff4bd5619\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 60,
    "timestamp": 1674362821886,
    "message": "2023-01-22T04:47:01.886Z\t3537e6df-7ce1-4665-a66a-b1c258df116d\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 61,
    "timestamp": 1674363341464,
    "message": "2023-01-22T04:55:41.464Z\tfe31ee08-a819-4c59-b4b8-d3f14bf5a56f\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 62,
    "timestamp": 1674365270577,
    "message": "2023-01-22T05:27:50.573Z\t1162897d-6d5c-48b3-9a46-009128ff9cd4\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 63,
    "timestamp": 1674366972299,
    "message": "2023-01-22T05:56:12.299Z\te060597e-f24b-4939-9ee9-4f9d640e61c5\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 64,
    "timestamp": 1674370469770,
    "message": "2023-01-22T06:54:29.769Z\t84612154-5b6d-4f4a-a43d-411eb668e7ed\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 65,
    "timestamp": 1674371869812,
    "message": "2023-01-22T07:17:49.812Z\t32953d60-7469-4f57-847e-3b30c60b301d\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 66,
    "timestamp": 1674372404292,
    "message": "2023-01-22T07:26:44.292Z\t88dde62b-b1b1-48ef-b679-00bb4e440cdc\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 67,
    "timestamp": 1674372660113,
    "message": "2023-01-22T07:31:00.113Z\t520ff965-0e8a-4025-ae9e-55611be6f354\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 68,
    "timestamp": 1674373520533,
    "message": "2023-01-22T07:45:20.533Z\t884f1de0-8a28-43b6-9acc-7a12b1c5bd03\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 69,
    "timestamp": 1674374109981,
    "message": "2023-01-22T07:55:09.981Z\ta4492696-9bec-4194-baaf-f559c65844ea\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 70,
    "timestamp": 1674374789705,
    "message": "2023-01-22T08:06:29.705Z\t52c6c887-6c24-4f16-9e17-283c679e3646\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 71,
    "timestamp": 1674375052665,
    "message": "2023-01-22T08:10:52.665Z\tf26d9333-524c-4233-8897-6b5a05b9f37e\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 72,
    "timestamp": 1674375920072,
    "message": "2023-01-22T08:25:20.072Z\tc7e6b51d-6c1a-478d-8410-33f9efa6277d\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 73,
    "timestamp": 1674376753383,
    "message": "2023-01-22T08:39:13.383Z\t71101d0f-b9cc-4fd8-8c68-f6ae48d2b939\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 74,
    "timestamp": 1674377744649,
    "message": "2023-01-22T08:55:44.649Z\tddf5b786-85ee-4513-8292-2ae19c8b7b76\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 75,
    "timestamp": 1674378230576,
    "message": "2023-01-22T09:03:50.576Z\t2eeba87b-8a4f-49be-be49-eb7cdf1e8c1d\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 76,
    "timestamp": 1674378638632,
    "message": "2023-01-22T09:10:38.632Z\tfaf949d5-430f-4e81-93b1-f7775505094b\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 77,
    "timestamp": 1674378904921,
    "message": "2023-01-22T09:15:04.921Z\tc47fbf1c-1077-4001-b7e9-3a056d793004\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 78,
    "timestamp": 1674379105677,
    "message": "2023-01-22T09:18:25.677Z\t998c9236-aa43-4e8c-9888-90f35b0ba72f\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 79,
    "timestamp": 1674379539593,
    "message": "2023-01-22T09:25:39.593Z\tc6009563-e909-4bf3-b4a2-76433c42ae34\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 80,
    "timestamp": 1674380783629,
    "message": "2023-01-22T09:46:23.629Z\t588acb25-8ac6-44bc-b1f0-fcaa1ae9e3e9\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 81,
    "timestamp": 1674381352142,
    "message": "2023-01-22T09:55:52.141Z\t9af62ad9-c6ea-483f-abae-05f60d7e262d\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 82,
    "timestamp": 1674382470654,
    "message": "2023-01-22T10:14:30.654Z\tcf4bf83b-a87c-4dd7-ba24-16c7cea85a37\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 83,
    "timestamp": 1674383123864,
    "message": "2023-01-22T10:25:23.864Z\tc8391e27-484d-4424-86c5-49c5667ff0be\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 84,
    "timestamp": 1674384223887,
    "message": "2023-01-22T10:43:43.887Z\t53e4fa42-3f92-4da6-a47e-99a824c15b01\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 85,
    "timestamp": 1674384943429,
    "message": "2023-01-22T10:55:43.429Z\tc180c177-5908-4652-86ca-19308a2c9f14\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 86,
    "timestamp": 1674386016707,
    "message": "2023-01-22T11:13:36.707Z\t8d5c19e8-b2d8-4fb4-8565-7ae1bb498732\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 87,
    "timestamp": 1674386719578,
    "message": "2023-01-22T11:25:19.578Z\tf57bb7f9-4062-4adc-bd9c-9fe1ceb1e1d7\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 88,
    "timestamp": 1674387944757,
    "message": "2023-01-22T11:45:44.746Z\t391e83f1-68f2-466f-894c-3470162ce646\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 89,
    "timestamp": 1674388527349,
    "message": "2023-01-22T11:55:27.349Z\taff4dfdb-ac1d-402e-b80e-ceea003d49a3\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 90,
    "timestamp": 1674389709331,
    "message": "2023-01-22T12:15:09.331Z\t3c3e0da1-e8cb-41ef-bc3a-7904f230e72a\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 91,
    "timestamp": 1674390396237,
    "message": "2023-01-22T12:26:36.237Z\t4f354560-5561-4318-b3db-032dc048f998\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 92,
    "timestamp": 1674392109951,
    "message": "2023-01-22T12:55:09.951Z\tc2590574-f7d7-47fd-8fb5-dbc0df767357\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 93,
    "timestamp": 1674393215156,
    "message": "2023-01-22T13:13:35.156Z\ta0cf0cb7-db90-4c26-a46c-969f817bba7a\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 94,
    "timestamp": 1674393904222,
    "message": "2023-01-22T13:25:04.222Z\teca2f5e0-6894-4a45-aeb9-a1f41f7e841e\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 95,
    "timestamp": 1674395021069,
    "message": "2023-01-22T13:43:41.069Z\t146b2d65-5905-4297-b803-41694d39c4ed\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 96,
    "timestamp": 1674395771980,
    "message": "2023-01-22T13:56:11.980Z\tc6e390e8-ed11-441c-8b50-8fbcccd15218\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 97,
    "timestamp": 1674397938547,
    "message": "2023-01-22T14:32:18.547Z\td515b026-0424-4952-ad76-fd0cb4f29f5e\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 98,
    "timestamp": 1674399354278,
    "message": "2023-01-22T14:55:54.278Z\t2a99e2d8-3213-4314-a9a2-81983993050b\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 99,
    "timestamp": 1674448322117,
    "message": "2023-01-23T04:32:02.116Z\t77935dfd-5140-4c08-a1b0-836fa9674a41\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 100,
    "timestamp": 1674514966603,
    "message": "2023-01-23T23:02:46.602Z\tacbf7767-59ed-42bd-9e47-e80cb3f8a453\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 101,
    "timestamp": 1674516888814,
    "message": "2023-01-23T23:34:48.813Z\t33790263-960f-4491-8b02-74b5511c6528\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 102,
    "timestamp": 1674536757910,
    "message": "2023-01-24T05:05:57.910Z\t669da224-1e87-4ec1-8d0b-d4ecbcbf68ce\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 103,
    "timestamp": 1674541346392,
    "message": "2023-01-24T06:22:26.381Z\t6c880b00-23d5-41b1-9c61-ea7e05c3392f\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb'\n\n\n\nAND l.couponCode LIKE '%20221001-31-kaunseringu%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 104,
    "timestamp": 1674541505714,
    "message": "2023-01-24T06:25:05.714Z\t98c507ab-09c9-49ac-8209-e7e7071b70f4\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb'\n\n\n\n\nAND l.couponName LIKE '%20221001-31-kaunseringu%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 105,
    "timestamp": 1674541927945,
    "message": "2023-01-24T06:32:07.945Z\t491ac7f7-84c1-4da6-824f-cd7c80fd343f\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb'\n\n\n\nAND l.couponCode LIKE '%20221201-31-kaunseringu%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 106,
    "timestamp": 1675223470785,
    "message": "2023-02-01T03:51:10.785Z\t9888041c-91a2-42e9-9843-d81a454ad304\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 107,
    "timestamp": 1675224249634,
    "message": "2023-02-01T04:04:09.634Z\td26bd2e9-7174-49fb-8787-a08f6ad0c0de\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 108,
    "timestamp": 1675224810323,
    "message": "2023-02-01T04:13:30.323Z\t463b85f9-ffe9-44c1-9959-3d0db3879972\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 109,
    "timestamp": 1675308411068,
    "message": "2023-02-02T03:26:51.068Z\t9df6d046-e6dc-4912-b56b-3f1bc7e44d11\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 110,
    "timestamp": 1675388673971,
    "message": "2023-02-03T01:44:33.971Z\t4eb873b0-a0a1-49b7-82ec-2f410f07cedf\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%yomiren20230203%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 111,
    "timestamp": 1675671956097,
    "message": "2023-02-06T08:25:56.097Z\ta1033d8a-c79e-4fcf-8194-9dc21f73520d\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 112,
    "timestamp": 1675672133657,
    "message": "2023-02-06T08:28:53.657Z\td1064cd9-d751-40f6-9451-1d8327e31057\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 113,
    "timestamp": 1675846881322,
    "message": "2023-02-08T09:01:21.318Z\tecd48cfe-815e-4447-a992-aa6022fc8be3\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\nAND l.couponName LIKE '%KC1072%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 114,
    "timestamp": 1675849906579,
    "message": "2023-02-08T09:51:46.579Z\t6adecf70-0ff8-4df1-a7a4-d6310ba6e6c0\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\nAND l.couponName LIKE '%KC1072%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 115,
    "timestamp": 1676366698828,
    "message": "2023-02-14T09:24:58.828Z\t2e6bc475-604c-4045-951c-7cffeb911925\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'ef2733f4-0ad5-4fcd-aaf8-e48dbc3ed56c'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 116,
    "timestamp": 1676366740927,
    "message": "2023-02-14T09:25:40.927Z\t6c3170b5-5277-4d7a-b184-d0d788afd5de\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 117,
    "timestamp": 1676366949387,
    "message": "2023-02-14T09:29:09.368Z\t7547518a-d260-4907-8b22-5f9814898cd7\tINFO\tsql \n        SELECT ROW_NUMBER() OVER(ORDER BY o.item.name.S) AS \"No\", o.item.name.S AS \"組織名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId, organizationId\n                            FROM coupon_logs l\n                            WHERE o.item.resourceId.S = l.organizationId\n                              AND type = 'issued'\n                        )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.item.resourceId.S\n        WHERE o.item.type.S = 'SMALL_SHOP_GROUP'\n          AND oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n            \n        ORDER BY\n            o.item.name.S\n    \n"
  },
  {
    "order": 118,
    "timestamp": 1676367079622,
    "message": "2023-02-14T09:31:19.619Z\t516c634c-f153-4066-8331-5eaecdc469a3\tINFO\tsql \n        SELECT ROW_NUMBER() OVER(ORDER BY o.item.name.S) AS \"No\", o.item.name.S AS \"組織名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId, organizationId\n                            FROM coupon_logs l\n                            WHERE o.item.resourceId.S = l.organizationId\n                              AND type = 'issued'\n                        )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.item.resourceId.S\n        WHERE o.item.type.S = 'BIG_SHOP_GROUP'\n          AND oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n            \n        ORDER BY\n            o.item.name.S\n    \n"
  },
  {
    "order": 119,
    "timestamp": 1676367256873,
    "message": "2023-02-14T09:34:16.873Z\te9323aef-1da3-4f4d-bada-53e132d70a05\tINFO\tsql \n        SELECT ROW_NUMBER() OVER(ORDER BY o.item.name.S) AS \"No\", o.item.name.S AS \"組織名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId, organizationId\n                            FROM coupon_logs l\n                            WHERE o.item.resourceId.S = l.organizationId\n                              AND type = 'issued'\n                        )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.item.resourceId.S\n        WHERE o.item.type.S = 'SHOP'\n          AND oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n            \n        ORDER BY\n            o.item.name.S\n    \n"
  },
  {
    "order": 120,
    "timestamp": 1676367351079,
    "message": "2023-02-14T09:35:51.079Z\t1a6f4212-f0c6-473b-80cf-8fdb0ba8f844\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'ef2733f4-0ad5-4fcd-aaf8-e48dbc3ed56c'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 121,
    "timestamp": 1676530709031,
    "message": "2023-02-16T06:58:29.031Z\t81c5b842-26eb-4824-9089-fa2d4d585820\tINFO\tsql \n        SELECT ROW_NUMBER() OVER(ORDER BY o.item.name.S) AS \"No\", o.item.name.S AS \"組織名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId, organizationId\n                            FROM coupon_logs l\n                            WHERE o.item.resourceId.S = l.organizationId\n                              AND type = 'issued'\n                        )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.item.resourceId.S\n        WHERE o.item.type.S = 'SHOP'\n          AND oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n            AND o.item.name.S LIKE '%リーガロイヤルホテル（大阪）%'\n        ORDER BY\n            o.item.name.S\n    \n"
  },
  {
    "order": 122,
    "timestamp": 1676531451511,
    "message": "2023-02-16T07:10:51.500Z\t7a69b876-582b-4e70-85cc-f195b1dcd864\tINFO\tsql \n        SELECT ROW_NUMBER() OVER(ORDER BY o.item.name.S) AS \"No\", o.item.name.S AS \"組織名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId, organizationId\n                            FROM coupon_logs l\n                            WHERE o.item.resourceId.S = l.organizationId\n                              AND type = 'issued'\n                        )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.item.resourceId.S\n        WHERE o.item.type.S = 'SHOP'\n          AND oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n            AND o.item.name.S LIKE '%リーガロイヤルホテル（大阪）%'\n        ORDER BY\n            o.item.name.S\n    \n"
  },
  {
    "order": 123,
    "timestamp": 1676603134010,
    "message": "2023-02-17T03:05:34.008Z\t0c1550de-47d0-4fe5-8322-b9929f25abf4\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 124,
    "timestamp": 1676943589518,
    "message": "2023-02-21T01:39:49.518Z\te6a44922-91a6-41b9-874c-cf4a5a8e0281\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 125,
    "timestamp": 1676950128851,
    "message": "2023-02-21T03:28:48.851Z\t263e4faf-7b38-4955-aaac-8db7495608d8\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 126,
    "timestamp": 1677673540493,
    "message": "2023-03-01T12:25:40.493Z\t96935f91-cd5c-4769-b58f-be5cb59eb895\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 127,
    "timestamp": 1677806600331,
    "message": "2023-03-03T01:23:20.330Z\ta2cb4f12-16ca-4952-ba7f-d9faef7cd852\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 128,
    "timestamp": 1677832817725,
    "message": "2023-03-03T08:40:17.725Z\tcf50ebbd-fe17-4983-94f9-9a728b5a7847\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 129,
    "timestamp": 1678075790952,
    "message": "2023-03-06T04:09:50.951Z\tea932271-1b9b-4b1a-97ce-5cec20e97ba4\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 130,
    "timestamp": 1680491949321,
    "message": "2023-04-03T03:19:09.321Z\t94f899b5-be49-4bdf-becf-4b28665a5ced\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 131,
    "timestamp": 1681894338550,
    "message": "2023-04-19T08:52:18.550Z\t2ae812d9-1a98-4f36-a612-4933ac52b606\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb'\n\n\n\nAND l.couponCode LIKE '%20230201-28-kaunseringu%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 132,
    "timestamp": 1682924832494,
    "message": "2023-05-01T07:07:12.494Z\t16af4c9d-6d0b-4eff-9822-44be140477eb\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 133,
    "timestamp": 1684121315459,
    "message": "2023-05-15T03:28:35.459Z\t5b4446d8-0fbb-4da8-929d-2e7534fd2dad\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 134,
    "timestamp": 1684889055298,
    "message": "2023-05-24T00:44:15.298Z\t28e50ad6-47da-4384-be42-ae18ba188baf\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 135,
    "timestamp": 1685436986971,
    "message": "2023-05-30T08:56:26.971Z\td3dd286a-3daa-4348-b794-82bd7149943c\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 136,
    "timestamp": 1685437009501,
    "message": "2023-05-30T08:56:49.501Z\t1e1cfe64-8d04-486f-b5b8-b119620b8618\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 137,
    "timestamp": 1685438097165,
    "message": "2023-05-30T09:14:57.165Z\tb31f996b-15e6-4b55-8a8f-fa3091e9058b\tINFO\tsql \n        SELECT ROW_NUMBER() OVER(ORDER BY o.item.name.S) AS \"No\", o.item.name.S AS \"組織名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId, organizationId\n                            FROM coupon_logs l\n                            WHERE o.item.resourceId.S = l.organizationId\n                              AND type = 'issued'\n                        )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.item.resourceId.S\n        WHERE o.item.type.S = 'SHOP'\n          AND oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n            \n        ORDER BY\n            o.item.name.S\n    \n"
  },
  {
    "order": 138,
    "timestamp": 1685590257119,
    "message": "2023-06-01T03:30:57.119Z\t46e39318-e972-4f81-85e7-9c3911afa0c5\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 139,
    "timestamp": 1687138323406,
    "message": "2023-06-19T01:32:03.406Z\t6dc46d1d-cf6f-4fbd-b5ae-508d529cbc37\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '77d5a94c-249e-4a2e-b7eb-b13bb418733b'\n\n\n\nAND l.couponCode LIKE '%111111111111111%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 140,
    "timestamp": 1687342450680,
    "message": "2023-06-21T10:14:10.680Z\tb1a6bd9b-c943-49d4-b4fe-d3d36632a617\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 141,
    "timestamp": 1687343238884,
    "message": "2023-06-21T10:27:18.884Z\t53366e97-1b33-4a51-9c73-93670201d9a0\tINFO\tsql \n        SELECT ROW_NUMBER() OVER(ORDER BY o.item.name.S) AS \"No\", o.item.name.S AS \"組織名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId, organizationId\n                            FROM coupon_logs l\n                            WHERE o.item.resourceId.S = l.organizationId\n                              AND type = 'issued'\n                        )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.item.resourceId.S\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.item.resourceId.S\n        WHERE o.item.type.S = 'SHOP'\n          AND oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n            \n        ORDER BY\n            o.item.name.S\n    \n"
  },
  {
    "order": 142,
    "timestamp": 1687399617946,
    "message": "2023-06-22T02:06:57.946Z\t91a06127-49ee-485a-9463-686e384d1441\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\nAND l.couponCode LIKE '%022956007%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 143,
    "timestamp": 1687400186045,
    "message": "2023-06-22T02:16:26.045Z\t0f115187-8938-4f71-9370-9ee0312e3767\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\nAND l.couponCode LIKE '%022956007%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 144,
    "timestamp": 1687498677951,
    "message": "2023-06-23T05:37:57.951Z\te23de756-4c23-4288-846e-a8d5fefeaa38\tINFO\tsql \n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 145,
    "timestamp": 1687762072533,
    "message": "2023-06-26T06:47:52.533Z\t0e797339-30ce-4f47-8d1b-61f159a9c30f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4da9b6c6-0239-4900-a4c1-a9031adda551/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 146,
    "timestamp": 1687764181054,
    "message": "2023-06-26T07:23:01.054Z\t87b58fa2-147d-46d9-b200-634f99716a8e\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\nAND l.couponCode LIKE '%022956007%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/09abebbd-c921-4dec-8639-07ecee82f78a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 147,
    "timestamp": 1687764618975,
    "message": "2023-06-26T07:30:18.975Z\t70c183e5-ef09-4d66-8f92-39f362c5f28c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0d0a3e7b-4764-439c-82d4-1789e8c307fc/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 148,
    "timestamp": 1687768717589,
    "message": "2023-06-26T08:38:37.589Z\tf967d27e-a820-49b2-9ad8-62a786a9ef81\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '77d5a94c-249e-4a2e-b7eb-b13bb418733b'\n\n\n\n\nAND l.couponName LIKE '%商品A　コード入力%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/426d2fc6-26c1-4196-9ab0-48f56af7ca11/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 149,
    "timestamp": 1688349965362,
    "message": "2023-07-03T02:06:05.362Z\ta84a3941-4c96-416e-9a0d-db4b904ac5c3\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e7a9534-a97a-41aa-a12b-1d2e8593112c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 150,
    "timestamp": 1688721772843,
    "message": "2023-07-07T09:22:52.843Z\t3397f855-a399-4528-8c0a-c87695d3cfea\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7a5aab76-3331-44c1-806a-ce544da6875d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 151,
    "timestamp": 1689755249204,
    "message": "2023-07-19T08:27:29.204Z\t80e2ea1d-710a-4335-a98c-d1f0827faf1b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/06dc1ad3-a8b2-401d-90b1-9a6845b56379/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 152,
    "timestamp": 1689759252055,
    "message": "2023-07-19T09:34:12.055Z\t6ba6ca25-b8e0-4007-80d0-14134f9aeefb\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/626d4f4a-9c6e-4a5e-9ecc-af548ec2b6c3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 153,
    "timestamp": 1689759467135,
    "message": "2023-07-19T09:37:47.135Z\taf9d49e9-8b0d-426e-a229-b567c1fcbb36\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b74e4a50-6590-4ee9-820c-2c6a647f15ec/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 154,
    "timestamp": 1689923894385,
    "message": "2023-07-21T07:18:14.385Z\t7a277084-9ff4-45f1-b4b3-a7f137440f37\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6acf6dc1-500c-4ecf-8f84-57b517c5fa22/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 155,
    "timestamp": 1690172090304,
    "message": "2023-07-24T04:14:50.304Z\t8286640b-5c5c-418a-9c5e-fb9cb4037ac2\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4daa5fae-e23e-4a2e-ac2f-67e04b1948ba/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 156,
    "timestamp": 1690172235204,
    "message": "2023-07-24T04:17:15.204Z\te40fda62-e3aa-46ee-9738-428ac163a0e0\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoSINGLE5%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5b425ef0-9af2-4969-a5fe-30da23a25583/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 157,
    "timestamp": 1690172351565,
    "message": "2023-07-24T04:19:11.565Z\t07cc8c88-289d-463b-a6f6-f65563290f6c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoSINGLE4%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9dc74cde-8e86-4445-a848-c6776bbecf09/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 158,
    "timestamp": 1690172711975,
    "message": "2023-07-24T04:25:11.975Z\t4244d9ed-67aa-4d00-8ed2-2be5ec8b594b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoSINGLE3%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6b458106-57ab-412f-ac0f-cc1317062ebc/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 159,
    "timestamp": 1690334570348,
    "message": "2023-07-26T01:22:50.348Z\t4652c72f-5692-4894-82eb-7855f942a615\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\n\nAND l.couponName LIKE '%ゴーゴーカレー%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a2563e1f-4e33-4689-b08a-635c08ed09ed/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 160,
    "timestamp": 1690334608807,
    "message": "2023-07-26T01:23:28.807Z\tfd818900-75b2-467a-961a-08d87e3e840a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e28a7cb9-bbae-4e3b-927e-78a58dc30d80/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 161,
    "timestamp": 1690334623227,
    "message": "2023-07-26T01:23:43.227Z\tc72275cb-ce31-4c55-9fbc-e33e73d0d4d9\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\n\nAND l.couponName LIKE '%ゴーゴーカレー%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/16a536a3-0f08-43f8-b04f-22a7f85de023/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 162,
    "timestamp": 1690859585984,
    "message": "2023-08-01T03:13:05.984Z\t93ddba1f-322e-4fa0-b3bf-2d66e410d307\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2a185665-d95e-411a-9338-e1ae6eff22a6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 163,
    "timestamp": 1690864309982,
    "message": "2023-08-01T04:31:49.982Z\t64803982-1684-450a-a978-02b403af89b6\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3ff9cc08-d182-40c7-a1cd-08f764d1eab6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 164,
    "timestamp": 1690876228847,
    "message": "2023-08-01T07:50:28.847Z\t8b7ac6f8-8072-497b-ab4f-1ddf3db5ca1e\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1aafa6f4-75b4-4d99-8e0d-0e9b5a42be1b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 165,
    "timestamp": 1690876369996,
    "message": "2023-08-01T07:52:49.996Z\t1e2a3a42-cd66-48bd-ae2a-1920e492c3bd\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n\n\n\nAND l.couponCode LIKE '%0001%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7a8210d3-250b-4464-b75c-aa9368f000df/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 166,
    "timestamp": 1690876540795,
    "message": "2023-08-01T07:55:40.795Z\td634a273-8c42-4dbb-89c0-d427e494ab67\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n\n\n\nAND l.couponCode LIKE '%0001%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0f46afff-1e9e-45d1-864b-746efc6563b8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 167,
    "timestamp": 1690937108419,
    "message": "2023-08-02T00:45:08.419Z\t73a03035-6fbf-4b51-a52b-d0735aedc273\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n\n\n\nAND l.couponCode LIKE '%0001%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f5508989-11b6-4f5b-afb2-aaf70dad82b6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 168,
    "timestamp": 1690958347439,
    "message": "2023-08-02T06:39:07.439Z\tbdbfb0f7-f1c7-4867-8f01-d98b06b11469\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14967b59-0df9-45d8-b8ff-2a0ba73c8f60/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 169,
    "timestamp": 1691041910827,
    "message": "2023-08-03T05:51:50.827Z\tae176444-6684-493e-a31c-af4b48739492\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b6420a68-c580-408e-a083-0db389e642c0/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 170,
    "timestamp": 1691110341863,
    "message": "2023-08-04T00:52:21.863Z\t9f13261e-9b6a-48ca-a31b-dab0c34d37a2\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a77ca1d5-3a86-4c88-a219-93c1f29fdc9b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 171,
    "timestamp": 1691476533305,
    "message": "2023-08-08T06:35:33.305Z\t9aed7745-f6a8-4950-8de4-621cafbb6fbb\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\nAND l.couponName LIKE '%KC1012%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0615177b-d18b-4181-a194-86139f996d94/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 172,
    "timestamp": 1691478359000,
    "message": "2023-08-08T07:05:59.000Z\t1f10f07e-f726-4554-9f13-b16daed21a72\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\nAND l.couponName LIKE '%KC1012%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ff5d04f-323d-460f-af81-59e62fc7a16e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 173,
    "timestamp": 1693533081832,
    "message": "2023-09-01T01:51:21.832Z\t582a628e-fe08-4b33-a9ed-2640243b7029\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/20e0ac00-4ea5-48fd-a892-6cfbc52b1200/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 174,
    "timestamp": 1693537486392,
    "message": "2023-09-01T03:04:46.392Z\ta0986198-f2aa-4c70-8ea5-d8400ee4b2bb\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0de71884-8c2e-4665-806c-5da47c789880/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 175,
    "timestamp": 1694396807205,
    "message": "2023-09-11T01:46:47.205Z\t16b79777-ddea-4a32-884c-4c75c959af02\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoSINGLE5%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/92e162b1-287d-487e-8d5a-7dec71196cdd/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 176,
    "timestamp": 1694396938988,
    "message": "2023-09-11T01:48:58.988Z\t21b6fb82-ade2-4e48-b0e8-9d3efd8baa0b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoSINGLE4%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8e0b847d-8742-4604-9d4e-fc3ad8a5dad2/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 177,
    "timestamp": 1694397038828,
    "message": "2023-09-11T01:50:38.828Z\t9708ca71-d48a-45de-aa88-350f39caada8\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoSINGLE3%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9d8f45a5-55e9-4884-9ee6-f8d2fddc404d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 178,
    "timestamp": 1694397213205,
    "message": "2023-09-11T01:53:33.205Z\t99736ddc-5e67-41ed-a1bb-1efec53088cf\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoaiseki180%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e399eb33-7107-4597-bf12-c9e97adb3cb1/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 179,
    "timestamp": 1694397333579,
    "message": "2023-09-11T01:55:33.579Z\tb2bbafd9-9a8b-4e06-bb95-fffec7d5f007\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoaiseki120\t%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/be46ce0a-06a0-4b97-8853-b3eb2fb98b59/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 180,
    "timestamp": 1694397448322,
    "message": "2023-09-11T01:57:28.322Z\tbffb7c13-8a3b-486f-9c92-129f59c2b5a0\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'f0e001ee-52da-42fa-8929-8227d3947a74'\n\n\n\nAND l.couponCode LIKE '%gogoaiseki120\t%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ddac33e8-654a-4c3e-8f67-f622fccf7975/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 181,
    "timestamp": 1695605869795,
    "message": "2023-09-25T01:37:49.795Z\t7a4fec49-a198-4c90-bc5c-2f4a247cd287\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9'\n\n\n\n\nAND l.couponName LIKE '%200%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/87a53d28-5d15-4249-a10a-c8d94677140f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 182,
    "timestamp": 1695772723966,
    "message": "2023-09-26T23:58:43.966Z\t335e58c7-f420-4bf2-9ac7-bf68816e5578\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9'\n\n\n\n\nAND l.couponName LIKE '%200%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4be71ca7-9c43-48d9-b9f2-358658c7cd06/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 183,
    "timestamp": 1695790977037,
    "message": "2023-09-27T05:02:57.037Z\t159c4d1a-5dd1-4dc1-aaf8-48790fdedbef\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9'\n\n\n\n\nAND l.couponName LIKE '%200%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7f68bf7-a121-439e-9d95-45d574bd5d1b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 184,
    "timestamp": 1696221097222,
    "message": "2023-10-02T04:31:37.222Z\t409adfcf-ceff-49f8-b678-c1fa7848e942\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e39a51fc-ddb1-440a-ad53-a5663789788f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 185,
    "timestamp": 1696379814277,
    "message": "2023-10-04T00:36:54.277Z\tb6756ef4-d16f-495a-ac80-817e71f1b0f5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/881fe144-dae4-445f-899a-ee8d3bc98b42/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 186,
    "timestamp": 1696459336760,
    "message": "2023-10-04T22:42:16.760Z\t987208e7-27bd-4c95-b757-405424059625\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\n\nAND l.couponName LIKE '%【本番\\\\_2309】%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f9c193c1-bc5f-4ce0-9507-0cca7b6a89c4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 187,
    "timestamp": 1696465346686,
    "message": "2023-10-05T00:22:26.686Z\t926cb865-b5f6-4aee-8ebd-a15c05b10bf1\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/dbb72a67-6928-4ee0-8d5a-72c6ac5be775/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 188,
    "timestamp": 1696571972689,
    "message": "2023-10-06T05:59:32.689Z\te0342870-d8a2-4691-a41d-52562cdaa14c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a377f14-7797-4592-94ef-d6fc8a71dcca/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 189,
    "timestamp": 1696572450268,
    "message": "2023-10-06T06:07:30.268Z\t60f04ded-4af0-4f7f-9645-c172b1b2856c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/80eacd65-41b5-4bf5-bec4-be6da94a5ca7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 190,
    "timestamp": 1696646732977,
    "message": "2023-10-07T02:45:32.977Z\t2a53adb0-f0b6-4a9d-a0e4-81ff9de86acd\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9'\n\n\n\n\nAND l.couponName LIKE '%200%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/275c38bf-38f1-4ba7-8fe8-372d32b0bd79/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 191,
    "timestamp": 1696808058883,
    "message": "2023-10-08T23:34:18.883Z\t0ba94b76-ac20-4d91-81f8-d99b7ab34b64\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9'\n\n\n\n\nAND l.couponName LIKE '%200%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ab664e80-e9ed-4766-ac5e-560a6b6316e9/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 192,
    "timestamp": 1696992904982,
    "message": "2023-10-11T02:55:04.982Z\t07ceb722-0af8-4e99-b6b5-09264c078d2e\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/71e8b2d2-dbe7-44fb-822d-e0e43f524068/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 193,
    "timestamp": 1696993065283,
    "message": "2023-10-11T02:57:45.283Z\tedb212e6-6f7a-4b5f-af9e-1211552dde35\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b1ae8b91-de00-4bb1-9fbd-136517153e9f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 194,
    "timestamp": 1697008681193,
    "message": "2023-10-11T07:18:01.193Z\t83a89a9a-b744-484d-84e5-b3ed670ca952\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5'\n\n\nAND o.name LIKE '%kobeseikyo%'\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/adc532d3-040d-46be-a501-fbba951e70a3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 195,
    "timestamp": 1697152194355,
    "message": "2023-10-12T23:09:54.355Z\te459f851-06e9-4388-8fc1-755b11e89abe\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78483a4b-f4b6-4f60-bc4f-e8c86af69a62/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 196,
    "timestamp": 1697159568398,
    "message": "2023-10-13T01:12:48.398Z\t287d87f0-cf34-401d-a890-946825a420e2\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9'\n\n\n\n\nAND l.couponName LIKE '%200%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1718eae0-73c7-411b-be86-192eaec4f543/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 197,
    "timestamp": 1697350748540,
    "message": "2023-10-15T06:19:08.540Z\t5de14387-814d-4713-88ad-f374132a08d9\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '228575b5-1bc6-4eaa-917b-10fc52a11fb9'\n\n\n\n\nAND l.couponName LIKE '%200%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf33d983-d669-4a6a-8927-2de27ad775a9/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 198,
    "timestamp": 1697532770708,
    "message": "2023-10-17T08:52:50.708Z\t3bef5807-cc0f-40a0-84a6-4f28f4939150\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6c3369d0-ed83-48d1-a8ea-1f3a6f8b38c8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 199,
    "timestamp": 1697593443681,
    "message": "2023-10-18T01:44:03.681Z\t98b171f7-40dc-4093-be95-0ee228eb7b10\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\nAND l.couponCode LIKE '%fruitcoupon-kta-2023-10%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fc1de867-5a81-447a-97a8-4f301213434c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 200,
    "timestamp": 1697757172967,
    "message": "2023-10-19T23:12:52.967Z\t51414632-4d05-4554-9938-e6b2858ff79a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/557fc0b6-46eb-4d0c-a194-f4ef0fb1586d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 201,
    "timestamp": 1698365294332,
    "message": "2023-10-27T00:08:14.332Z\t9f2014ad-7874-42bd-bc3b-c761ae03ec5c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8c58ca1a-8438-4e9c-aad4-db7042ab65d2/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 202,
    "timestamp": 1698642724918,
    "message": "2023-10-30T05:12:04.918Z\tfbf85509-f38e-4769-aa4e-794c5bac130c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/546a130f-ef48-4795-b9e2-20090b084fac/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 203,
    "timestamp": 1698651429485,
    "message": "2023-10-30T07:37:09.485Z\t1c1dfcc3-7686-4da9-8cf1-d9de78eab2e2\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/81b4dc15-39c6-43c9-8584-1417bc4d4ee7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 204,
    "timestamp": 1698809077556,
    "message": "2023-11-01T03:24:37.556Z\t40d54f35-9031-41fe-ade7-1d1da116ca71\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d54118f3-02aa-4640-883f-f2e183ffa2e9/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 205,
    "timestamp": 1698819921535,
    "message": "2023-11-01T06:25:21.535Z\t42e1ff45-7ff5-449a-a2ce-7f05722ff058\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c248b886-90a0-4177-94f8-f2076d12acf8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 206,
    "timestamp": 1698910019706,
    "message": "2023-11-02T07:26:59.706Z\t6537028e-5da8-40ea-9859-e1ff9ea70466\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\n\nAND l.couponName LIKE '%壱番屋アンケートクーポン　100円券\\\\_1\\\\_2311%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/86973fd7-0637-4b4e-958b-b11fdb454cb3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 207,
    "timestamp": 1698910411771,
    "message": "2023-11-02T07:33:31.771Z\t19f31c2a-36ca-4a4d-835d-9fc7e1d9bdd9\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\n\nAND l.couponName LIKE '%壱番屋アンケートクーポン　50円券\\\\_2\\\\_2311%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/353e1789-2daa-4ce6-8cb9-6aa77837b35c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 208,
    "timestamp": 1698911532999,
    "message": "2023-11-02T07:52:12.999Z\t15aaeebc-c1fe-479b-9095-c52c4b36ee69\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b3763083-8eb2-443c-ab7b-78a66fff9f8e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 209,
    "timestamp": 1698911775461,
    "message": "2023-11-02T07:56:15.461Z\td5389d78-7f58-4927-b315-919a94dd0909\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/54bddb2d-0b61-421c-a408-c48468041f83/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 210,
    "timestamp": 1699533301738,
    "message": "2023-11-09T12:35:01.738Z\td6d2e287-af6b-4b0a-8459-6b10f270eede\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7377481-2b85-4d59-a2d5-cbb016c13af7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 211,
    "timestamp": 1699533420767,
    "message": "2023-11-09T12:37:00.767Z\t0d7e7dbb-e15f-4673-ae45-d5352628dbe7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/36f7c1a3-5fb1-4762-940e-752073ebf9b8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 212,
    "timestamp": 1699576367467,
    "message": "2023-11-10T00:32:47.467Z\td4f3dc04-8a0b-42f0-8148-e606f94b26c5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/20674157-9833-4119-9477-2314e519a587/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 213,
    "timestamp": 1699934204980,
    "message": "2023-11-14T03:56:44.980Z\tde4492cc-3f12-42a8-8da1-e87583b7ab1f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/bb709c96-3939-4cdc-aeb4-50e16efa1f67/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 214,
    "timestamp": 1700197474380,
    "message": "2023-11-17T05:04:34.380Z\t4c6294a3-e37b-4064-9175-1efcd4c92e21\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/661e0e6d-b8f9-4f44-be33-4b136c159fa5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 215,
    "timestamp": 1700552647908,
    "message": "2023-11-21T07:44:07.908Z\tf6750129-e270-42bd-b42e-4567e369e655\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/71a4fd80-711a-4df1-8887-a271dbdd2927/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 216,
    "timestamp": 1700637311722,
    "message": "2023-11-22T07:15:11.722Z\t73e54eca-4528-4787-b78c-06eaf3bc3fdb\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7a8e0f10-8f12-4690-a3c7-537b0d90353a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 217,
    "timestamp": 1700740894936,
    "message": "2023-11-23T12:01:34.936Z\t22a4cf44-2190-45e4-ba9f-591f98acf567\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2d337a53-f15d-4a6e-843c-e3e7fb01c82b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 218,
    "timestamp": 1700780921703,
    "message": "2023-11-23T23:08:41.703Z\t1fc458ad-6a47-4d1f-93aa-e794bb01ecb6\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6727b31d-b258-4585-9594-efa2e948edc6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 219,
    "timestamp": 1700784525895,
    "message": "2023-11-24T00:08:45.895Z\tc658cb1a-8f5f-4f4f-aa39-cbf82248ec0e\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2710fb5e-b2de-4b03-96dc-38e6441a6cdc/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 220,
    "timestamp": 1700920817490,
    "message": "2023-11-25T14:00:17.490Z\tae7ffc9e-91ab-4fa8-9129-3fd4c13ecd72\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7bd02776-faad-412f-b897-4408ad8d2922/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 221,
    "timestamp": 1701039900787,
    "message": "2023-11-26T23:05:00.787Z\t928db13a-9234-4b62-9960-1569c6c3c0fe\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cc741b7f-1d90-4e82-ab80-55a8b05d6005/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 222,
    "timestamp": 1701046910796,
    "message": "2023-11-27T01:01:50.796Z\t7e89c486-7d28-4818-8062-9050d3788a1c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9123ee7f-42af-42b3-906e-1ea0ceec0988/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 223,
    "timestamp": 1701046970653,
    "message": "2023-11-27T01:02:50.653Z\t4270207a-a862-449f-986e-b6a4853f5c62\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/dda87929-9091-475c-8e9c-e27ba399a7de/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 224,
    "timestamp": 1701047227835,
    "message": "2023-11-27T01:07:07.835Z\tbed75313-f6c6-4aab-87e0-c8809299cb2a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/98b8c169-2061-4fa6-8bad-45216501de63/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 225,
    "timestamp": 1701049973749,
    "message": "2023-11-27T01:52:53.749Z\t25df570e-5fe1-48c9-b9c5-971eb34990d4\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SMALL_SHOP_GROUP'\n          AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7947a4cf-6d7e-49e3-9703-77d4fe1590fe/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 226,
    "timestamp": 1701049986376,
    "message": "2023-11-27T01:53:06.376Z\t344aecd5-d3ba-45a3-91fc-8982127b654b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/643d1f99-920e-48e5-a9f2-85a29fba48c9/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 227,
    "timestamp": 1701051400704,
    "message": "2023-11-27T02:16:40.704Z\ta651ebb6-9859-431a-8946-27a460f86882\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a2e88e33-307a-4fed-9d62-b8882722e73e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 228,
    "timestamp": 1701052070532,
    "message": "2023-11-27T02:27:50.532Z\tf638eb56-98f6-4a35-ad19-0115c94307f4\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c53ac46e-0c4c-4f64-a678-341cad4d5a73/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 229,
    "timestamp": 1701126379512,
    "message": "2023-11-27T23:06:19.512Z\t864a5d0c-6d6b-44e9-a8d6-c574bd27055d\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/13765d59-64ed-4806-9dba-c855db8935c7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 230,
    "timestamp": 1701154149402,
    "message": "2023-11-28T06:49:09.402Z\t2cf488f0-94cb-4361-be13-8d85d1791254\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%帰ってきた%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ed94cca0-fdc2-420c-a718-b0e1822b979f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 231,
    "timestamp": 1701213504424,
    "message": "2023-11-28T23:18:24.424Z\t065ff5b5-271a-47e1-9893-14f85285716f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8d00bd5b-04b2-4e31-91b8-76e8c3940eee/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 232,
    "timestamp": 1701217297748,
    "message": "2023-11-29T00:21:37.748Z\te7330267-1e46-43a0-abc2-366d321e83b5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/59852d19-46c0-4899-8d6a-6c54d8574b95/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 233,
    "timestamp": 1701217533064,
    "message": "2023-11-29T00:25:33.064Z\t9ecbcdfe-e12f-4069-9828-3b27dafcc22a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/94ad0993-f499-4657-bfa5-fdeecf01592c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 234,
    "timestamp": 1701218118807,
    "message": "2023-11-29T00:35:18.807Z\t19f7a966-af65-4f36-a8e0-95e1db7510e3\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d653d437-467b-41eb-b41e-d2c7aa99e53d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 235,
    "timestamp": 1701219869885,
    "message": "2023-11-29T01:04:29.885Z\t407a5637-57d1-41fa-a784-1050eaa3945d\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/76ab98d2-4f7a-4d69-b582-16e4feae5411/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 236,
    "timestamp": 1701299218613,
    "message": "2023-11-29T23:06:58.613Z\t2491c405-8d87-4d12-b791-2dbc554a74b5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7252c5b8-2e78-48ee-8652-cef8ad622aaf/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 237,
    "timestamp": 1701386503049,
    "message": "2023-11-30T23:21:43.049Z\t78f4d3f3-d286-4b01-975e-2950efe4fff4\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e2cd4713-7422-423d-a76d-e6629ca9db0b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 238,
    "timestamp": 1701391911639,
    "message": "2023-12-01T00:51:51.639Z\t0f11ce44-d5de-48c4-92f7-ee23e74398bf\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fca5fb1e-a63e-449f-8a03-b978a76cb465/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 239,
    "timestamp": 1701405860748,
    "message": "2023-12-01T04:44:20.748Z\t90c9f6d7-3318-4cb1-b8d1-3219524c0062\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f686b65a-cceb-4c5f-b05d-07e2d8e7bdbd/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 240,
    "timestamp": 1701415586660,
    "message": "2023-12-01T07:26:26.660Z\t7c2f3ec3-5a0a-4724-89fe-3fddabf83f6d\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%帰ってきた%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d98def0e-5a66-418c-9414-f452abb83bdf/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 241,
    "timestamp": 1701474159308,
    "message": "2023-12-01T23:42:39.308Z\tf9780c6b-d0c0-4fbc-97b5-3b0030353bff\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/17ff72d2-12fa-413e-a600-8caf95631252/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 242,
    "timestamp": 1701558901787,
    "message": "2023-12-02T23:15:01.787Z\t4e8965c3-46a0-40c2-aaef-91cdd1d9759c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%帰ってきた%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/92a4457f-de25-45c5-88cc-f720f432c142/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 243,
    "timestamp": 1701559932282,
    "message": "2023-12-02T23:32:12.282Z\t9af20d7f-d114-4438-9665-4afaf5d4d764\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%帰ってきた%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4d5e6ee8-a6de-4c92-a59d-990caac144a3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 244,
    "timestamp": 1701560038422,
    "message": "2023-12-02T23:33:58.422Z\t72910cd3-616d-47db-aaea-9838c7eb1ff1\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%帰ってきた%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7554b17c-7910-45bb-83bf-b7fe3881839e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 245,
    "timestamp": 1701560892954,
    "message": "2023-12-02T23:48:12.954Z\tfbb44e98-d304-4d4c-8e05-a6a8ce5cd1f4\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d87f3fd7-ecd0-4bd3-b619-41f7d2286814/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 246,
    "timestamp": 1701588899397,
    "message": "2023-12-03T07:34:59.397Z\t740e4803-0664-4476-9da8-863610c1e569\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/88c7e07b-826c-4f18-8b92-851ba18b77a7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 247,
    "timestamp": 1701645165978,
    "message": "2023-12-03T23:12:45.978Z\tbeca84f0-dee9-4034-ba33-9e8b4a18e9cf\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d9a5a04f-ed09-4525-962f-f2d9f4592114/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 248,
    "timestamp": 1701732095220,
    "message": "2023-12-04T23:21:35.220Z\t90c46e58-a295-44fb-9d6d-5dc023124eac\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/de547c5f-700b-4378-aa6e-cc67b7e5bd45/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 249,
    "timestamp": 1701817675169,
    "message": "2023-12-05T23:07:55.169Z\t53c7fb2c-16ad-418c-b9ed-61b6481a6905\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/01d0c2c2-4491-45ed-a237-a280b5cb178c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 250,
    "timestamp": 1701903533907,
    "message": "2023-12-06T22:58:53.907Z\t05b76eea-5878-4132-95bb-92c30bf43cac\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b3a47ffe-eff2-4834-9c21-a62b4b630fcc/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 251,
    "timestamp": 1701990800760,
    "message": "2023-12-07T23:13:20.760Z\t24be8e82-2624-4278-b75c-b91493554991\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a007239-43fa-470f-8d1f-96dee1de446e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 252,
    "timestamp": 1702010875327,
    "message": "2023-12-08T04:47:55.327Z\ta98c438a-5df5-433d-a368-a27edb9fd6ef\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9f64a4b1-0b4d-43b9-a30b-f8ec4564c1e5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 253,
    "timestamp": 1702021787345,
    "message": "2023-12-08T07:49:47.345Z\t9401be39-cb52-4b9e-90c9-0989b330c148\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/331f6817-257c-4ecb-8a89-74f83fee5ec1/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 254,
    "timestamp": 1702069674660,
    "message": "2023-12-08T21:07:54.660Z\tf56ffe7a-0e38-4438-95f7-0902e4b74d47\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/41cda8b9-49e0-496d-857f-957e2f7c3204/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 255,
    "timestamp": 1702154513510,
    "message": "2023-12-09T20:41:53.510Z\t3f23f304-cda6-4186-99b8-4867d580ea01\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ed0b75d-5837-4fb5-a7fa-243de9659ada/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 256,
    "timestamp": 1702219805172,
    "message": "2023-12-10T14:50:05.172Z\tb9279225-a0a7-4e8d-addf-4f0ccd4ac791\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%帰ってきた%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c33c98da-1afe-488f-bba9-812a8d5da75c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 257,
    "timestamp": 1702249401807,
    "message": "2023-12-10T23:03:21.807Z\t527a33d9-893a-4bda-b749-c130c0f3932a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/08495cb0-eaed-4782-b7e2-c99d94353692/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 258,
    "timestamp": 1702257126615,
    "message": "2023-12-11T01:12:06.615Z\t2a2cfc1b-e35a-4bc3-8673-804e9d045bef\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ea0de1af-2394-46d0-b53d-1e3f4862aea5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 259,
    "timestamp": 1702269457479,
    "message": "2023-12-11T04:37:37.479Z\tc172eba6-e158-47ce-a141-e2561669ca76\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\n\nAND l.couponName LIKE '%【本番\\\\_23010%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9926c7ec-833c-4c8a-9c2e-e33a608ed53c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 260,
    "timestamp": 1702280797282,
    "message": "2023-12-11T07:46:37.282Z\t215e5376-6cfe-4413-aab8-f0b20629ecfc\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c1b82baa-2170-4cca-b22c-68162305cac6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 261,
    "timestamp": 1702335480473,
    "message": "2023-12-11T22:58:00.473Z\tf737b1ba-aa49-4b16-9ee9-058033878df5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6c997fc1-be03-4d50-a9c4-e8b59bda7080/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 262,
    "timestamp": 1702338687212,
    "message": "2023-12-11T23:51:27.212Z\ta3d44fbb-2f6f-4dfb-97a2-63ada85dea96\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4f25d925-b7d6-4f76-a7e2-8b823eebb7d2/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 263,
    "timestamp": 1702369335081,
    "message": "2023-12-12T08:22:15.081Z\t531def5e-c66a-4265-8a86-f99bc4a3b07a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%jichi%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3fec7427-a9b2-4e3e-9d7b-12516ccac8ed/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 264,
    "timestamp": 1702369467963,
    "message": "2023-12-12T08:24:27.963Z\t1d001d8a-fbce-4698-90d8-376a9b80ccdc\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%jichi%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e4b034b1-956f-4996-919a-a2e8c0377a7b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 265,
    "timestamp": 1702371186074,
    "message": "2023-12-12T08:53:06.074Z\tea3163a8-fa49-45d5-afd5-5b65369e08fe\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%jichi%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c043ef8-e9bf-493c-abfd-384cb9c29d2b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 266,
    "timestamp": 1702371422482,
    "message": "2023-12-12T08:57:02.482Z\t4627ff95-068d-4bbe-b847-380b07eb2c9a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%jichi%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/10551ee8-ad63-49ef-a34b-19efab4880a0/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 267,
    "timestamp": 1702371571675,
    "message": "2023-12-12T08:59:31.675Z\t98115d4b-b0f7-48fd-ba5d-41e0f86317f7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%ji%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a4cba85f-0c41-48aa-a384-0ae1617d6d10/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 268,
    "timestamp": 1702371688213,
    "message": "2023-12-12T09:01:28.213Z\tdf8e9250-b941-48e8-bc6e-0d62d0003f37\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%jichi%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7c0f1a7-3430-43ca-aa26-f75fa5bc4b3f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 269,
    "timestamp": 1702375249758,
    "message": "2023-12-12T10:00:49.758Z\t7a2a30ec-b160-4d92-904e-d651b7fa17b7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ff736176-63f6-4aa6-b6b0-7bed9809999b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 270,
    "timestamp": 1702422731274,
    "message": "2023-12-12T23:12:11.274Z\tb1da96f1-8c2c-4254-af87-2cf1a4f4ca10\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4821c8f1-5bd6-4d54-be2e-84886ad7ef42/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 271,
    "timestamp": 1702508869871,
    "message": "2023-12-13T23:07:49.871Z\t3a9b52ae-f1c8-45ba-a62c-9fc856d651ed\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e3874ed0-514e-466a-bfcf-307438af4511/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 272,
    "timestamp": 1702594632987,
    "message": "2023-12-14T22:57:12.987Z\tfcf76d46-f564-4031-86be-51a7c7bc79da\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35153619-db43-44fe-a0d0-767c9d55fc00/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 273,
    "timestamp": 1702594885945,
    "message": "2023-12-14T23:01:25.945Z\t20fed014-97c1-4d69-b55a-e2ad7996c38f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ca599a3-1c03-4b96-bddc-f6f102f89f35/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 274,
    "timestamp": 1702600205735,
    "message": "2023-12-15T00:30:05.735Z\t839f18e8-e16c-4292-bbb0-2fc4cefb6d00\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/29815bf5-c0aa-445e-b99d-c3d480cd555f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 275,
    "timestamp": 1702679839087,
    "message": "2023-12-15T22:37:19.087Z\tc9575f69-59b5-4e7d-b933-9c375b2f32ad\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7df14682-e38b-4805-9eb3-8c2e696a7337/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 276,
    "timestamp": 1702679921128,
    "message": "2023-12-15T22:38:41.128Z\t0bc9e928-10d1-4e4a-94ed-6764f9b5a4b7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f0162291-0869-41b7-b09f-56f905b5dcbe/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 277,
    "timestamp": 1702767196355,
    "message": "2023-12-16T22:53:16.355Z\t6e2aa9f0-c81d-4880-b676-b2e234716126\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f8434020-cbde-481b-9d56-343bead0976a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 278,
    "timestamp": 1702854009748,
    "message": "2023-12-17T23:00:09.748Z\t9f33ddcf-b287-4534-a4c3-1cca3cd4b308\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e7f00235-944c-4ad0-be12-cc2c1de5b911/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 279,
    "timestamp": 1702940437604,
    "message": "2023-12-18T23:00:37.604Z\t376b9ccd-0f70-40a9-ab4d-005db98f8426\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/49213d31-27a6-4039-a559-d4bf248eeb22/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 280,
    "timestamp": 1703027323884,
    "message": "2023-12-19T23:08:43.884Z\t6d9cba2f-4d41-4143-9c9d-3f827b1b52e5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5b5b379d-da45-4c71-9f18-a0d3081eb4ba/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 281,
    "timestamp": 1703113324015,
    "message": "2023-12-20T23:02:04.015Z\ta0b0d7f7-0f1c-456d-a078-604a624350b1\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a8e5f77a-2708-40f3-b6a4-9401d3e008ae/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 282,
    "timestamp": 1703199911656,
    "message": "2023-12-21T23:05:11.656Z\t6cc9a327-1376-40b3-8c09-1546c61c9752\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7951d180-f9aa-4959-b073-3321cb6934c1/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 283,
    "timestamp": 1703205492178,
    "message": "2023-12-22T00:38:12.178Z\tfddab9c7-1dcc-4634-8bea-9ebaf43b17bd\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d03a2a3d-38cd-4670-b7bf-6389ed12750d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 284,
    "timestamp": 1703236952541,
    "message": "2023-12-22T09:22:32.541Z\t92b2feed-dd8c-42c2-97c2-f3653f10580a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8c1e926d-7bcf-4a11-97a1-2014d3194a49/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 285,
    "timestamp": 1703237440325,
    "message": "2023-12-22T09:30:40.325Z\t7a130790-c7a7-4aec-b66e-256cb911e6c1\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/eae2b012-0667-455b-ab83-56f7f0476aa0/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 286,
    "timestamp": 1703284897832,
    "message": "2023-12-22T22:41:37.832Z\te85a450c-4799-4512-b8c7-41bb669886b9\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f6487737-34e1-45d8-9082-1c8a611138cd/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 287,
    "timestamp": 1703314526083,
    "message": "2023-12-23T06:55:26.083Z\t8be682b1-5ee9-4eff-acf0-ad05fa451cc5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/973221c9-253f-40aa-9d82-a90da71e94b5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 288,
    "timestamp": 1703321520006,
    "message": "2023-12-23T08:52:00.006Z\tfd86aecb-6254-4778-83c7-c90f1268ec12\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/339cd040-2169-40e3-8eb2-7d76986798fd/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 289,
    "timestamp": 1703328762130,
    "message": "2023-12-23T10:52:42.130Z\t7462b634-6f32-45dc-a67d-afe5260aa7d6\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2bc0cec7-51b2-4d16-8d68-c4b309b9f7b1/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 290,
    "timestamp": 1703335883323,
    "message": "2023-12-23T12:51:23.323Z\t940e86e8-b5dd-46bc-8ca7-8826f211ed0a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d120c278-2244-4511-b695-cb0d8b6f5cc7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 291,
    "timestamp": 1703342970451,
    "message": "2023-12-23T14:49:30.451Z\t614da44f-419e-42a6-88c2-0eae52250997\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ab0f0de8-671a-4927-b394-4161adb59171/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 292,
    "timestamp": 1703347194215,
    "message": "2023-12-23T15:59:54.215Z\t286f745a-5414-4299-bbb1-c4fef55ce438\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/aec91681-a2c2-4ef0-b318-d1e3b75139d6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 293,
    "timestamp": 1703350905271,
    "message": "2023-12-23T17:01:45.271Z\t5611b1d4-6005-4d38-b829-85495e5a3e16\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2c4ec220-990b-4d8c-9c6c-93f11cc4c759/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 294,
    "timestamp": 1703459158597,
    "message": "2023-12-24T23:05:58.597Z\tecbb7c09-db85-49fd-a871-d52e1b68e63a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3bd4f433-c4c6-49fd-89b2-4df3eb201550/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 295,
    "timestamp": 1703565633450,
    "message": "2023-12-26T04:40:33.450Z\t6e9f5807-3429-434b-ab73-a9a233b91fb3\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9a2b3fe4-9fee-4f29-b299-51427d4d0bf0/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 296,
    "timestamp": 1703735879474,
    "message": "2023-12-28T03:57:59.474Z\tca2db7d1-d9ba-460c-a80b-515deaf9a95c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%2312%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0e63c6a0-3969-415a-8dd0-3bfa63b199e4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 297,
    "timestamp": 1703737403232,
    "message": "2023-12-28T04:23:23.232Z\tcf34dc8a-331f-48b6-96f8-f9463e763abe\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%2401%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35d70299-ceac-4402-ac51-02a660806391/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 298,
    "timestamp": 1703737652688,
    "message": "2023-12-28T04:27:32.688Z\tf0021dff-731e-4da1-a848-25b20b5cb0a6\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%2401%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e6ce0476-f2a8-4872-9d01-42daa07493a5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 299,
    "timestamp": 1704423426614,
    "message": "2024-01-05T02:57:06.614Z\t92fe220f-73a9-4fd6-b74d-d175c318b1a2\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9a8d9f49-963e-4147-8762-861421c032af/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 300,
    "timestamp": 1704432606282,
    "message": "2024-01-05T05:30:06.282Z\t3ec9d370-4e40-4f74-8273-65151cd4bc81\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c58bb15b-fa25-4506-80a0-ce9fef28d31c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 301,
    "timestamp": 1704432868782,
    "message": "2024-01-05T05:34:28.782Z\t4e55d02b-5189-48e5-bafb-8a7a2077cc2f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%2312%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/af197c6b-4c49-44ab-b293-c99bde0bbd3e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 302,
    "timestamp": 1704433804458,
    "message": "2024-01-05T05:50:04.458Z\ta7e933a4-7556-44b4-9c15-88fa93203d43\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/762b0d70-659f-496b-8c24-c104b64201f5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 303,
    "timestamp": 1704768430463,
    "message": "2024-01-09T02:47:10.463Z\t2387c14b-8374-4ae7-a2d9-ecc40aca0c4f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/59933021-6001-4104-bd5f-cd080d2425f3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 304,
    "timestamp": 1705032623437,
    "message": "2024-01-12T04:10:23.437Z\t87c8267c-e619-416d-9373-c50786fba4a3\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ba4ddebc-d3f0-4128-b762-4d0a952bd434/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 305,
    "timestamp": 1705038775489,
    "message": "2024-01-12T05:52:55.489Z\t9a6c828c-15ea-4c26-ad29-b3ae6ea0bf4b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b9360d97-f2eb-4ae6-b951-4ebcec8da360/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 306,
    "timestamp": 1705464147049,
    "message": "2024-01-17T04:02:27.049Z\t8f904b3b-5dee-41c1-a199-fb56b87e9e1f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b04d27fb-2588-4a6b-86f7-dbc76744369d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 307,
    "timestamp": 1705468098209,
    "message": "2024-01-17T05:08:18.209Z\t0aaf7a1e-36ae-4198-adeb-21d63bd210d4\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1476ec3a-a91d-48a7-ab79-37c604418cc8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 308,
    "timestamp": 1705639470552,
    "message": "2024-01-19T04:44:30.552Z\tfaa85eb1-7b2d-47d2-8ef2-d9b6e50eea11\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%2401%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/574b3b1d-3372-4aba-9a73-f6e954929515/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 309,
    "timestamp": 1706228129768,
    "message": "2024-01-26T00:15:29.768Z\t458ad671-ff0f-4ad8-912f-cec3b849bc42\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%2401%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/64b0aa3c-b04e-4fcd-a0e4-b3c92b64c01f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 310,
    "timestamp": 1706228227427,
    "message": "2024-01-26T00:17:07.427Z\tc36c958f-a787-4e2e-98dd-9126bdb6e625\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%2402%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f36d730c-e4fb-4ea9-9695-7887d460f78a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 311,
    "timestamp": 1706500577051,
    "message": "2024-01-29T03:56:17.051Z\t59b4be57-3b61-422e-8cb8-5747d94eaed4\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4a879612-0975-4d7f-8280-ae20f424d504/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 312,
    "timestamp": 1706500879912,
    "message": "2024-01-29T04:01:19.912Z\t4168a486-3328-4a92-bc10-d0a4ef1cf7ba\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c213a257-2d76-45b1-b106-f9df8aeb87b7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 313,
    "timestamp": 1706580920140,
    "message": "2024-01-30T02:15:20.140Z\t87289233-55ef-46b6-a6d1-454f4ba2e47a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb'\n\n\n\nAND l.couponCode LIKE '%20230801-31-kaunseringu%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/17b0eaa1-9726-4e47-8545-8dccc4fddd9a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 314,
    "timestamp": 1706760209836,
    "message": "2024-02-01T04:03:29.836Z\t6305b6fc-aee9-4a54-aa84-d1389ba1be38\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40718bc8-3dca-4ceb-a250-b58acdd09e25/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 315,
    "timestamp": 1706762725552,
    "message": "2024-02-01T04:45:25.552Z\tf04cbf75-d670-45a2-b396-688401f94f83\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4f6e5e5a-65c4-4b9d-913f-993b3d2839f5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 316,
    "timestamp": 1706849329319,
    "message": "2024-02-02T04:48:49.319Z\t22846d83-fcbf-48d1-b6d7-efeec1c03a46\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c846a9ec-f8e6-4bf5-8fa4-c9ecb1c70a70/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 317,
    "timestamp": 1706849442577,
    "message": "2024-02-02T04:50:42.577Z\td92f1a5e-85ed-48ba-8110-e9b6f5735f5a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%2402%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/bda1828e-30b3-4645-95af-8fc28851668a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 318,
    "timestamp": 1707108295654,
    "message": "2024-02-05T04:44:55.654Z\td29cd961-22e6-489f-a73f-2cd81b0052e9\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87'\n\n\n\nAND l.couponCode LIKE '%029308%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/63747f6e-622f-40ee-b4d6-20cf7b3c0377/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 319,
    "timestamp": 1707287655470,
    "message": "2024-02-07T06:34:15.470Z\t06158d35-74cc-428b-9271-f17b4cd48621\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/72fa5163-d5a2-4886-b5b2-41c0a4f2996f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 320,
    "timestamp": 1707438360401,
    "message": "2024-02-09T00:26:00.401Z\te851cdb7-1452-4840-acb0-6183e1217046\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fcf13836-b923-4bbf-a08e-3b3ad44a8cae/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 321,
    "timestamp": 1707536985709,
    "message": "2024-02-10T03:49:45.709Z\te2578a89-c1a4-4996-bae2-defcd931b405\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1dde06fa-124c-4d48-8634-e05345cc7a3c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 322,
    "timestamp": 1708057764672,
    "message": "2024-02-16T04:29:24.672Z\t6355578b-b164-4040-900c-5981ebb7a8c6\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f1587821-76e1-4c39-a01c-9dc9b29611b0/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 323,
    "timestamp": 1708057846892,
    "message": "2024-02-16T04:30:46.892Z\ted64f01f-2cb5-4df1-8d93-43ad45738339\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d92e892d-ce1c-441e-baf4-bf4e7f69854d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 324,
    "timestamp": 1708058000460,
    "message": "2024-02-16T04:33:20.460Z\t06e917d6-5004-48c8-ab84-417bbd2b4c77\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0b606eb3-8966-4c16-8ba6-c93cfd95fbe7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 325,
    "timestamp": 1708674703149,
    "message": "2024-02-23T07:51:43.149Z\t68648f95-eae5-4056-8dbb-795631e2534a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'c5ac151d-f0ca-428d-93a0-dba919145c60'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0feff883-6359-4805-b518-5efcb1eb1730/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 326,
    "timestamp": 1709252576846,
    "message": "2024-03-01T00:22:56.846Z\t8f83991f-2599-4de4-b468-21ecf27466da\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8896f149-5133-4679-bc53-6fa74f19d355/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 327,
    "timestamp": 1709270970294,
    "message": "2024-03-01T05:29:30.294Z\tc8ae7d9a-5c25-4a81-b3d8-1805bc778bcd\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5f884861-7fc3-4eed-9c6f-d5c63e00b5fe/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 328,
    "timestamp": 1709272776553,
    "message": "2024-03-01T05:59:36.553Z\tbd13bfc8-10c4-4c17-b8a0-70d6a18690db\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78585734-a878-4b6a-8043-9fdddd3b991a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 329,
    "timestamp": 1709863866585,
    "message": "2024-03-08T02:11:06.585Z\t8c88216d-1f08-4f43-a736-53f54b48b872\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5f4c937b-1fb0-489c-9da5-6d452317d388/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 330,
    "timestamp": 1711353244314,
    "message": "2024-03-25T07:54:04.314Z\tb3b127a9-32b7-44aa-96bf-93703343fe58\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b8fa2dd5-d61d-499f-98a6-3bb18a56babb/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 331,
    "timestamp": 1711498981623,
    "message": "2024-03-27T00:23:01.623Z\t108df44b-dcc3-4abd-ae27-11dd29bbc738\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9ac83c6d-7d1e-4f24-91b5-42ec7b004e23/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 332,
    "timestamp": 1711935176345,
    "message": "2024-04-01T01:32:56.345Z\t7580e275-887e-4771-8604-adcd19753020\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4eb6d4c9-26ee-42ce-bd60-e05164912713/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 333,
    "timestamp": 1712190901842,
    "message": "2024-04-04T00:35:01.842Z\t727deca7-44d3-4bd3-bc97-c0e9a4d3b7ef\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '743dbbdd-71bc-4ce1-a8d0-744ac1213ecb'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a1a97589-3554-49fc-8d4c-d2221f565b7e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 334,
    "timestamp": 1712281831674,
    "message": "2024-04-05T01:50:31.674Z\taac9011c-e6f6-4d45-a719-fc23da05d5be\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/606bb10f-8e71-43e7-9a82-a99becd0a7ed/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 335,
    "timestamp": 1712739647122,
    "message": "2024-04-10T09:00:47.122Z\td9427517-4969-4f12-90cb-118bc8745f5c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4b3dc73f-5a9b-435e-a9b5-90f0391b2fc3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 336,
    "timestamp": 1712816159823,
    "message": "2024-04-11T06:15:59.823Z\t3bf08d38-e30d-487c-a8a9-442c630bf36f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5'\n\n\n\nAND l.couponCode LIKE '%aeonzannen%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf7bde01-ee88-4590-9c29-4d8d62291fd7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 337,
    "timestamp": 1712883618839,
    "message": "2024-04-12T01:00:18.839Z\ta2551a80-9bb9-482a-bb77-56b8f6a634da\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4bd61eb3-07c1-4489-904c-9f4e65180a15/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 338,
    "timestamp": 1712883853519,
    "message": "2024-04-12T01:04:13.519Z\tf8a48a85-307e-4325-b75b-19bf81436752\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/23cc76a5-1c04-4ed2-8c8f-145e64b5aaa8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 339,
    "timestamp": 1712886336064,
    "message": "2024-04-12T01:45:36.064Z\teefdf2d6-f4c9-4e76-a24e-82fbc330658b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/72c723e3-7307-4a1c-8a05-34375ef79af1/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 340,
    "timestamp": 1712890586865,
    "message": "2024-04-12T02:56:26.865Z\t466d7259-9220-4ac9-901d-80eba0638a76\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d991a765-5d8e-4024-80da-badf0ea5e1af/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 341,
    "timestamp": 1712895516395,
    "message": "2024-04-12T04:18:36.395Z\te3ea6925-028a-4524-9827-0cad90d4b6db\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1db1a84a-c51f-4aa4-95a9-d98523748634/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 342,
    "timestamp": 1714528427973,
    "message": "2024-05-01T01:53:47.973Z\tdc776c7e-f4ab-4f27-b190-c968082ffea3\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c4da17f-731e-4d00-b1f9-0b22973dbcb1/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 343,
    "timestamp": 1714528684987,
    "message": "2024-05-01T01:58:04.987Z\t51ba567e-04de-4a43-afd9-c8f245f2e26e\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/48f86122-3930-45e9-b26b-f268b555a862/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 344,
    "timestamp": 1714529899692,
    "message": "2024-05-01T02:18:19.692Z\t98231eef-f594-48e5-8458-1d1323bd924a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2f5c337b-0cb4-49af-b057-db6faab5f68e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 345,
    "timestamp": 1714531872624,
    "message": "2024-05-01T02:51:12.624Z\tbe191407-9082-4ce6-804d-0c4ace8b2fb7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40df404e-f214-43e9-883d-6320a38e8a60/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 346,
    "timestamp": 1714532850765,
    "message": "2024-05-01T03:07:30.765Z\t54765d8f-a6e5-4092-a8a6-9f480ca6d103\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a1eb8ce3-ed76-48ac-9000-502d41733094/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 347,
    "timestamp": 1714534342758,
    "message": "2024-05-01T03:32:22.758Z\t37158f81-705c-4044-8504-f345880ace56\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'd634f7c1-f232-4abc-b4dc-5a7c8dbbca6e'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8b399454-5caa-4064-86e9-b633816c9c5e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 348,
    "timestamp": 1714542086676,
    "message": "2024-05-01T05:41:26.676Z\t6e5e4fe7-c562-4f86-93a4-37484736084c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a3348357-d4c9-4eb8-8590-df387bc399a7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 349,
    "timestamp": 1715057339218,
    "message": "2024-05-07T04:48:59.218Z\t51a9231d-045a-4e07-9687-0ecdd4670403\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/65f8c38b-2fe4-4149-9fb3-050c0f040b41/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 350,
    "timestamp": 1715304927358,
    "message": "2024-05-10T01:35:27.358Z\t6db05ca5-ef36-4d7e-803a-73a206a6aa11\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b5a84bf1-d378-41a6-897f-05858cbb6c9d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 351,
    "timestamp": 1715926133052,
    "message": "2024-05-17T06:08:53.052Z\t14f308ef-db7c-46b4-9913-e04a7fa986a3\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0b400d8b-5bce-4973-bc21-2ab1c0121060/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 352,
    "timestamp": 1716511477248,
    "message": "2024-05-24T00:44:37.248Z\tec854e97-6076-419f-ae1e-49e2bafd53f6\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/96e57bee-8b64-4a23-b36d-8250d557edbe/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 353,
    "timestamp": 1716830439899,
    "message": "2024-05-27T17:20:39.899Z\tf18a0761-1609-4423-9f8f-a9523ef97d80\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya-100yen-2405%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/93b7117d-5ada-4fb7-b540-9b58087f122c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 354,
    "timestamp": 1716921173648,
    "message": "2024-05-28T18:32:53.648Z\td0b72081-3f6b-4ccc-a63b-26f11de944b1\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya-100yen-2405%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7953501d-3d98-4d2a-8b95-fcf98f257cc2/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 355,
    "timestamp": 1717037496937,
    "message": "2024-05-30T02:51:36.937Z\t4962e8b7-17df-4f18-8e85-0a33cc438063\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya-100yen-2405%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9f16f727-243b-4568-aec4-f217fe44373b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 356,
    "timestamp": 1719721786728,
    "message": "2024-06-30T04:29:46.728Z\t1b37a897-43fd-4561-b2b6-aa1a783c4847\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%jichitai-sample%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9b767096-64dc-47e8-bcc0-c566e861464d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 357,
    "timestamp": 1719800287524,
    "message": "2024-07-01T02:18:07.524Z\t55bf7c0c-3c10-4524-b5a8-8dbe81313d95\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/25713b72-adf3-4ecd-abb7-b40ba3461511/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 358,
    "timestamp": 1720514610750,
    "message": "2024-07-09T08:43:30.750Z\t37b1e9f7-ce5f-4fe4-9cc9-e81d1bec2125\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5479f7d1-8592-4f8f-9eeb-ebe8842c60b8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 359,
    "timestamp": 1720676505814,
    "message": "2024-07-11T05:41:45.814Z\t5f898ea8-e82b-4bcc-a91e-be3fdb745421\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c440ac93-cc1a-400e-857c-afc70f61c267/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 360,
    "timestamp": 1720766720034,
    "message": "2024-07-12T06:45:20.034Z\td4db4087-0d8e-40f1-944f-4fad73e28cee\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fc673a07-0768-4005-b7a0-e6ee7db6f700/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 361,
    "timestamp": 1720777991155,
    "message": "2024-07-12T09:53:11.155Z\tb2bc04c6-17f7-4e98-9135-c70f59d83d97\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/11fb5920-dd80-4c01-b000-95b34e588989/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 362,
    "timestamp": 1720778138137,
    "message": "2024-07-12T09:55:38.137Z\tb4abcfcd-5ebb-4350-9b06-07327430e824\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SMALL_SHOP_GROUP'\n          AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1e771793-b2db-45f7-8b62-8e0412246130/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 363,
    "timestamp": 1721958297368,
    "message": "2024-07-26T01:44:57.368Z\t06c86135-6e06-408c-849b-094d59b8c1f0\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87'\n\n\n\n\nAND l.couponName LIKE '%KC1094%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7db082dd-7046-4027-b5ec-3c6fb2b4c718/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 364,
    "timestamp": 1721963279732,
    "message": "2024-07-26T03:07:59.732Z\tf9c842fe-d319-468b-8381-9af94db78338\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87'\n\n\n\n\nAND l.couponName LIKE '%KC1094%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5c5f1a02-bce0-4068-93c5-701f18c3145b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 365,
    "timestamp": 1721963833226,
    "message": "2024-07-26T03:17:13.226Z\t5cdc01fe-a86f-4198-ab81-7d87fdbb90b3\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87'\n\n\n\n\nAND l.couponName LIKE '%KC1094%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9d95c4c4-bc77-4ddd-b650-a8c973cadd62/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 366,
    "timestamp": 1722321556899,
    "message": "2024-07-30T06:39:16.899Z\t47d57a8e-690b-4cbe-a93e-a811be03ac36\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\nAND l.couponCode LIKE '%KC103%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/18797882-1e18-48f6-9d1a-f00fc9d62d84/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 367,
    "timestamp": 1722321615360,
    "message": "2024-07-30T06:40:15.360Z\t803ab259-1068-4213-8c38-72d3c5997133\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\nAND l.couponName LIKE '%KC103%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9be41e1a-6097-490e-86a9-e394f1c5d58b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 368,
    "timestamp": 1722324111911,
    "message": "2024-07-30T07:21:51.911Z\t73692b81-64a4-40ac-960d-8d8803e44bfc\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\nAND l.couponCode LIKE '%030038007%'\nAND l.couponName LIKE '%KC1032%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/853b390e-fcb0-4255-b5dc-410d4e34cc61/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 369,
    "timestamp": 1722579664084,
    "message": "2024-08-02T06:21:04.084Z\t47089da0-ec51-4702-a6da-9040277f2221\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e7c9aca9-1c36-4197-81a6-a5362d00a508/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 370,
    "timestamp": 1723710511492,
    "message": "2024-08-15T08:28:31.492Z\t8f7d5629-9f26-4f22-86a1-d56e26dc1698\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%art-ishigakijima-samplecoupon1%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/37a82985-1ccc-48b6-98ae-b9916f8375ed/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 371,
    "timestamp": 1724723377095,
    "message": "2024-08-27T01:49:37.095Z\t04ee4f6f-fe8c-4b32-bf51-29245a86bf6f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e448495-ee76-4156-b821-be379ed671a7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 372,
    "timestamp": 1724723606839,
    "message": "2024-08-27T01:53:26.839Z\tf10a256b-94e4-4498-b8f1-bb27a0475caa\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/21e1fc86-6d37-40d2-bc8b-dca157c3c3d4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 373,
    "timestamp": 1724723914473,
    "message": "2024-08-27T01:58:34.473Z\tc4e9a94b-124f-4f7d-b247-be20372865b1\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c9ce5122-3f8a-4e12-96c1-eba3a3b943e6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 374,
    "timestamp": 1724724158201,
    "message": "2024-08-27T02:02:38.201Z\t274bc964-de5b-4ffa-bda7-3cf809dd7041\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5d27a658-fbd2-4e67-bcfd-c3f14dfc439c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 375,
    "timestamp": 1724974599909,
    "message": "2024-08-29T23:36:39.909Z\t7e885aa7-1d9f-4b7a-b526-a70e2c9ddb87\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/81c15330-82e2-4e0c-88b6-fff3ced580e9/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 376,
    "timestamp": 1724974673686,
    "message": "2024-08-29T23:37:53.686Z\t1a4c945f-6df2-41dc-816d-636c432ce8e5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c06f8a8e-a5ce-4e3d-950f-287cf95f1e40/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 377,
    "timestamp": 1725184890897,
    "message": "2024-09-01T10:01:30.897Z\tc86ebb45-3e9a-4034-a5c5-b9384622dbdc\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/307ece39-0432-408f-a261-4dd974b4e177/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 378,
    "timestamp": 1725234059646,
    "message": "2024-09-01T23:40:59.646Z\tc7791455-6d60-4858-88ab-08ac899efaec\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/83605c7b-96fe-4f1f-bad8-91c8aae187df/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 379,
    "timestamp": 1725246323655,
    "message": "2024-09-02T03:05:23.655Z\t50af21d3-a261-44e9-9a2f-0082be5cfc41\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4be453df-9747-4eac-922b-3d4cc3a2d7d7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 380,
    "timestamp": 1725278457680,
    "message": "2024-09-02T12:00:57.680Z\tfcbb986d-31cf-43e3-8764-f5119caedf43\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1010b8bc-28eb-47dd-8b96-a4c67649f0f2/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 381,
    "timestamp": 1725324872967,
    "message": "2024-09-03T00:54:32.967Z\t902178e0-51fa-4d5d-9a35-c4e5f997c891\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2c07c81a-f2f2-4249-aba2-bc09aa52b293/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 382,
    "timestamp": 1725421551077,
    "message": "2024-09-04T03:45:51.077Z\t409ae6e0-6979-47d9-985b-c74d8a61d351\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b1afec81-c767-4ff4-b5a4-9c1a33862e2b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 383,
    "timestamp": 1725847600252,
    "message": "2024-09-09T02:06:40.252Z\td67d626e-f0a6-4150-90e3-8c7b52218077\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/954159c9-7f73-4b73-b8a3-16441447a3e8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 384,
    "timestamp": 1725847783191,
    "message": "2024-09-09T02:09:43.191Z\tc84c1091-aa48-45bb-98bf-0627aa34e258\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\nAND l.couponCode LIKE '%121212%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/42d84b15-d9eb-45a0-a5b1-dbbacf04f1ba/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 385,
    "timestamp": 1726825551759,
    "message": "2024-09-20T09:45:51.759Z\t50e209b0-eb48-45d6-b6bb-a5270e250e66\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'SHOP'\n          AND oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98'\n            AND o.name LIKE '%上野マルイ%'\n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c08a0652-4a34-4126-a5c6-46d27de5f660/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 386,
    "timestamp": 1727748145338,
    "message": "2024-10-01T02:02:25.338Z\tcbfcfb1d-6f0e-4c38-a2cb-99a0fc9271fc\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e99ecb04-e950-4cd3-a384-0fbaeeabd227'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a8750b6c-e125-4f08-bf17-4f2750db3bc3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 387,
    "timestamp": 1727752248634,
    "message": "2024-10-01T03:10:48.634Z\ta60380df-8864-4af9-bd10-0d48fb18ac4a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'df79441a-ee1c-4efd-ade7-794b40c574f5'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7b11d791-6297-4a52-941f-cd7afebf1084/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 388,
    "timestamp": 1727771165952,
    "message": "2024-10-01T08:26:05.952Z\t861b8354-7d57-4772-b928-bb9c128d7da7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/599a6189-f78e-472f-9803-8f2643893e74/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 389,
    "timestamp": 1727776345115,
    "message": "2024-10-01T09:52:25.115Z\t584d59c6-10e7-465a-ab63-c3b4f034e4c7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c76336e7-1d75-4c39-b8dc-e3918d855a93/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 390,
    "timestamp": 1728293051314,
    "message": "2024-10-07T09:24:11.314Z\t40880040-5288-45d4-b665-ac7e8140bc3a\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/39d377ca-207c-457b-951a-8e09e81adf62/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 391,
    "timestamp": 1728293234993,
    "message": "2024-10-07T09:27:14.993Z\t60bced32-e1e8-4deb-b679-dc9c7f60c948\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b21d523f-44f1-47f6-ae17-662e0a7a6a39/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 392,
    "timestamp": 1728293368049,
    "message": "2024-10-07T09:29:28.049Z\tbc59e3e2-c60a-4288-bd8f-97be6db1f4b9\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cd12a569-0d68-42c1-b443-2ddeeb13eca4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 393,
    "timestamp": 1728349796333,
    "message": "2024-10-08T01:09:56.333Z\t4cb50296-2898-4118-b1ea-ce6b784d949b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cf61201a-c2a2-4ac8-83df-9b019e931772/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 394,
    "timestamp": 1728351296943,
    "message": "2024-10-08T01:34:56.943Z\t1a611f90-5c7e-4d2f-9ec8-2a3080706915\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a3607fec-8746-4e2f-bb81-b900fdd62f8c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 395,
    "timestamp": 1728521513873,
    "message": "2024-10-10T00:51:53.873Z\t7d2595c6-dfac-4f86-842c-a0a2231f5f42\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/07dbda08-6125-4a43-bac7-2bf3f969af4c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 396,
    "timestamp": 1728524212755,
    "message": "2024-10-10T01:36:52.755Z\ta15bcb3c-3a89-4813-b70e-a21f0d157580\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/23583a16-0061-4f4d-ba3d-7f4948179344/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 397,
    "timestamp": 1728524662837,
    "message": "2024-10-10T01:44:22.837Z\t881f0aa1-9b18-4284-a375-594b88b9fea4\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/da7586c0-5167-4ef9-88de-aadd1f8602b4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 398,
    "timestamp": 1728527876695,
    "message": "2024-10-10T02:37:56.695Z\t3ee7b388-7752-4cba-8d34-5d6a1a99e2f2\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f027938d-331f-42a7-bd9b-de3afd5e9a55/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 399,
    "timestamp": 1728540806427,
    "message": "2024-10-10T06:13:26.427Z\t6180375b-55ab-49cb-ba76-4c41306ed712\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0e1783a7-fddd-4767-b2e0-d37930c421c8/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 400,
    "timestamp": 1728606135911,
    "message": "2024-10-11T00:22:15.911Z\t8954d938-40df-4beb-8297-d595f7f32d7f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/19c33f25-f622-4c6f-81a0-58ca51b517ae/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 401,
    "timestamp": 1728607095791,
    "message": "2024-10-11T00:38:15.791Z\td53c05e4-8ec5-4926-ad6d-7f72fad977b2\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8a4fad33-acf5-47b7-a25f-95bed57c7c9d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 402,
    "timestamp": 1728950730687,
    "message": "2024-10-15T00:05:30.687Z\tc3e6a370-1bcb-4bb9-bec7-fd180fd21dd8\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/72ca19a6-d7a6-467b-b338-d4ff0d72072d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 403,
    "timestamp": 1728982120142,
    "message": "2024-10-15T08:48:40.142Z\tb30ed1e6-5a88-4a00-8b9c-82b8745d94a8\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ca7693ac-84c5-4c5b-b340-a11c037860da/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 404,
    "timestamp": 1728982252042,
    "message": "2024-10-15T08:50:52.042Z\t45343e27-f04c-4218-a0b6-3903ead8666e\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14929483-f425-460c-83e5-e4f4e40e497a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 405,
    "timestamp": 1729037816083,
    "message": "2024-10-16T00:16:56.083Z\t5a94af0a-1231-4feb-9d63-8684cc8fdac8\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6e61abfe-8ee3-4bbf-8742-156e1149b40c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 406,
    "timestamp": 1729123361202,
    "message": "2024-10-17T00:02:41.202Z\tb52c8557-514e-4652-9a0d-1fd845baa974\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0d36aa4a-dace-4f50-946b-f2330e49aa89/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 407,
    "timestamp": 1729214927037,
    "message": "2024-10-18T01:28:47.037Z\t358c12a8-66a0-4461-99d2-10e6ad1a3aba\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d7508fac-73e6-4257-9e39-2f3d3ac4647d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 408,
    "timestamp": 1729226743871,
    "message": "2024-10-18T04:45:43.871Z\tee54f7b1-3ce8-4f0b-91b5-e97717543e44\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f662e1b6-b81e-4fda-a757-db726a8be2a5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 409,
    "timestamp": 1729469457604,
    "message": "2024-10-21T00:10:57.604Z\t25234c8c-9f30-4dfe-99a9-86eef14f9d1c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c80c7e64-81d9-40da-b86d-5cc1f6afb218/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 410,
    "timestamp": 1729555206688,
    "message": "2024-10-22T00:00:06.688Z\t34c13257-6f08-419e-9867-a3df526a6d70\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7fb34974-7159-419e-b49b-b2d96373f153/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 411,
    "timestamp": 1729641390123,
    "message": "2024-10-22T23:56:30.123Z\t06fc3848-d22f-40fd-9d1e-1aff3a48c32b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/768c46cc-21b1-4aaa-a740-ff312927ab97/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 412,
    "timestamp": 1729660791821,
    "message": "2024-10-23T05:19:51.821Z\t6535dba0-65c8-4ebb-93e8-668e1f812519\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ddae8e7d-8e1c-4f73-9933-42a218c0c8fe/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 413,
    "timestamp": 1729676928754,
    "message": "2024-10-23T09:48:48.754Z\tfc74fc9f-f7d9-4b10-aa68-d494e6c5d649\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e40b822d-2c9d-4060-9a4a-e9c82cb9da98'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4c7e314e-57c0-47af-be0b-f8f6847e20bd/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 414,
    "timestamp": 1729728252671,
    "message": "2024-10-24T00:04:12.671Z\tddcbaf8e-90db-4f95-86b1-982f24163f2d\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/35b421ea-271e-48e7-b6de-23c13610d724/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 415,
    "timestamp": 1729815079290,
    "message": "2024-10-25T00:11:19.290Z\tf75cf5dc-4ad2-431a-b4d5-ea467eb62db7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/827d0494-9b75-4da4-9558-b2753112855a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 416,
    "timestamp": 1729815486082,
    "message": "2024-10-25T00:18:06.082Z\tdf72c5e7-1ee8-44c5-b1a3-89661202e708\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9c542576-4ffa-4187-a81a-b956d1c5a33b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 417,
    "timestamp": 1729820977372,
    "message": "2024-10-25T01:49:37.372Z\t75a14690-e25a-454e-9607-ac341c6cdc0b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%Ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/36fdd7fa-d36e-4fe3-9179-0e67f2f2c44d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 418,
    "timestamp": 1729821028756,
    "message": "2024-10-25T01:50:28.756Z\t1a323cb9-4c4c-4bb1-b8ab-473d9f4b3589\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2b5d5a2e-7767-4329-878d-1cf9ac6e0c6c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 419,
    "timestamp": 1730073413492,
    "message": "2024-10-27T23:56:53.492Z\t3646e682-3c8d-4814-bdde-899218ddc1b4\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/e5c3adfa-de26-4972-a853-4019e26c445b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 420,
    "timestamp": 1730160150189,
    "message": "2024-10-29T00:02:30.189Z\tc00844ba-0af4-4197-bf28-61bea75d5854\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/516762b6-8279-45ef-bb12-293ad2cdcbe6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 421,
    "timestamp": 1730245917586,
    "message": "2024-10-29T23:51:57.586Z\t70b6928f-d1c4-4409-b87e-2b4f7ef63d7f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/459e2201-b1f1-44fe-80dd-e2844e20c4b6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 422,
    "timestamp": 1730326144003,
    "message": "2024-10-30T22:09:04.003Z\tb3f84647-7469-4ee9-af23-83e1045e84a0\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'BIG_SHOP_GROUP'\n          AND oc.parentId = 'dcdaf32b-1480-4f98-9816-f35b349d6310'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/989f87a7-d635-4ccf-a76d-8c2886f8c7c2/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 423,
    "timestamp": 1730326492349,
    "message": "2024-10-30T22:14:52.349Z\t65c12742-2921-454c-841e-91bf0685a3d7\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER() OVER(ORDER BY o.name) AS \"No\", o.name AS \"組織名\",\n               (\n                  SELECT COUNT(*)\n                  FROM coupon_logs l\n                  WHERE o.resourceId = l.organizationId\n                    AND type = 'issued'\n                    AND NOT EXISTS(\n                      SELECT\n                        1\n                      FROM\n                        coupon_logs AS l2\n                      WHERE\n                        l.couponId = l2.couponId\n                        AND l2.type = 'issued'\n                        AND l.createAtMillis < l2.createAtMillis\n                    )\n               ) AS         \"発行数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'used'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"消込数\",\n\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l,\n                        organization_closure oc\n                   WHERE oc.parentId = o.resourceId\n                     AND oc.childId = l.usedShopId\n                     AND type = 'canceled'\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l2\n                           WHERE l.couponId = l2.couponId\n                             AND l2.type <> 'displayed'\n                             AND l.createAtMillis < l2.createAtMillis\n                       )\n               ) AS         \"キャンセル\"\n        FROM organization o\n                 JOIN\n             organization_closure oc\n             ON oc.childId = o.resourceId\n        WHERE o.type = 'BIG_SHOP_GROUP'\n          AND oc.parentId = 'dcdaf32b-1480-4f98-9816-f35b349d6310'\n            \n        ORDER BY\n            o.name\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2af07bf7-3779-4b34-bb99-e5df585a915d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n    \n"
  },
  {
    "order": 424,
    "timestamp": 1730420673308,
    "message": "2024-11-01T00:24:33.308Z\t8238225c-bf30-4106-b127-8b41bcee5a79\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5a90d691-93b3-4dc0-8151-b6a72c345744/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 425,
    "timestamp": 1730765649668,
    "message": "2024-11-05T00:14:09.668Z\t1f3ccc4f-c4d8-4c6d-af1d-08d8b02d7131\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/913cfb8c-b44e-4aa3-a5ee-4c3e2df3106d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 426,
    "timestamp": 1730851255958,
    "message": "2024-11-06T00:00:55.958Z\tab7e4127-2cbd-48b5-ad61-d9942c277cf1\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7d063186-7bce-4c65-84a2-34c9a24af1e3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 427,
    "timestamp": 1730851364380,
    "message": "2024-11-06T00:02:44.380Z\t93b74ff5-3522-4c7d-b487-22b9515ca4ea\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/693e5d05-c603-45bc-9db1-73c8234e7e99/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 428,
    "timestamp": 1730878765960,
    "message": "2024-11-06T07:39:25.960Z\te7a68a90-d920-45c3-8a39-43d19c2b8ba6\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3ec0f997-806e-4bea-999c-2c499fe259c3/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 429,
    "timestamp": 1730882649511,
    "message": "2024-11-06T08:44:09.511Z\te3f215ef-0650-4905-a02d-1dde0376575f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/755d868a-fb10-4154-86fa-b1a898c7c08d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 430,
    "timestamp": 1730939702887,
    "message": "2024-11-07T00:35:02.887Z\t30172470-0085-481e-9f21-eaea81938345\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/74488c83-a5f0-4ebb-b1b4-a5249d8d5cbd/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 431,
    "timestamp": 1730944258261,
    "message": "2024-11-07T01:50:58.261Z\ta3eac951-b45f-4932-a87f-b9a91d96ae51\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a84339f6-831f-4ca6-84b7-9b915badeb1c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 432,
    "timestamp": 1731024740263,
    "message": "2024-11-08T00:12:20.263Z\tcee700a9-5f4d-48b4-ab3f-45f69879ab1e\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/609de23a-13c4-41dc-8958-a34ee7ee3314/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 433,
    "timestamp": 1731283339074,
    "message": "2024-11-11T00:02:19.074Z\t28ab8dd4-36c6-4030-8e88-20bebe3ffd55\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/be1b42c9-a09f-4b40-86cf-b3cbd4946c55/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 434,
    "timestamp": 1731370229541,
    "message": "2024-11-12T00:10:29.541Z\t8f9ea8d3-cc7b-4a37-adf6-66ad5c196943\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4b32f8c9-c7df-46ac-9f6e-39a50afc2f8e/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 435,
    "timestamp": 1731370527793,
    "message": "2024-11-12T00:15:27.793Z\ta4bbcb09-f1dc-49a8-b886-320cc90499da\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a5332727-eb12-4e3e-aa38-d329feadac9c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 436,
    "timestamp": 1731457372583,
    "message": "2024-11-13T00:22:52.583Z\ta659d6c3-1ccc-4ad2-ac28-b06312b54429\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3a8515bf-ed7a-439a-add4-cdce2610117b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 437,
    "timestamp": 1731534654612,
    "message": "2024-11-13T21:50:54.612Z\tfcbb7002-cef5-4f83-ad7e-ef54ae992554\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c'\n\n\n\n\nAND l.couponName LIKE '%【中島水産】専用クーポン(2024/10/15発行)%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/30b4d570-1914-44ee-bf23-be63d2b5495c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 438,
    "timestamp": 1731543440110,
    "message": "2024-11-14T00:17:20.110Z\te1476236-199e-428d-ac42-ff0379ef2f81\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/46a32076-93e6-44af-a821-6cc93eae56f4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 439,
    "timestamp": 1731630195681,
    "message": "2024-11-15T00:23:15.681Z\t4da5bd5c-982d-4442-97e1-459c6e322420\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a75f70a4-7a10-4055-b6a8-a24b2b2b01df/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 440,
    "timestamp": 1731636430281,
    "message": "2024-11-15T02:07:10.281Z\t0dbd69b6-0c8f-4dc7-8b91-a3c0455e9478\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b16de748-68fb-4dcd-8259-97168afbd764/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 441,
    "timestamp": 1731975175565,
    "message": "2024-11-19T00:12:55.565Z\tf7424998-edc2-4e78-9c9c-7bbd7ca1865c\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/14da2371-bc9e-48f3-9239-62e003acf9ac/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 442,
    "timestamp": 1731990005239,
    "message": "2024-11-19T04:20:05.239Z\t5fb2da57-d519-4afb-9ee2-fdd026ee1e18\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/04ac3083-ffb6-4eae-9714-73fe6688d8ba/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 443,
    "timestamp": 1732062506681,
    "message": "2024-11-20T00:28:26.681Z\t5bc64ea8-458b-45f4-94f3-5cfd078bcbd8\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/27aba9d6-3c32-4ff8-94dd-c15ded95933c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 444,
    "timestamp": 1732072075089,
    "message": "2024-11-20T03:07:55.089Z\tc67efc2e-11a1-428e-a205-ba0481e4b200\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '4474b986-5d97-4978-a58e-696e4e38c27c'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/78a33221-4a41-4f01-85a5-6b12c66dfc53/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 445,
    "timestamp": 1732149428066,
    "message": "2024-11-21T00:37:08.066Z\tace75280-4c6d-4fcb-8231-d9438ccf3f65\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/40a2e4e0-f014-4634-8a97-cd2662611033/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 446,
    "timestamp": 1732234315362,
    "message": "2024-11-22T00:11:55.362Z\t085a1121-07bb-48f1-8a67-e57138f5cd2f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6cc0d22d-738f-423e-8708-f67f58acc3c0/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 447,
    "timestamp": 1732250171482,
    "message": "2024-11-22T04:36:11.482Z\tde4a4df1-01e5-4bf4-84ab-d85276fcb601\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/262ce766-3b76-4e70-80a3-479751642bc6/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 448,
    "timestamp": 1732493710493,
    "message": "2024-11-25T00:15:10.493Z\t642f0b00-45a5-4861-bf8f-d3df3b848a25\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b26d7163-1dd2-49ac-b4c4-455d4d82a6e4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 449,
    "timestamp": 1732526110314,
    "message": "2024-11-25T09:15:10.314Z\t6b839ea4-12a8-4203-beac-6a785435fd40\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE2coupon%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1dc463a0-243e-44ec-ae0b-429f1db3f58f/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 450,
    "timestamp": 1732579562416,
    "message": "2024-11-26T00:06:02.416Z\t7b9ca8db-98be-4547-93ef-888746d83e3b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5488c41e-6c68-4c4d-a818-2f79030552be/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 451,
    "timestamp": 1732666604311,
    "message": "2024-11-27T00:16:44.311Z\t95a957ee-5539-481d-849e-aca90c78e380\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/558ac29e-852c-4aeb-aed2-bed9b92e33a4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 452,
    "timestamp": 1732751014088,
    "message": "2024-11-27T23:43:34.088Z\tcfe9c45c-ed82-4b62-8093-319bf26b79d3\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5ac0cfa4-d74f-4321-9be4-c8ff49703d4a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 453,
    "timestamp": 1732751890907,
    "message": "2024-11-27T23:58:10.907Z\t974030d1-7f1b-4c34-ae29-ff50afe69949\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7b99878d-31fe-456f-8e42-02407e59010d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 454,
    "timestamp": 1732838522901,
    "message": "2024-11-29T00:02:02.901Z\t39571531-1984-454a-9870-6c777a21e9c9\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/22906843-f1c0-4e9d-b5f9-7d75ab73ea27/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 455,
    "timestamp": 1732852787761,
    "message": "2024-11-29T03:59:47.761Z\t23dc9722-b582-4812-bfe5-6026c26c84cb\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/903521c7-8244-4e89-9a4b-af7b1c8c2fe5/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 456,
    "timestamp": 1733098268927,
    "message": "2024-12-02T00:11:08.927Z\t9b641350-9704-4e9a-9dd8-51676eda5cdf\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3c440c0f-1531-423a-9867-6eda8ba9ece7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 457,
    "timestamp": 1733184765807,
    "message": "2024-12-03T00:12:45.807Z\tc8ba21ae-6704-4225-b2a6-90cb6f8c5a94\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4bbaa9a6-e23c-4d18-8d45-a0c2274d28a1/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 458,
    "timestamp": 1733270165051,
    "message": "2024-12-03T23:56:05.051Z\t9d9321a6-5918-4aed-ad28-e2f3ccd562f5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f6233bfa-d4dc-40d0-b83a-0630e894d709/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 459,
    "timestamp": 1733357654338,
    "message": "2024-12-05T00:14:14.338Z\te9ed9659-95cf-4195-98ac-73f937c43518\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9fdeb359-d2a0-4550-a42d-336ebf7aed3d/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 460,
    "timestamp": 1733443355480,
    "message": "2024-12-06T00:02:35.480Z\tfc637e00-5f31-4a03-968b-96f5ea8d2ee6\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/83b7605a-7993-48d2-b150-df65d765207b/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 461,
    "timestamp": 1733702509158,
    "message": "2024-12-09T00:01:49.158Z\ta79e4c4d-d17d-4394-a335-43e3b1836f3b\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c8076ee5-035e-4f3b-9667-9578b91ec6e4/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 462,
    "timestamp": 1733789004977,
    "message": "2024-12-10T00:03:24.977Z\te68c02a9-f49f-47d9-97d6-c39b04b15c57\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/76f4e41b-7727-492e-a827-4cf88fa3d81c/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 463,
    "timestamp": 1733789285571,
    "message": "2024-12-10T00:08:05.571Z\td641a2f5-69e5-4dc9-bc80-833801ad73a5\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/849fb7d7-4cbf-4c01-bd89-b0c4c2169c33/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 464,
    "timestamp": 1733797251660,
    "message": "2024-12-10T02:20:51.660Z\t360adcda-b3b5-461e-b0b5-de924cc2ddf9\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '8219ca6d-38a1-447f-a59a-6b9cdee52985'\n\n\n\nAND l.couponCode LIKE '%ichibanya%'\nAND l.couponName LIKE '%11%'\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a620bee7-a9f2-4b46-9021-706c112d13c1/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 465,
    "timestamp": 1733875463301,
    "message": "2024-12-11T00:04:23.301Z\tcac5b85e-f6eb-416d-9eae-85392d3ee8ad\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/120549c1-145b-473b-ad2e-d1f46b0bc3b7/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 466,
    "timestamp": 1733961531468,
    "message": "2024-12-11T23:58:51.468Z\t2e2d4967-adea-458d-991b-d86fc5a0c13f\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ffa818fd-04cf-4cda-909d-67b287b21c1a/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  },
  {
    "order": 467,
    "timestamp": 1734048554469,
    "message": "2024-12-13T00:09:14.469Z\tc033e774-6fc9-41d5-b5ae-9e4cb10e9803\tINFO\tsql \n      unload ($$\n        SELECT ROW_NUMBER()  OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n               couponCode AS \"クーポンコード\",\n               couponName AS \"クーポン名\",\n               (\n                  SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                      AND l2.couponMasterId = l.couponMasterId\n                      AND NOT EXISTS(\n                        SELECT\n                          1\n                        FROM\n                          coupon_logs AS l3\n                        WHERE\n                          l2.couponId = l3.couponId\n                          AND l3.type = 'issued'\n                          AND l2.createAtMillis < l3.createAtMillis\n                    )\n               )          AS \"発行数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'used'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"使用済数\",\n               (\n                   SELECT COUNT(*)\n                   FROM coupon_logs l2\n                   WHERE l2.type = 'canceled'\n                     AND l2.couponMasterId = l.couponMasterId\n                     AND NOT EXISTS(\n                           SELECT 1\n                           FROM coupon_logs AS l3\n                           WHERE l2.couponId = l3.couponId\n                             AND l3.type <> 'displayed'\n                             AND l2.createAtMillis < l3.createAtMillis\n                       )\n               )          AS \"キャンセル\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n        ORDER BY couponCode,\n                 couponName\n      $$)\n      to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/68d07f61-695f-4fc7-9d50-9a79503f8a60/'\n      iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n      DELIMITER ','\n      ADDQUOTES\n      HEADER\n      PARALLEL OFF\n      \n"
  }
]