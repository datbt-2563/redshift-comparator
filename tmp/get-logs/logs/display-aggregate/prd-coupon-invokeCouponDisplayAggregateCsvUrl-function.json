[
  {
    "order": 0,
    "timestamp": 1672601866056,
    "message": "2023-01-01T19:37:46.056Z\tfbc89132-a6c7-4daf-b95a-077ef2b429fb\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 1,
    "timestamp": 1672702180984,
    "message": "2023-01-02T23:29:40.983Z\tba1fada8-b713-4ff4-bde9-d1c4279b8593\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 2,
    "timestamp": 1672786054687,
    "message": "2023-01-03T22:47:34.687Z\tbd2fc519-7e40-4c1e-975a-07bb5cfd62e5\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 3,
    "timestamp": 1672873095350,
    "message": "2023-01-04T22:58:15.350Z\t449bd3a0-bed8-40cd-a1fb-37eb3d444994\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 4,
    "timestamp": 1672959758895,
    "message": "2023-01-05T23:02:38.895Z\tdaade386-3a5a-44e5-9e84-f7f80c05ffd3\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 5,
    "timestamp": 1672959979835,
    "message": "2023-01-05T23:06:19.835Z\t68e0b8e9-25d7-48f0-9af1-d5a8e29b34e1\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 6,
    "timestamp": 1673047122020,
    "message": "2023-01-06T23:18:42.020Z\te5e86a6e-f784-4faf-ba01-b4e3dbaa86c1\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 7,
    "timestamp": 1673133806371,
    "message": "2023-01-07T23:23:26.371Z\t6e176908-a69e-42e2-9af1-77de10ea7817\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 8,
    "timestamp": 1673219863158,
    "message": "2023-01-08T23:17:43.157Z\tff24f73d-e6c2-4bdb-b4ec-951e988b706f\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 9,
    "timestamp": 1673304907048,
    "message": "2023-01-09T22:55:07.047Z\t3405c8e1-7c20-42eb-8983-c4ad8e2eb095\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 10,
    "timestamp": 1673391820080,
    "message": "2023-01-10T23:03:40.080Z\t1dabde06-64f7-432a-9ef8-d1da612d0bdf\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 11,
    "timestamp": 1673477914323,
    "message": "2023-01-11T22:58:34.323Z\t37f4dc30-6fa6-41d1-bad6-80ee39e2bdbe\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 12,
    "timestamp": 1673564600688,
    "message": "2023-01-12T23:03:20.688Z\t46c5d12e-2148-421b-b77d-f3b02a7e3f13\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 13,
    "timestamp": 1673564750001,
    "message": "2023-01-12T23:05:50.001Z\taa769a22-1929-4078-ab43-d79be83c95f8\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 14,
    "timestamp": 1673564802402,
    "message": "2023-01-12T23:06:42.402Z\t3a020a8a-c12c-4a3f-92a2-d7d69c513f55\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 15,
    "timestamp": 1673564882885,
    "message": "2023-01-12T23:08:02.882Z\t56f32639-9bac-4339-9648-c3cb038e5f3d\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 16,
    "timestamp": 1673651559497,
    "message": "2023-01-13T23:12:39.497Z\tf3db973a-f0d0-492b-ba9a-0ca02bbcc4cf\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 17,
    "timestamp": 1673739827357,
    "message": "2023-01-14T23:43:47.357Z\tbceb728a-f1f9-4aa2-b303-e2dbe8f97622\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 18,
    "timestamp": 1673823425362,
    "message": "2023-01-15T22:57:05.362Z\t9af9bc68-7c44-4561-8c7e-086ebe96a39e\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京１０１０%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 19,
    "timestamp": 1673823779089,
    "message": "2023-01-15T23:02:59.089Z\tc488ee7f-895f-411a-839a-10d27bc567f8\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 20,
    "timestamp": 1673909257641,
    "message": "2023-01-16T22:47:37.641Z\t078f5e5b-4f99-4c0c-ba92-593afc8ca31f\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 21,
    "timestamp": 1673910309810,
    "message": "2023-01-16T23:05:09.810Z\te416557b-f856-41e0-be0a-b8ac3bfd0068\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 22,
    "timestamp": 1673995876728,
    "message": "2023-01-17T22:51:16.728Z\t29d83802-960b-4c0a-b8e0-44153236272c\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 23,
    "timestamp": 1674082713423,
    "message": "2023-01-18T22:58:33.423Z\t69de01c0-1697-42c2-bcf8-5d3c974f63e6\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 24,
    "timestamp": 1674169585221,
    "message": "2023-01-19T23:06:25.221Z\teb123a0c-c85d-4f6e-8088-8466905f76d4\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 25,
    "timestamp": 1674255774916,
    "message": "2023-01-20T23:02:54.916Z\t9f5be465-0d8a-4634-8051-6cb7e94bf6f3\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%東京1010%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 26,
    "timestamp": 1674517494033,
    "message": "2023-01-23T23:44:54.033Z\t83bf963e-e7b8-4143-a791-1b0d3dde38a8\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 27,
    "timestamp": 1675159403665,
    "message": "2023-01-31T10:03:23.664Z\t41d6e4a8-3dd8-4a15-8804-fdd851ea32bd\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87'\n\n\n\nAND l.couponCode LIKE '%￯ﾼﾡ￯ﾼﾗ￯ﾼﾘ￯ﾼﾓ￯ﾼﾐ￯ﾼﾘ￯ﾼﾒ￯ﾼﾒ￯ﾼﾓ￯ﾼﾒ￯ﾼﾑ￯ﾼﾐ￯ﾼﾗ￯ﾼﾕ￯ﾼﾣ%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 28,
    "timestamp": 1675159418359,
    "message": "2023-01-31T10:03:38.359Z\t997864cb-22fa-43c5-bd97-2c18bee54f38\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'd4e3ccff-215e-4bf3-b85b-d120b1e75278'\n\n\n\nAND l.couponCode LIKE '%1238627571730235%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 29,
    "timestamp": 1675317202475,
    "message": "2023-02-02T05:53:22.475Z\t1ea451e4-871b-46ed-be48-e25bb0490254\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%reform20221031%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 30,
    "timestamp": 1675388160407,
    "message": "2023-02-03T01:36:00.407Z\tb7660c44-e21e-4e07-8501-2614a2985666\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%yomiren20230203%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 31,
    "timestamp": 1675846863136,
    "message": "2023-02-08T09:01:03.136Z\t2a4de6e1-b084-4970-9de8-f0304334c11b\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\nAND l.couponName LIKE '%KC1072%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 32,
    "timestamp": 1675847514741,
    "message": "2023-02-08T09:11:54.739Z\tf6044262-fc9b-4f3c-b2ea-7436f197ee5f\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\n\nAND l.couponName LIKE '%KC1072%'\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 33,
    "timestamp": 1676367325472,
    "message": "2023-02-14T09:35:25.472Z\tfdbfe368-a210-4aa1-b043-aed4501c16ae\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'ebb35040-6d55-47dc-82f3-1a7270149f5b'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 34,
    "timestamp": 1685438932917,
    "message": "2023-05-30T09:28:52.917Z\t8846646b-428f-437f-816d-64621bbd3713\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 35,
    "timestamp": 1685440530148,
    "message": "2023-05-30T09:55:30.148Z\tf96fd1a7-eacc-42ab-8823-d9a113998250\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\n\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 36,
    "timestamp": 1687342189552,
    "message": "2023-06-21T10:09:49.552Z\t908229dc-0844-4098-b395-9810da62091b\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\nAND l.couponCode LIKE '%022956007%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 37,
    "timestamp": 1687342545969,
    "message": "2023-06-21T10:15:45.969Z\tad8a3e0c-c4a4-4e73-8b73-5a0cd9ca04b6\tINFO\tsql \n        SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.item.name.S AS \"組織名\",\n               couponCode                                   AS \"クーポンコード\",\n               couponName                                   AS \"クーポン名\",\n               (\n                   SELECT COUNT(*)\n                   FROM (\n                            SELECT DISTINCT couponId\n                            FROM coupon_logs l2\n                            WHERE l2.type = 'issued'\n                              AND l2.couponMasterId = l.couponMasterId\n                        )\n               )                                            AS \"発行数\",\n               (SELECT COUNT(*)\n                FROM coupon_logs l2\n                WHERE l2.type = 'displayed'\n                  AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n            \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.item.resourceId.S = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\nAND l.couponCode LIKE '%022956007%'\n\n\n        ORDER BY couponCode,\n                 couponName\n    \n"
  },
  {
    "order": 38,
    "timestamp": 1687762266254,
    "message": "2023-06-26T06:51:06.254Z\t0ee14576-c586-45b2-bf22-e26c1e16bc53\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e20e5fa3-b373-4f1b-b175-4f66fda2be78'\n\n\n\nAND l.couponCode LIKE '%022956007%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/92aea2c5-9f75-4702-8d32-c9eec0839560/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 39,
    "timestamp": 1687762514724,
    "message": "2023-06-26T06:55:14.724Z\t4442e7ce-6f63-4e3e-b8e6-6c765e5971d6\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\nAND l.couponCode LIKE '%022956007%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/574dda23-7826-4bc1-be81-de6fa2499d64/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 40,
    "timestamp": 1687765365304,
    "message": "2023-06-26T07:42:45.304Z\t08ade6bf-00e8-4f12-b7a6-1d8040d309bd\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'be6821fa-6ac1-478c-a356-64d24a317a63'\n\n\n\nAND l.couponCode LIKE '%012206%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7338f39b-9f01-4be2-812f-57c9c23f741b/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 41,
    "timestamp": 1691032708611,
    "message": "2023-08-03T03:18:28.611Z\t89d192c0-7951-4912-ac6a-0e344ce3d8ca\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n\n\n\nAND l.couponCode LIKE '%0001%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/8168d505-bcff-43c0-b4a9-499963677f81/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 42,
    "timestamp": 1691583549716,
    "message": "2023-08-09T12:19:09.716Z\t683356c0-3242-4bfc-9529-b7ed6478bb13\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '2d604e05-5c13-423f-ae98-7f29dc5cc1cf'\n\n\n\nAND l.couponCode LIKE '%0001%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ced6e63a-761f-4124-9510-63856d3e3442/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 43,
    "timestamp": 1696992975440,
    "message": "2023-10-11T02:56:15.440Z\t1eef59aa-6f91-4f6d-90cb-a19107fed1c0\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン【サンプル】%'\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/270f0d99-6110-4db3-8e35-9e3bcc2bbdd6/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 44,
    "timestamp": 1697533036379,
    "message": "2023-10-17T08:57:16.379Z\t3cae8c24-1dfa-47ea-8edd-b4cd42900e98\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'a998e975-6bfd-40f3-8a64-4e489a6b7cc5'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4dd7b332-f729-4624-b16a-02470b37fd13/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 45,
    "timestamp": 1700637547183,
    "message": "2023-11-22T07:19:07.183Z\t1ebd03f9-3c6d-4729-8df9-e367272f1967\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1da70939-2558-442d-8f00-efbdc60ddda3/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 46,
    "timestamp": 1700741078285,
    "message": "2023-11-23T12:04:38.285Z\t7efa6e93-bacd-4758-9574-2ed6f7e69376\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2f8f19ab-3173-4603-80c0-37fe322d58eb/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 47,
    "timestamp": 1700781161748,
    "message": "2023-11-23T23:12:41.748Z\t37d20ccd-72bf-4125-be06-853c0c4f609b\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0b481299-bd99-43ce-ba0c-e9e8a23c5e86/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 48,
    "timestamp": 1700921092777,
    "message": "2023-11-25T14:04:52.777Z\t5852daf5-718d-492b-aa1f-54fa622ee347\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4fda44de-7ad5-4794-8d6e-0bd94245f2e3/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 49,
    "timestamp": 1701040014224,
    "message": "2023-11-26T23:06:54.224Z\tc7040456-6e83-4a3a-aeaf-4632b21778a0\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7d7b4bd1-0805-43f2-9199-99e337c57751/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 50,
    "timestamp": 1701047109734,
    "message": "2023-11-27T01:05:09.734Z\t1b5ad287-5ca1-4f3a-b782-88e77f26ccab\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\nAND l.couponName LIKE '%京たんごフルーツキャンペーン%'\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a0dc2783-126e-4b87-a70f-c8c0ff48a573/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 51,
    "timestamp": 1701047357651,
    "message": "2023-11-27T01:09:17.651Z\t13268167-0319-4b33-8b36-0dbb6c0488bb\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6bcece6e-3477-4858-84fb-cd02b3937a19/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 52,
    "timestamp": 1701051687732,
    "message": "2023-11-27T02:21:27.732Z\t6b00b401-29d2-41fc-a5f3-a492dd3d793c\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/93e70947-003a-4475-82dd-ff39688d713d/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 53,
    "timestamp": 1701126541408,
    "message": "2023-11-27T23:09:01.408Z\t02bb7ff9-8e30-4213-8102-c0415197b203\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/358e0c05-5ebd-4e7a-b7b7-c6b6eabfa16b/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 54,
    "timestamp": 1701214250327,
    "message": "2023-11-28T23:30:50.327Z\tab339516-8bbe-49d5-b87f-85508f8fede6\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ce73bbc2-ca22-4b82-9c6f-708feeb75011/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 55,
    "timestamp": 1701217641302,
    "message": "2023-11-29T00:27:21.302Z\t03bf715a-556a-42bc-b2ac-70a8564fc434\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/a471bb85-16d9-4ad4-9a37-7eaf19cfb432/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 56,
    "timestamp": 1701217891107,
    "message": "2023-11-29T00:31:31.107Z\tcd221f9d-1b9e-4a80-9c27-e22be47e2693\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '966b73e3-c8b2-4305-a1bc-24de6bb4748f'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/99f18f4f-2feb-4dac-93e1-b7a684e12611/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 57,
    "timestamp": 1701299453063,
    "message": "2023-11-29T23:10:53.063Z\t094077d2-65ba-4da9-969b-c3d4d211ccca\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/590e1a81-ed7b-4939-ac19-21527f4c18be/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 58,
    "timestamp": 1701386748229,
    "message": "2023-11-30T23:25:48.229Z\t3218b0f8-95bb-4a69-b712-e71a35faf772\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/880e49cb-5e01-42e4-b93b-7eaf516cca2c/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 59,
    "timestamp": 1701413732148,
    "message": "2023-12-01T06:55:32.148Z\ta2214f57-4d5c-4a30-ba68-9285f54941bc\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%帰ってきた%'\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/46ef1599-eaf0-44fb-a634-b67379c5a67f/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 60,
    "timestamp": 1701474263675,
    "message": "2023-12-01T23:44:23.675Z\tc36e004e-dc7c-4e02-b9c1-a60ed47713af\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/2961b01d-ec6b-4923-8c7d-d40074c336fe/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 61,
    "timestamp": 1701561042269,
    "message": "2023-12-02T23:50:42.269Z\t3fc3d27e-429b-41f4-a61a-684f852da144\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%1010クーポン%'\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f7bfa752-06f1-4cc6-8af0-2f97a4b81d95/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 62,
    "timestamp": 1701588818794,
    "message": "2023-12-03T07:33:38.794Z\te00ed61f-cf4c-4a44-88d5-6ccc64972a37\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/be4ebfa6-d964-4607-bd57-0402eeda6062/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 63,
    "timestamp": 1701645259493,
    "message": "2023-12-03T23:14:19.493Z\tbb1be142-09e4-49f9-9048-0eea3b3fdbcc\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/677c2ac0-bd14-4045-987b-bb7d042448ba/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 64,
    "timestamp": 1701733746765,
    "message": "2023-12-04T23:49:06.765Z\t36dc7cf2-9785-4cb8-8895-12cd4d0121fd\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/73f1b17c-4848-4bcf-9111-c022e900cad3/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 65,
    "timestamp": 1701817991716,
    "message": "2023-12-05T23:13:11.716Z\tf4da2616-4fcf-457f-b03c-198cedce852d\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/79f69b78-85c1-4920-ae22-261664f0d627/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 66,
    "timestamp": 1701903672944,
    "message": "2023-12-06T23:01:12.944Z\t4ba7080c-ccef-481c-87bb-3e06312c8e84\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/34c08437-915b-4dd7-9e96-097b2d2bc088/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 67,
    "timestamp": 1701990708936,
    "message": "2023-12-07T23:11:48.936Z\t2180ad66-0edc-4df3-95a9-481c9cc70247\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/dd0b1504-5925-4aae-967b-70aca5d0451b/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 68,
    "timestamp": 1702069786232,
    "message": "2023-12-08T21:09:46.232Z\t8b046f74-a362-462c-bd1f-f9a9a60edc0b\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f6c10c84-24cc-43d4-afe0-959f6f79b4a0/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 69,
    "timestamp": 1702154610068,
    "message": "2023-12-09T20:43:30.068Z\t3c4ccd6e-def9-4ff4-b8b6-d5299b173e44\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/573601c8-6132-4712-ba93-bff5e96742ea/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 70,
    "timestamp": 1702154661586,
    "message": "2023-12-09T20:44:21.586Z\t8cbb8306-624e-4fed-9b72-93ea18e68726\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/46dca1df-4a28-460a-9e6b-7b0ba95a2228/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 71,
    "timestamp": 1702249510377,
    "message": "2023-12-10T23:05:10.377Z\t72bf8b39-1a57-4f69-858c-5798abf97489\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1946c766-784d-4fa4-8651-254026887ac2/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 72,
    "timestamp": 1702336112334,
    "message": "2023-12-11T23:08:32.334Z\t12205c08-1112-4124-9438-de97bfaae73a\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9088ba19-455f-4600-83eb-09a1f72475d5/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 73,
    "timestamp": 1702422820533,
    "message": "2023-12-12T23:13:40.533Z\t2fbc978e-5b8d-40ce-b1e0-622169666979\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d37a3516-2ca6-438b-a0d6-1dc140ae8ec7/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 74,
    "timestamp": 1702508948801,
    "message": "2023-12-13T23:09:08.801Z\tf0171a55-f930-449a-9386-4c0851029b03\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/918e6ffe-8e31-487b-ab87-9479ba1f9746/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 75,
    "timestamp": 1702594736239,
    "message": "2023-12-14T22:58:56.239Z\ta48f6d53-e0fd-4634-921f-30a0fab6307b\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1b87ce57-36e4-41ae-8543-d818cd7d9b7d/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 76,
    "timestamp": 1702679991461,
    "message": "2023-12-15T22:39:51.461Z\t3c9ad4da-4943-4bd1-b23a-8e735f618868\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1d50f36a-ae98-437d-a0c3-7329f4cbd92d/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 77,
    "timestamp": 1702767284105,
    "message": "2023-12-16T22:54:44.105Z\t4f7a4b3f-da69-451f-8e93-2f00bfa6da3b\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5f1f845d-681b-415d-8dbf-b2f7e1f301e7/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 78,
    "timestamp": 1702854096266,
    "message": "2023-12-17T23:01:36.266Z\teaa36d2e-229b-4e43-9c40-cfce518bc18b\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b2932a6e-cfa5-4dfd-86b7-e16136558c01/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 79,
    "timestamp": 1702854174377,
    "message": "2023-12-17T23:02:54.377Z\tacf126d7-a556-4d85-8eca-530055f644ac\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ead9f655-e86c-4f0f-8a3e-41477fb4a557/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 80,
    "timestamp": 1702940524291,
    "message": "2023-12-18T23:02:04.291Z\te25bf998-90f7-47ed-9718-1a113538cebe\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/444c9e1c-44f6-4bd7-b4df-9ef8709a1b9b/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 81,
    "timestamp": 1703027635660,
    "message": "2023-12-19T23:13:55.660Z\t9d2e0a2c-768c-42a1-9fd2-fb8faa149cc0\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f94241b9-e2ab-43be-b91b-3680ed49ac7b/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 82,
    "timestamp": 1703113455282,
    "message": "2023-12-20T23:04:15.282Z\tae9a7896-ff7a-4999-ba81-27a39950ef9a\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/af47adcf-30a4-4607-b54b-b67393d0a59d/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 83,
    "timestamp": 1703200233495,
    "message": "2023-12-21T23:10:33.495Z\tf4ed1ab5-9224-4b3b-b410-b64dfe2927e4\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/c359a8b3-ddc1-4cc9-a9bf-fe57c65c0a4d/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 84,
    "timestamp": 1703285029931,
    "message": "2023-12-22T22:43:49.931Z\t04d7f24a-4964-4daa-a33b-83e2db85fcb8\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4385da0c-b92c-49fb-bf8a-5aa641bf7d29/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 85,
    "timestamp": 1703314616340,
    "message": "2023-12-23T06:56:56.340Z\tcdfaa9b2-99da-48ea-b244-280cd6f145d0\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3c61f795-6f16-4729-a151-e55d9572e80f/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 86,
    "timestamp": 1703321602030,
    "message": "2023-12-23T08:53:22.030Z\t511a7453-dee6-40e0-b20b-0bbe887fabdf\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4e433255-56ad-401c-ad49-e18635ebe9c1/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 87,
    "timestamp": 1703328844930,
    "message": "2023-12-23T10:54:04.930Z\t5c3cc4b5-ba20-414f-89aa-e04e3442e252\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ea48f004-3d34-4bcc-8065-a6d009261a22/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 88,
    "timestamp": 1703335972004,
    "message": "2023-12-23T12:52:52.004Z\t2cdd4087-f3ed-4ec3-a84d-91e8707d4a1f\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/53e750a0-5686-40d8-be98-bdf3621fbbcf/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 89,
    "timestamp": 1703343088162,
    "message": "2023-12-23T14:51:28.162Z\tade810c3-f2f2-453f-b8b2-7caa0a2b7cb9\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b607a24f-ec43-4a13-a371-6944436afbd6/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 90,
    "timestamp": 1703347287833,
    "message": "2023-12-23T16:01:27.833Z\t33e6af11-d2b5-475a-9c7a-3ac50780e263\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5af1a25c-264a-49e3-aef9-b0f27fdc2563/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 91,
    "timestamp": 1703351014938,
    "message": "2023-12-23T17:03:34.938Z\t923d8614-53b1-41a2-b4dd-82ce3171ba19\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/354c42d4-7fe2-4310-8c77-f6e6602199cc/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 92,
    "timestamp": 1703459251093,
    "message": "2023-12-24T23:07:31.093Z\t4245546d-9aa2-4f3e-b3ad-e71692628db6\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/25dbe637-2f2f-439a-acf3-67028b7fba7a/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 93,
    "timestamp": 1704433898391,
    "message": "2024-01-05T05:51:38.391Z\tf34582d9-ca27-4a69-a6c2-b93566760da6\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '1673ced4-18f3-449a-a621-160b3f678499'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9a2adfdd-81a7-4d04-ba5d-6a019f55c3dd/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 94,
    "timestamp": 1712886961657,
    "message": "2024-04-12T01:56:01.657Z\te44ea910-cd56-4609-949d-f455fc5963cf\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%KF2024CP%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/71101cf8-fae7-4321-9a33-4b1d7a0cdcdb/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 95,
    "timestamp": 1720778320130,
    "message": "2024-07-12T09:58:40.130Z\t1b3ac317-51ed-4570-8ec4-b77458eaf8c0\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0d0d7316-9d60-47f2-a847-8dbdffe5753d/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 96,
    "timestamp": 1721901078843,
    "message": "2024-07-25T09:51:18.843Z\t2fad4801-965c-4573-b738-45c51272644c\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '153d75fa-61f1-4ea0-bd73-33ad14b99c87'\n\n\n\n\nAND l.couponName LIKE '%KC1094%'\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b799caa9-60df-4baf-b761-31c97d18ab52/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 97,
    "timestamp": 1723710888752,
    "message": "2024-08-15T08:34:48.752Z\t2f3c834d-4bda-42d5-9376-52913e4191e5\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\n\nAND l.couponCode LIKE '%art-ishigakijima-samplecoupon1%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/ab460228-d916-4d74-baab-3518ca8ae4b2/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 98,
    "timestamp": 1725184711597,
    "message": "2024-09-01T09:58:31.597Z\tcdab55a2-5718-4b28-bbc2-4f1c799289ba\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\nAND l.couponCode LIKE '%121212%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/73c9600f-61a6-46da-8bb2-3ec58f5dc1f6/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 99,
    "timestamp": 1725848585266,
    "message": "2024-09-09T02:23:05.266Z\t89ff111f-d710-4e35-aefa-1bb21ff27b75\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\n\nAND l.couponName LIKE '%121212%'\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d5dfc2bc-e685-4979-a1a3-98902cecb16a/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 100,
    "timestamp": 1728523359686,
    "message": "2024-10-10T01:22:39.686Z\te1a0fe8a-9b29-4220-a86c-d25189865663\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f4e5fd67-bf68-4af5-84b8-06619d528094/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 101,
    "timestamp": 1728529083910,
    "message": "2024-10-10T02:58:03.910Z\tc5cfabe2-00b1-4781-81d9-4d7f263a0c53\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/f264486e-c728-4f06-ba28-c0f281b4f9b5/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 102,
    "timestamp": 1728606273126,
    "message": "2024-10-11T00:24:33.126Z\te125f3c6-0585-42d1-8426-83bb5613bf6f\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\nAND l.couponName LIKE '%tokyo-sento%'\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/1b1ab024-df9a-4f9f-a6e5-03e07be36910/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 103,
    "timestamp": 1728606604866,
    "message": "2024-10-11T00:30:04.866Z\tefaa54e7-dba6-4034-8043-4236a1584348\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\nAND l.couponName LIKE '%tokyo-sento%'\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/b30dacef-6099-45d8-a878-e71b413b2fb8/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 104,
    "timestamp": 1728950994132,
    "message": "2024-10-15T00:09:54.132Z\t8740dce5-d741-4ecd-86e8-5b82136ca025\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/6093a4e6-9734-48ba-83c3-03bd7e43fb8a/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 105,
    "timestamp": 1729037997037,
    "message": "2024-10-16T00:19:57.037Z\t5eb5a9c0-370b-45c6-82fe-dfc5e93bfdee\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/9508b327-0ea6-4527-87ed-0c9808b9f292/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 106,
    "timestamp": 1729123512583,
    "message": "2024-10-17T00:05:12.583Z\tc7643dbc-29ea-42b5-8dd3-2c891c465ed1\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0614fb1d-62c5-4d21-a01b-7e5a4f27a23c/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 107,
    "timestamp": 1729469837522,
    "message": "2024-10-21T00:17:17.522Z\t7e02913f-228f-41aa-9c76-267ed35b5826\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/51c0abff-9184-46aa-9e8e-1663b6b85f3d/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 108,
    "timestamp": 1729555558813,
    "message": "2024-10-22T00:05:58.813Z\t9e73b579-7a1c-487d-adf5-11eb0af3d513\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/cb5a32a7-abfe-4da5-8731-efa617a20303/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 109,
    "timestamp": 1729641765383,
    "message": "2024-10-23T00:02:45.383Z\ta9425157-e750-4acf-ae36-5935755fda21\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/7b0b212a-c1a6-4f12-976c-d6ccc248a4c4/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 110,
    "timestamp": 1729728404405,
    "message": "2024-10-24T00:06:44.405Z\t4279b211-e1d3-430d-a36e-b5b880375b0d\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3a05ed0c-84d7-4390-934b-87019cbe9808/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 111,
    "timestamp": 1729816305805,
    "message": "2024-10-25T00:31:45.805Z\td4befb05-a5c8-4a79-acb7-1b79c58ed2ae\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/3c4dda80-560e-4a38-9837-1e5a79e587a5/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 112,
    "timestamp": 1730160348160,
    "message": "2024-10-29T00:05:48.160Z\ta113c689-3513-40b8-82ee-36a555c1cf02\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/fb4c05c4-8970-44cd-9079-3a1910731679/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 113,
    "timestamp": 1730246233421,
    "message": "2024-10-29T23:57:13.421Z\t5d6f5147-0c3c-43c6-8593-3e7508530883\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4b46bafa-7b88-44a1-9492-28b1c4c541c5/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 114,
    "timestamp": 1730324879703,
    "message": "2024-10-30T21:47:59.703Z\t4712077a-19c2-4b9a-8f3a-cbb5bab6cc90\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '0a30b1f7-eabb-48f3-b70c-d10264da9e2a'\n\n\nAND o.name LIKE '%SBギフト%'\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/0adcde8f-9dd6-4c06-bae3-6faab886bc59/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 115,
    "timestamp": 1730770158681,
    "message": "2024-11-05T01:29:18.681Z\tb54f8a90-a830-4acc-a827-d67a579def32\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'e32094fb-c933-4c35-b1db-b03faa2e2d7a'\n\n\n\nAND l.couponCode LIKE '%tokyo-sento%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/5db865b7-c4ac-4841-a3dc-5dba1da538db/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 116,
    "timestamp": 1731045494943,
    "message": "2024-11-08T05:58:14.943Z\t5b1a2868-234b-486a-8a4d-3dec2b9ad6b3\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '7b012f01-1362-4f92-8cbd-83bdb69ccd28'\n\n\n\nAND l.couponCode LIKE '%3.84E+15%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/d95eaf93-0dfd-4603-b347-a2ec206d991d/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 117,
    "timestamp": 1732527469649,
    "message": "2024-11-25T09:37:49.649Z\te36db30d-417e-4351-aad8-bce8ed44e339\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = '6b8a558d-bf01-4d1a-87d8-2e7a62ae85e0'\n\n\n\nAND l.couponCode LIKE '%ACLE1105%'\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/4a181ca0-7437-4381-9382-d3432d236a57/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  },
  {
    "order": 118,
    "timestamp": 1733705931811,
    "message": "2024-12-09T00:58:51.811Z\t38765b58-c363-4aaa-8b36-6bbe28f172fb\tINFO\tsql \n        unload ($$\n            SELECT ROW_NUMBER()                                    OVER(ORDER BY couponCode, couponName) AS \"No\", o.name AS \"組織名\",\n                couponCode                                   AS \"クーポンコード\",\n                couponName                                   AS \"クーポン名\",\n                (\n                    SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'issued'\n                        AND l2.couponMasterId = l.couponMasterId\n                        AND NOT EXISTS(\n                            SELECT\n                            1\n                            FROM\n                            coupon_logs AS l3\n                            WHERE\n                            l2.couponId = l3.couponId\n                            AND l3.type = 'issued'\n                            AND l2.createAtMillis < l3.createAtMillis\n                        )\n                )                                            AS \"発行数\",\n                (SELECT COUNT(*)\n                    FROM coupon_logs l2\n                    WHERE l2.type = 'displayed'\n                    AND l2.couponMasterId = l.couponMasterId) AS \"参照数\"\n                \nFROM \n    coupon_logs l\nJOIN (\n  SELECT \n    couponMasterId,\n    MAX(createAtMillis) AS createAtMillis\n  FROM coupon_logs\n  GROUP BY couponMasterId \n) latest\nON l.couponMasterId = latest.couponMasterId\nAND l.createAtMillis = latest.createAtMillis\n\n\nJOIN \n    organization_closure oc\n    ON oc.childId = l.organizationId\nJOIN \n    organization o\n    ON o.resourceId = l.organizationId\nWHERE \n    oc.parentId = 'fb96ab72-2211-4617-aa21-91a76b050360'\n\n\n\n\n\n\n            ORDER BY couponCode,\n                    couponName\n        $$)\n        to 's3://prd-coupon-redshift-bucket-ap-northeast-1-856562439801/26806cf5-4f90-4cff-b850-128b86daacdb/'\n        iam_role 'arn:aws:iam::856562439801:role/coupon-redshift-cluster-role'\n        HEADER\n        DELIMITER ','\n        ADDQUOTES\n        PARALLEL OFF\n    \n"
  }
]